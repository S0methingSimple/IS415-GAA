<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeffery Lau">
<meta name="dcterms.date" content="2024-10-13">
<meta name="description" content="In this exercise, we will develop an interactive Geospatial Analytics Shiny App to enable users to explore crime patterns in West Malaysia. By leveraging spatial clustering techniques, the app will provide an interface to uncover insights into the spatial distribution of crime and identify potential clusters.">

<title>Jeff’s 🗺 Adventures - Take-home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jeff’s 🗺 Adventures</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex01/ho_ex01.html">
 <span class="dropdown-text">Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex02/ho_ex02.html">
 <span class="dropdown-text">Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex03/ho_ex03.html">
 <span class="dropdown-text">Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex04/ho_ex04.html">
 <span class="dropdown-text">Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex05/ho_ex05.html">
 <span class="dropdown-text">Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex06/ho_ex06.html">
 <span class="dropdown-text">Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex08/ho_ex08.html">
 <span class="dropdown-text">Exercise 8 &amp; 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex10/ho_ex10.html">
 <span class="dropdown-text">Exercise 10 &amp; 11</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../hands-on_ex/ex12/ho_ex12.html">
 <span class="dropdown-text">Exercise 12</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex01/ic_ex01.html">
 <span class="dropdown-text">Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex02/ic_ex02.html">
 <span class="dropdown-text">Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex03/ic_ex03.html">
 <span class="dropdown-text">Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex04/ic_ex04.html">
 <span class="dropdown-text">Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex05/ic_ex05.html">
 <span class="dropdown-text">Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex06/ic_ex06.html">
 <span class="dropdown-text">Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex10/ic_ex10.html">
 <span class="dropdown-text">Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex11/ic_ex11.html">
 <span class="dropdown-text">Exercise 11</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex12/ic_ex12.html">
 <span class="dropdown-text">Exercise 12</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../in-class_ex/ex13/ic_ex13.html">
 <span class="dropdown-text">Exercise 13</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../take-home_ex/ex01/th_ex01.html">
 <span class="dropdown-text">Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../take-home_ex/ex02/th_ex02.html">
 <span class="dropdown-text">Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../take-home_ex/ex03/th_ex03.html">
 <span class="dropdown-text">Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. Introduction</a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">1.2 Motivation</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.3 Objectives</a></li>
  </ul></li>
  <li><a href="#packages-and-data" id="toc-packages-and-data" class="nav-link" data-scroll-target="#packages-and-data">2. Packages and Data</a>
  <ul class="collapse">
  <li><a href="#packages-required" id="toc-packages-required" class="nav-link" data-scroll-target="#packages-required">2.1 Packages Required</a></li>
  <li><a href="#data-required" id="toc-data-required" class="nav-link" data-scroll-target="#data-required">2.2 Data Required</a>
  <ul class="collapse">
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">2.2.1 Aspatial Data</a></li>
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data">2.2.2 Geospatial Data</a></li>
  <li><a href="#enrichment-data" id="toc-enrichment-data" class="nav-link" data-scroll-target="#enrichment-data">2.2.3 Enrichment Data</a></li>
  </ul></li>
  <li><a href="#wrangling" id="toc-wrangling" class="nav-link" data-scroll-target="#wrangling">2.3 Wrangling</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">2.3.1 Data Preparation</a></li>
  <li><a href="#state-mismatch" id="toc-state-mismatch" class="nav-link" data-scroll-target="#state-mismatch">2.3.2 State Mismatch</a></li>
  <li><a href="#state-wrangling" id="toc-state-wrangling" class="nav-link" data-scroll-target="#state-wrangling">2.3.3 State Wrangling</a></li>
  <li><a href="#state-district-wrangling-crime" id="toc-state-district-wrangling-crime" class="nav-link" data-scroll-target="#state-district-wrangling-crime">2.3.4 State-District Wrangling (Crime)</a></li>
  <li><a href="#state-district-wrangling-population" id="toc-state-district-wrangling-population" class="nav-link" data-scroll-target="#state-district-wrangling-population">2.3.5 State-District Wrangling (Population)</a></li>
  <li><a href="#joining" id="toc-joining" class="nav-link" data-scroll-target="#joining">2.3.6 Joining</a></li>
  <li><a href="#crime-per-capita-distribution" id="toc-crime-per-capita-distribution" class="nav-link" data-scroll-target="#crime-per-capita-distribution">2.3.7 Crime per Capita Distribution</a></li>
  <li><a href="#correlation-plot" id="toc-correlation-plot" class="nav-link" data-scroll-target="#correlation-plot">2.3.8 Correlation Plot</a></li>
  </ul></li>
  <li><a href="#data-enrichment" id="toc-data-enrichment" class="nav-link" data-scroll-target="#data-enrichment">2.4 Data Enrichment</a>
  <ul class="collapse">
  <li><a href="#state-wrangling-1" id="toc-state-wrangling-1" class="nav-link" data-scroll-target="#state-wrangling-1">2.4.1 State Wrangling</a></li>
  <li><a href="#state-district-wrangling-poverty-inequaltiy" id="toc-state-district-wrangling-poverty-inequaltiy" class="nav-link" data-scroll-target="#state-district-wrangling-poverty-inequaltiy">2.4.2 State-District Wrangling (Poverty &amp; Inequaltiy)</a></li>
  <li><a href="#state-distrcit-wrangling-labour" id="toc-state-distrcit-wrangling-labour" class="nav-link" data-scroll-target="#state-distrcit-wrangling-labour">2.4.3 State-Distrcit Wrangling (Labour)</a></li>
  <li><a href="#joining-1" id="toc-joining-1" class="nav-link" data-scroll-target="#joining-1">2.4.4 Joining</a></li>
  </ul></li>
  <li><a href="#data-selection" id="toc-data-selection" class="nav-link" data-scroll-target="#data-selection">2.5 Data Selection</a>
  <ul class="collapse">
  <li><a href="#visualizing-the-correlation-of-data" id="toc-visualizing-the-correlation-of-data" class="nav-link" data-scroll-target="#visualizing-the-correlation-of-data">2.5.1 Visualizing the Correlation of Data</a></li>
  <li><a href="#final-selection" id="toc-final-selection" class="nav-link" data-scroll-target="#final-selection">2.5.2 Final Selection</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#analysis-preparations" id="toc-analysis-preparations" class="nav-link" data-scroll-target="#analysis-preparations">3. Analysis Preparations</a>
  <ul class="collapse">
  <li><a href="#variable-exploration" id="toc-variable-exploration" class="nav-link" data-scroll-target="#variable-exploration">3.1 Variable Exploration</a>
  <ul class="collapse">
  <li><a href="#data-standardisation" id="toc-data-standardisation" class="nav-link" data-scroll-target="#data-standardisation">3.1.1 Data Standardisation</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">3.1.2 Histograms</a></li>
  <li><a href="#density-plot" id="toc-density-plot" class="nav-link" data-scroll-target="#density-plot">3.1.3 Density Plot</a></li>
  <li><a href="#boxplots" id="toc-boxplots" class="nav-link" data-scroll-target="#boxplots">3.1.4 Boxplots</a></li>
  </ul></li>
  <li><a href="#selecting-no.-of-clusters" id="toc-selecting-no.-of-clusters" class="nav-link" data-scroll-target="#selecting-no.-of-clusters">3.2 Selecting No.&nbsp;of Clusters</a>
  <ul class="collapse">
  <li><a href="#compute-nbclust" id="toc-compute-nbclust" class="nav-link" data-scroll-target="#compute-nbclust">3.2.1 Compute NbClust</a></li>
  <li><a href="#visualizing-nb-clust" id="toc-visualizing-nb-clust" class="nav-link" data-scroll-target="#visualizing-nb-clust">3.2.2 Visualizing NB Clust</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">3.3 Hierarchical Clustering</a>
  <ul class="collapse">
  <li><a href="#compute-pair-wise-distance" id="toc-compute-pair-wise-distance" class="nav-link" data-scroll-target="#compute-pair-wise-distance">3.3.1 Compute pair-wise distance</a></li>
  <li><a href="#compute-cluster" id="toc-compute-cluster" class="nav-link" data-scroll-target="#compute-cluster">3.3.2 Compute Cluster</a></li>
  <li><a href="#compute-cluster-geo-constrained" id="toc-compute-cluster-geo-constrained" class="nav-link" data-scroll-target="#compute-cluster-geo-constrained">3.3.3 Compute Cluster (Geo Constrained)</a></li>
  </ul></li>
  <li><a href="#skater-clustering" id="toc-skater-clustering" class="nav-link" data-scroll-target="#skater-clustering">3.4 Skater Clustering</a>
  <ul class="collapse">
  <li><a href="#generating-neighbours" id="toc-generating-neighbours" class="nav-link" data-scroll-target="#generating-neighbours">3.4.1 Generating Neighbours</a></li>
  <li><a href="#fixing-neighbours" id="toc-fixing-neighbours" class="nav-link" data-scroll-target="#fixing-neighbours">3.4.2 Fixing Neighbours</a></li>
  <li><a href="#compute-mst" id="toc-compute-mst" class="nav-link" data-scroll-target="#compute-mst">3.4.3 Compute MST</a></li>
  <li><a href="#compute-cluster-1" id="toc-compute-cluster-1" class="nav-link" data-scroll-target="#compute-cluster-1">3.4.4 Compute Cluster</a></li>
  <li><a href="#visualizing-clusters" id="toc-visualizing-clusters" class="nav-link" data-scroll-target="#visualizing-clusters">3.4.5 Visualizing Clusters</a></li>
  </ul></li>
  <li><a href="#intepreting-results" id="toc-intepreting-results" class="nav-link" data-scroll-target="#intepreting-results">3.5 Intepreting Results</a>
  <ul class="collapse">
  <li><a href="#comparing-clusters" id="toc-comparing-clusters" class="nav-link" data-scroll-target="#comparing-clusters">3.5.1 Comparing Clusters</a></li>
  <li><a href="#parallel-coordinates-crime" id="toc-parallel-coordinates-crime" class="nav-link" data-scroll-target="#parallel-coordinates-crime">3.5.2 Parallel Coordinates (Crime)</a></li>
  <li><a href="#parral-coordinates-demographics" id="toc-parral-coordinates-demographics" class="nav-link" data-scroll-target="#parral-coordinates-demographics">3.5.3 Parral Coordinates (Demographics)</a></li>
  <li><a href="#cluster-profiling" id="toc-cluster-profiling" class="nav-link" data-scroll-target="#cluster-profiling">3.5.4 Cluster Profiling</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ui-storyboard" id="toc-ui-storyboard" class="nav-link" data-scroll-target="#ui-storyboard">4. UI Storyboard</a>
  <ul class="collapse">
  <li><a href="#flow" id="toc-flow" class="nav-link" data-scroll-target="#flow">4.1 Flow</a></li>
  <li><a href="#variable-exploration-1" id="toc-variable-exploration-1" class="nav-link" data-scroll-target="#variable-exploration-1">4.2 Variable Exploration</a>
  <ul class="collapse">
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram">4.2.1 Histogram</a></li>
  <li><a href="#density" id="toc-density" class="nav-link" data-scroll-target="#density">4.2.2 Density</a></li>
  <li><a href="#boxplot-w-standardisation" id="toc-boxplot-w-standardisation" class="nav-link" data-scroll-target="#boxplot-w-standardisation">4.2.3 Boxplot w/ Standardisation</a></li>
  </ul></li>
  <li><a href="#cluster-configuration" id="toc-cluster-configuration" class="nav-link" data-scroll-target="#cluster-configuration">4.3 Cluster Configuration</a>
  <ul class="collapse">
  <li><a href="#nbclust" id="toc-nbclust" class="nav-link" data-scroll-target="#nbclust">4.3.1 NbClust</a></li>
  <li><a href="#fiviz-gap-stats" id="toc-fiviz-gap-stats" class="nav-link" data-scroll-target="#fiviz-gap-stats">4.3.2 Fiviz (Gap Stats)</a></li>
  </ul></li>
  <li><a href="#cluster-results" id="toc-cluster-results" class="nav-link" data-scroll-target="#cluster-results">4.4 Cluster Results</a>
  <ul class="collapse">
  <li><a href="#hierarchical-clustering-1" id="toc-hierarchical-clustering-1" class="nav-link" data-scroll-target="#hierarchical-clustering-1">4.4.1 Hierarchical Clustering</a></li>
  <li><a href="#geographically-constrained-clustering" id="toc-geographically-constrained-clustering" class="nav-link" data-scroll-target="#geographically-constrained-clustering">4.4.2 Geographically Constrained Clustering</a></li>
  <li><a href="#hierarchical-clustering-heatmaply" id="toc-hierarchical-clustering-heatmaply" class="nav-link" data-scroll-target="#hierarchical-clustering-heatmaply">4.4.3 Hierarchical Clustering (Heatmaply)</a></li>
  <li><a href="#cluster-comparison" id="toc-cluster-comparison" class="nav-link" data-scroll-target="#cluster-comparison">4.4.4 Cluster Comparison</a></li>
  </ul></li>
  <li><a href="#further-analysis" id="toc-further-analysis" class="nav-link" data-scroll-target="#further-analysis">4.5 Further Analysis</a>
  <ul class="collapse">
  <li><a href="#cluster-profile-para-coord" id="toc-cluster-profile-para-coord" class="nav-link" data-scroll-target="#cluster-profile-para-coord">4.5.1 Cluster Profile &amp; Para Coord</a></li>
  <li><a href="#heatmap-para-coord" id="toc-heatmap-para-coord" class="nav-link" data-scroll-target="#heatmap-para-coord">4.5.2 Heatmap &amp; Para Coord</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection">5. Reflection</a>
  <ul class="collapse">
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">5.1 Data Wrangling</a></li>
  <li><a href="#skater-clustering-1" id="toc-skater-clustering-1" class="nav-link" data-scroll-target="#skater-clustering-1">5.2 Skater Clustering</a></li>
  <li><a href="#storyboarding" id="toc-storyboarding" class="nav-link" data-scroll-target="#storyboarding">5.3 Storyboarding</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 3</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Take-home</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>In this exercise, we will develop an interactive Geospatial Analytics Shiny App to enable users to explore crime patterns in West Malaysia. By leveraging spatial clustering techniques, the app will provide an interface to uncover insights into the spatial distribution of crime and identify potential clusters.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jeffery Lau </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 13, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 4, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>Crime is a pressing issue in Malaysia, impacting both urban and rural communities. Understanding the spatial and temporal patterns of crime is crucial for law enforcement agencies to allocate resources effectively and implement targeted crime prevention strategies. Traditional crime analysis methods often rely on basic statistical analysis and simple geographic visualizations. However, by employing advanced statistical techniques such as clustering, we can delve deeper into the underlying factors driving crime and identify specific hotspots or crime clusters.</p>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">1.2 Motivation</h2>
<p>This project aims to leverage spatial clustering techniques to identify distinct crime patterns and analyze the socio-economic factors associated with these patterns. By integrating crime data with additional socio-economic indicators such as labor force statistics and inequality measures, we can gain a more comprehensive understanding of the factors influencing crime in Malaysia (West).</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.3 Objectives</h2>
<ol type="1">
<li>Apply spatial clustering techniques to visualize similar regions based on crime patterns enriched with socio-economic data.</li>
<li>Interpret and analyse spatial clusters with crime characteristics and their relationship with socio-economic factors and deem their suitability for the Shiny application.</li>
<li>Develop a storyboard for the Shiny application incoperating effective and interative visualizations to communicate the findings to a diverse audience.</li>
</ol>
</section>
</section>
<section id="packages-and-data" class="level1">
<h1>2. Packages and Data</h1>
<section id="packages-required" class="level2">
<h2 class="anchored" data-anchor-id="packages-required">2.1 Packages Required</h2>
<p>The following will be the packages used for this study and the Shiny Application:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, st, tidyverse, raster, tmap, tmaptools, ggplot2, gridExtra, spatstat, sfdep, spdep, ClustGeo, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, cluster, factoextra, NbClust,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               heatmaply, corrplot, psych, GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>sf: For working with simple features, a standard for spatial data in R.</li>
<li>tidyverse: A collection of packages for data manipulation and visualization, including dplyr, tidyr, ggplot2, etc.</li>
<li>tmap: For creating static and interactive maps.</li>
<li>ggplot2: A powerful visualization package for creating static plots.</li>
<li>gridExtra: For arranging multiple plots on a single page.</li>
<li>sfdep: For spatial dependency analysis.</li>
<li>ClustGeo: For spatial clustering analysis.</li>
<li>cluster: For various clustering algorithms, including K-means and hierarchical clustering.</li>
<li>factoextra: For visualizing and evaluating clustering results.</li>
<li>NbClust: For determining the optimal number of clusters.</li>
<li>heatmaply: For creating interactive heatmaps.</li>
<li>corrplot: For visualizing correlation matrices.</li>
<li>GGally: For advanced data visualization, including pair plots and correlation plots.</li>
</ul>
</section>
<section id="data-required" class="level2">
<h2 class="anchored" data-anchor-id="data-required">2.2 Data Required</h2>
<p>There are a total of 5 aspatial datasets used in this project.</p>
<ul>
<li><p><a href="https://data.gov.my/data-catalogue/crime_district">Malaysia – Crime by District and Crime Type</a> from data.gov.my in csv format.</p></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-mys">Malaysia - Subnational Administrative Boundaries</a> with included administrative regions in shapefile format.</p></li>
<li><p><a href="https://data.gov.my/data-catalogue/lfs_district">Malaysia – Annual Principal Labour Force Statistics by District</a> from data.gov.my in csv format.</p></li>
<li><p><a href="https://data.gov.my/data-catalogue/hh_poverty_district">Malaysia – Poverty by Administrative District</a> from data.gov.my in csv format.</p></li>
<li><p><a href="https://data.gov.my/data-catalogue/hh_inequality_district">Malaysia – Income Inequality by District</a> from data.gov.my in csv format.</p></li>
<li><p><a href="https://data.gov.my/data-catalogue/population_district">Malaysia – Population by District</a> from data.gov.my in csv format.</p></li>
</ul>
<section id="aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="aspatial-data">2.2.1 Aspatial Data</h3>
<p>We start by importing the crime rate and population csv file into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>crime_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/crime_district.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>population_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/population_district.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data">2.2.2 Geospatial Data</h3>
<p>Next, we import the administrative (Level 2, District) regions of Malaysia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mys_sf <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/mys_adm_unhcr_20210211_shp"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"mys_admbnda_adm2_unhcr_20210211"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3168</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="enrichment-data" class="level3">
<h3 class="anchored" data-anchor-id="enrichment-data">2.2.3 Enrichment Data</h3>
<p>We will also be importing and working we several other potentially related data to crime rates in Malaysia and uncover if there is any further insights which could be extracted from their usage. The following teh details of the fields:</p>
<ol type="1">
<li>Poverty by District: Poverty rates by administrative district from 2019 to 2022</li>
</ol>
<ul>
<li><code>poverty_absolute</code>: Proportion of households with monthly income below the Poverty Line Income (PLI)</li>
<li><code>poverty_relative</code>: Proportion of households with monthly income below half the district median income</li>
</ul>
<ol start="2" type="1">
<li>Inequality by District: Gini coefficient by administrative district from 2019 to 2022.</li>
</ol>
<ul>
<li><code>gini</code>: The Gini coefficient based on the distribution of households’ gross monthly income</li>
</ul>
<ol start="3" type="1">
<li>Labour Force Statistics by District: Annual principal labour force statistics at district level, including unemployment and participation rates.</li>
</ol>
<ul>
<li><code>lf</code>: The number (in thousands) of employed and unemployed individuals. This figure also represents the number of people participating in the labour force.</li>
<li><code>lf_employed</code>: The number (in thousands) of people who worked at least one hour for pay, profit or family gain, in thousands of people</li>
<li><code>lf_unemployed</code>: The number (in thousands) of people who did not work but were looking for work or available to work</li>
<li><code>lf_outside</code>: The number (in thousands) of people not classified as employed or unemployed, including housewives, students, early retired, disabled persons and those not interested in looking for a job</li>
<li><code>u_rate</code>: Ratio of unemployed to labour force size</li>
<li><code>p_rate</code>: Ratio of the labour force size to the working-age (15-64) population</li>
<li><code>ep_ratio</code>: Ratio of the number of employed people to the working-age (15-64) population</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>poverty_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/poverty_district.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>inequality_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/inequality_district.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>labour_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/labour_district.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="wrangling" class="level2">
<h2 class="anchored" data-anchor-id="wrangling">2.3 Wrangling</h2>
<p>Next we shall prepare our data for analysis, which includes proper mapping of data and joining for the aspatial datasets with the geospatial dataset.</p>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">2.3.1 Data Preparation</h3>
<p>Before we can check the mappings we convert <code>state</code> and <code>district</code> to upper to ensure a smooth matching and join. We also extracted the year as a column since the aspatial data are all annual.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Crime</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Population</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Malaysia</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Convert state and district to upper for matching</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>crime_df <span class="ot">&lt;-</span> crime_df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="fu">toupper</span>(state),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">district =</span> <span class="fu">toupper</span>(district))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>crime_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,152 × 7
   state    district category type           date       crimes  year
   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;          &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 MALAYSIA ALL      assault  all            2016-01-01  22327  2016
 2 MALAYSIA ALL      assault  all            2017-01-01  21366  2017
 3 MALAYSIA ALL      assault  all            2018-01-01  16902  2018
 4 MALAYSIA ALL      assault  all            2019-01-01  16489  2019
 5 MALAYSIA ALL      assault  all            2020-01-01  13279  2020
 6 MALAYSIA ALL      assault  all            2021-01-01  11495  2021
 7 MALAYSIA ALL      assault  all            2022-01-01  10348  2022
 8 MALAYSIA ALL      assault  all            2023-01-01  10453  2023
 9 MALAYSIA ALL      assault  causing_injury 2016-01-01   5531  2016
10 MALAYSIA ALL      assault  causing_injury 2017-01-01   5024  2017
# ℹ 19,142 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>population_df <span class="ot">&lt;-</span> population_df <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="fu">toupper</span>(state),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">district =</span> <span class="fu">toupper</span>(district))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>population_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 319,200 × 8
   state district   date       sex   age     ethnicity        population  year
   &lt;chr&gt; &lt;chr&gt;      &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;
 1 JOHOR BATU PAHAT 2020-01-01 both  overall overall               495.   2020
 2 JOHOR BATU PAHAT 2020-01-01 both  overall bumi_malay            311.   2020
 3 JOHOR BATU PAHAT 2020-01-01 both  overall bumi_other              5.1  2020
 4 JOHOR BATU PAHAT 2020-01-01 both  overall chinese               140.   2020
 5 JOHOR BATU PAHAT 2020-01-01 both  overall indian                  6.9  2020
 6 JOHOR BATU PAHAT 2020-01-01 both  overall other_citizen           1.8  2020
 7 JOHOR BATU PAHAT 2020-01-01 both  overall other_noncitizen       30.2  2020
 8 JOHOR BATU PAHAT 2020-01-01 both  0-4     overall                30.3  2020
 9 JOHOR BATU PAHAT 2020-01-01 both  0-4     bumi_malay             21.3  2020
10 JOHOR BATU PAHAT 2020-01-01 both  0-4     bumi_other              0.5  2020
# ℹ 319,190 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mys_sf <span class="ot">&lt;-</span> mys_sf <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ADM1_EN =</span> <span class="fu">toupper</span>(ADM1_EN),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ADM2_EN =</span> <span class="fu">toupper</span>(ADM2_EN))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mys_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 144 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 94420.8 xmax: 2380932 ymax: 829136
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 144 × 15
   ADM2_EN  ADM2_PCODE ADM2_REF ADM2ALT1EN ADM2ALT2EN ADM1_EN ADM1_PCODE ADM0_EN
 * &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  
 1 BATU PA… MY0101     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 2 JOHOR B… MY0102     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 3 KLUANG   MY0103     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 4 KOTA TI… MY0104     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 5 KULAIJA… MY0105     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 6 LEDANG   MY0106     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 7 MERSING  MY0107     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 8 MUAR     MY0108     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 9 PONTIAN  MY0109     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
10 SEGAMAT  MY0110     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
# ℹ 134 more rows
# ℹ 7 more variables: ADM0_PCODE &lt;chr&gt;, date &lt;date&gt;, validOn &lt;date&gt;,
#   validTo &lt;date&gt;, Shape_Leng &lt;dbl&gt;, Shape_Area &lt;dbl&gt;,
#   geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="state-mismatch" class="level3">
<h3 class="anchored" data-anchor-id="state-mismatch">2.3.2 State Mismatch</h3>
<p>Next we check for any mismatch on ADM1 (State-level)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Overview</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Difference</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in crime_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in crime_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(crime_df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "MALAYSIA"          "JOHOR"             "KEDAH"            
 [4] "KELANTAN"          "MELAKA"            "NEGERI SEMBILAN"  
 [7] "PAHANG"            "PERAK"             "PERLIS"           
[10] "PULAU PINANG"      "SABAH"             "SARAWAK"          
[13] "SELANGOR"          "TERENGGANU"        "W.P. KUALA LUMPUR"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in population_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in population_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(population_df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"             "KEDAH"             "KELANTAN"         
 [4] "MELAKA"            "NEGERI SEMBILAN"   "PAHANG"           
 [7] "PERAK"             "PERLIS"            "PULAU PINANG"     
[10] "SABAH"             "SARAWAK"           "SELANGOR"         
[13] "TERENGGANU"        "W.P. KUALA LUMPUR" "W.P. LABUAN"      
[16] "W.P. PUTRAJAYA"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(mys_sf<span class="sc">$</span>ADM1_EN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"             "KEDAH"             "KELANTAN"         
 [4] "W.P. KUALA LUMPUR" "W.P. LABUAN"       "MELAKA"           
 [7] "NEGERI SEMBILAN"   "PAHANG"            "PERAK"            
[10] "PERLIS"            "PULAU PINANG"      "SABAH"            
[13] "SARAWAK"           "TERENGGANU"        "W.P. PUTRAJAYA"   
[16] "SELANGOR"         </code></pre>
</div>
</div>
<p>At first glance we can see a mismatch in the length of the states.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>state_crime <span class="ot">&lt;-</span> <span class="fu">unique</span>(crime_df<span class="sc">$</span>state)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>state_sf <span class="ot">&lt;-</span> <span class="fu">unique</span>(mys_sf<span class="sc">$</span>ADM1_EN)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>missing_in_sf <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_crime, state_sf)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>missing_in_crime <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_sf, state_crime)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"States in crime_df not found in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "States in crime_df not found in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MALAYSIA"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"States in mys_sf not found in crime_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "States in mys_sf not found in crime_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_crime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "W.P. LABUAN"    "W.P. PUTRAJAYA"</code></pre>
</div>
</div>
<p>It seems like crime_df also have a row for the aggregated crime rates for the whole of Malaysia. Whereas W.P. LABUAN, W.P. PUTRAJAYA are not found in the spatial dataset.</p>
</div>
</div>
</div>
</section>
<section id="state-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="state-wrangling">2.3.3 State Wrangling</h3>
<p>For this project we will be focusing on West Malaysia, and thus will be filtering out Sarawak, Sabah and Labuan. To address the issue identified above we will be mapping: ‘W.P. PUTRAJAYA’ -&gt; ‘KUALA LUMPUR’.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Crime</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Population</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Malaysia</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>crime_df <span class="ot">&lt;-</span> crime_df <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(state <span class="sc">!=</span> <span class="st">'MALAYSIA'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'SABAH'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'SARAWAK'</span> <span class="sc">&amp;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                     district <span class="sc">!=</span> <span class="st">'ALL'</span> <span class="sc">&amp;</span> type <span class="sc">!=</span> <span class="st">'all'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. KUALA LUMPUR'</span>, <span class="st">'KUALA LUMPUR'</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>crime_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,368 × 7
   state district   category type           date       crimes  year
   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;          &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 JOHOR BATU PAHAT assault  causing_injury 2016-01-01     39  2016
 2 JOHOR BATU PAHAT assault  causing_injury 2017-01-01     41  2017
 3 JOHOR BATU PAHAT assault  causing_injury 2018-01-01     28  2018
 4 JOHOR BATU PAHAT assault  causing_injury 2019-01-01     41  2019
 5 JOHOR BATU PAHAT assault  causing_injury 2020-01-01     43  2020
 6 JOHOR BATU PAHAT assault  causing_injury 2021-01-01     22  2021
 7 JOHOR BATU PAHAT assault  causing_injury 2022-01-01     19  2022
 8 JOHOR BATU PAHAT assault  causing_injury 2023-01-01     22  2023
 9 JOHOR BATU PAHAT assault  murder         2016-01-01      6  2016
10 JOHOR BATU PAHAT assault  murder         2017-01-01      0  2017
# ℹ 10,358 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>population_df <span class="ot">&lt;-</span> population_df <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(state <span class="sc">!=</span> <span class="st">'SABAH'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'SARAWAK'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'W.P. LABUAN'</span> <span class="sc">&amp;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                 sex <span class="sc">==</span> <span class="st">"both"</span> <span class="sc">&amp;</span> age <span class="sc">==</span> <span class="st">"overall"</span> <span class="sc">&amp;</span> ethnicity <span class="sc">==</span> <span class="st">"overall"</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. KUALA LUMPUR'</span>, <span class="st">'KUALA LUMPUR'</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. PUTRAJAYA'</span>, <span class="st">'KUALA LUMPUR'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(state, district, year, population)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>population_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 276 × 4
   state district     year population
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 JOHOR BATU PAHAT   2020      495. 
 2 JOHOR JOHOR BAHRU  2020     1711. 
 3 JOHOR KLUANG       2020      324. 
 4 JOHOR KOTA TINGGI  2020      222. 
 5 JOHOR KULAI        2020      330. 
 6 JOHOR MERSING      2020       78.2
 7 JOHOR MUAR         2020      315. 
 8 JOHOR PONTIAN      2020      173. 
 9 JOHOR SEGAMAT      2020      198. 
10 JOHOR TANGKAK      2020      163. 
# ℹ 266 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mys_sf <span class="ot">&lt;-</span> mys_sf <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(ADM1_EN <span class="sc">!=</span> <span class="st">'W.P. LABUAN'</span> <span class="sc">&amp;</span> ADM1_EN <span class="sc">!=</span> <span class="st">'SABAH'</span> <span class="sc">&amp;</span> ADM1_EN <span class="sc">!=</span> <span class="st">'SARAWAK'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ADM1_EN =</span> <span class="fu">replace</span>(ADM1_EN, ADM1_EN <span class="sc">==</span> <span class="st">'W.P. KUALA LUMPUR'</span>, <span class="st">'KUALA LUMPUR'</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ADM1_EN =</span> <span class="fu">replace</span>(ADM1_EN, ADM1_EN <span class="sc">==</span> <span class="st">'W.P. PUTRAJAYA'</span>, <span class="st">'KUALA LUMPUR'</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>mys_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 87 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 87 × 15
   ADM2_EN  ADM2_PCODE ADM2_REF ADM2ALT1EN ADM2ALT2EN ADM1_EN ADM1_PCODE ADM0_EN
 * &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  
 1 BATU PA… MY0101     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 2 JOHOR B… MY0102     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 3 KLUANG   MY0103     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 4 KOTA TI… MY0104     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 5 KULAIJA… MY0105     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 6 LEDANG   MY0106     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 7 MERSING  MY0107     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 8 MUAR     MY0108     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
 9 PONTIAN  MY0109     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
10 SEGAMAT  MY0110     &lt;NA&gt;     &lt;NA&gt;       &lt;NA&gt;       JOHOR   MY01       Malays…
# ℹ 77 more rows
# ℹ 7 more variables: ADM0_PCODE &lt;chr&gt;, date &lt;date&gt;, validOn &lt;date&gt;,
#   validTo &lt;date&gt;, Shape_Leng &lt;dbl&gt;, Shape_Area &lt;dbl&gt;,
#   geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
W.P. PUTRAJAYA -&gt; KUALA LUMPUR ??
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is noted that W.P. PUTRAJAYA is within SELANGOR but for the ease of joining with subsequent data it will mapped under KUALA LUMPUR state</p>
</div>
</div>
</section>
<section id="state-district-wrangling-crime" class="level3">
<h3 class="anchored" data-anchor-id="state-district-wrangling-crime">2.3.4 State-District Wrangling (Crime)</h3>
<p>Next we will be wrangling the data on the district level, the methodology is similar as above: 1. Check difference of unique state_district 2. Address difference by mapping district not found within <code>mys_sf</code> into available districts 3. Aggregate the newly mapped variables under a similar district</p>
<section id="state-district-mismatch" class="level4">
<h4 class="anchored" data-anchor-id="state-district-mismatch">2.3.4.1 State-District Mismatch</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>crime_df <span class="ot">&lt;-</span> crime_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">paste</span>(state, district, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>mys_sf <span class="ot">&lt;-</span> mys_sf <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">paste</span>(ADM1_EN, ADM2_EN, <span class="at">sep =</span> <span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>state_district_crime <span class="ot">&lt;-</span> <span class="fu">unique</span>(crime_df<span class="sc">$</span>state_district)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>state_district_sf <span class="ot">&lt;-</span> <span class="fu">unique</span>(mys_sf<span class="sc">$</span>state_district)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>missing_in_sf <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_crime, state_district_sf)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>missing_in_crime <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_sf, state_district_crime)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in crime_df not found in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in crime_df not found in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR-ISKANDAR PUTERI"               "JOHOR-JOHOR BAHRU SELATAN"          
 [3] "JOHOR-JOHOR BAHRU UTARA"             "JOHOR-NUSAJAYA"                     
 [5] "JOHOR-SERI ALAM"                     "KEDAH-BANDAR BHARU"                 
 [7] "NEGERI SEMBILAN-NILAI"               "PAHANG-CAMERON HIGHLAND"            
 [9] "PAHANG-KUALA LIPIS"                  "PERAK-BATU GAJAH"                   
[11] "PERAK-GERIK"                         "PERAK-IPOH"                         
[13] "PERAK-MANJUNG"                       "PERAK-PENGKALAN HULU"               
[15] "PERAK-SELAMA"                        "PERAK-SUNGAI SIPUT"                 
[17] "PERAK-TAIPING"                       "PERAK-TANJONG MALIM"                
[19] "PERAK-TAPAH"                         "PERLIS-ARAU"                        
[21] "PERLIS-KANGAR"                       "PERLIS-PADANG BESAR"                
[23] "PULAU PINANG-SEBERANG PERAI SELATAN" "PULAU PINANG-SEBERANG PERAI TENGAH" 
[25] "PULAU PINANG-SEBERANG PERAI UTARA"   "SELANGOR-AMPANG JAYA"               
[27] "SELANGOR-HULU SELANGOR"              "SELANGOR-KAJANG"                    
[29] "SELANGOR-KLANG SELATAN"              "SELANGOR-KLANG UTARA"               
[31] "SELANGOR-PETALING JAYA"              "SELANGOR-SERDANG"                   
[33] "SELANGOR-SG. BULOH"                  "SELANGOR-SHAH ALAM"                 
[35] "SELANGOR-SUBANG JAYA"                "SELANGOR-SUNGAI BULOH"              
[37] "KUALA LUMPUR-BRICKFIELDS"            "KUALA LUMPUR-CHERAS"                
[39] "KUALA LUMPUR-DANG WANGI"             "KUALA LUMPUR-SENTUL"                
[41] "KUALA LUMPUR-WANGSA MAJU"           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in mys_sf not found in crime_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in mys_sf not found in crime_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_crime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR-JOHOR BAHRU"             "KEDAH-POKOK SENA"             
 [3] "KUALA LUMPUR-WP. KUALA LUMPUR" "PAHANG-LIPIS"                 
 [5] "PERAK-BATANG PADANG"           "PERAK-ULU PERAK"              
 [7] "PERAK-KINTA"                   "PERAK-LARUT DAN MATANG"       
 [9] "PERAK-MANJUNG (DINDING)"       "PERLIS-PERLIS"                
[11] "PULAU PINANG-S.P.SELATAN"      "PULAU PINANG-S.P. TENGAH"     
[13] "PULAU PINANG-S.P. UTARA"       "SELANGOR-ULU LANGAT"          
[15] "SELANGOR-ULU SELANGOR"         "SELANGOR-KLANG"               
[17] "SELANGOR-PETALING"            </code></pre>
</div>
</div>
<p>That is alot of mismatch! The process involves checking the available districts in <code>mys_sf</code> and assiging the districts.</p>
</section>
<section id="re-mapping-districts" class="level4">
<h4 class="anchored" data-anchor-id="re-mapping-districts">2.3.4.2 Re-Mapping Districts</h4>
<p>After the team sat down to sort out the mapping this is the list of mapping to address the above mismatch.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>crime_df <span class="ot">&lt;-</span> crime_df <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ISKANDAR PUTERI"</span>, <span class="st">"NUSAJAYA"</span>, <span class="st">"JOHOR BAHRU SELATAN"</span>, <span class="st">"JOHOR BAHRU UTARA"</span>, <span class="st">"SERI ALAM"</span>) <span class="sc">~</span> <span class="st">"JOHOR BAHRU"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"NEGERI SEMBILAN"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"NILAI"</span> <span class="sc">~</span> <span class="st">"SEREMBAN"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KEDAH"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"BANDAR BHARU"</span> <span class="sc">~</span> <span class="st">"BANDAR BAHARU"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PAHANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"CAMERON HIGHLAND"</span> <span class="sc">~</span> <span class="st">"CAMERON HIGHLANDS"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PAHANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KUALA LIPIS"</span> <span class="sc">~</span> <span class="st">"LIPIS"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district  <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"BATU GAJAH"</span>, <span class="st">"IPOH"</span>) <span class="sc">~</span> <span class="st">"KINTA"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"GERIK"</span> <span class="sc">~</span> <span class="st">"ULU PERAK"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MANJUNG"</span> <span class="sc">~</span> <span class="st">"MANJUNG (DINDING)"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"PENGKALAN HULU"</span> <span class="sc">~</span> <span class="st">"ULU PERAK"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SELAMA"</span>, <span class="st">"TAIPING"</span>) <span class="sc">~</span> <span class="st">"LARUT DAN MATANG"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SUNGAI SIPUT"</span> <span class="sc">~</span> <span class="st">"KUALA KANGSAR"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"TANJONG MALIM"</span>, <span class="st">"TAPAH"</span>) <span class="sc">~</span> <span class="st">"BATANG PADANG"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERLIS"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ARAU"</span>, <span class="st">"KANGAR"</span>, <span class="st">"PADANG BESAR"</span>) <span class="sc">~</span> <span class="st">"PERLIS"</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI SELATAN"</span> <span class="sc">~</span> <span class="st">"S.P.SELATAN"</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI TENGAH"</span> <span class="sc">~</span> <span class="st">"S.P. TENGAH"</span>,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI UTARA"</span> <span class="sc">~</span> <span class="st">"S.P. UTARA"</span>,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"SELANGOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"AMPANG JAYA"</span> <span class="sc">~</span> <span class="st">"GOMBAK"</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"SELANGOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"HULU SELANGOR"</span> <span class="sc">~</span> <span class="st">"ULU SELANGOR"</span>,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"SELANGOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KAJANG"</span> <span class="sc">~</span> <span class="st">"ULU LANGAT"</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"SELANGOR"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"KLANG SELATAN"</span>, <span class="st">"KLANG UTARA"</span>) <span class="sc">~</span> <span class="st">"KLANG"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"SELANGOR"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PETALING JAYA"</span>, <span class="st">"SERDANG"</span>, <span class="st">"SG. BULOH"</span>, <span class="st">"SHAH ALAM"</span>, <span class="st">"SUBANG JAYA"</span>, <span class="st">"SUNGAI BULOH"</span>) <span class="sc">~</span> <span class="st">"PETALING"</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KUALA LUMPUR"</span> <span class="sc">&amp;</span> district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"BRICKFIELDS"</span>, <span class="st">"CHERAS"</span>, <span class="st">"DANG WANGI"</span>, <span class="st">"SENTUL"</span>, <span class="st">"WANGSA MAJU"</span>) <span class="sc">~</span> <span class="st">"WP. KUALA LUMPUR"</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district, year, category, type) <span class="sc">%&gt;%</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">crimes =</span> <span class="fu">sum</span>(crimes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Type of issues
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>The common issue are related to translation, or districts with different names e.g.&nbsp;“PENGKALAN HULU” ~ “ULU PERAK”</li>
<li>Some comes down to preferences e.g.&nbsp;“CAMERON HIGHLAND” ~ “CAMERON HIGHLANDS”, “MANJUNG” ~ “MANJUNG (DINDING)”,</li>
<li>And in some cases a district may be broken down into sub-districts e.g.&nbsp;c(“PETALING JAYA”, “SERDANG”, “SG. BULOH”, “SHAH ALAM”, “SUBANG JAYA”, “SUNGAI BULOH”) ~ “PETALING”,</li>
</ol>
</div>
</div>
</section>
<section id="crime-distribution" class="level4">
<h4 class="anchored" data-anchor-id="crime-distribution">2.3.4.3 Crime Distribution</h4>
<p>In the following we can see the distribution of crime rates (raw) on the map of West Malaysia. Note that the crime rates happens to be higher where the population is higher such as in Johor Bahru and Kuala Lumpur.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Table</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>og_crime_df_mys <span class="ot">&lt;-</span> crime_df <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2019</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mys_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span> <span class="ot">=</span> <span class="st">"ADM1_EN"</span>, <span class="st">"district"</span> <span class="ot">=</span> <span class="st">"ADM2_EN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(state, district, year, category, type, crimes, geometry)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>og_crime_df_mys <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(og_crime_df_mys)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>og_crime_df_mys_grp <span class="ot">&lt;-</span> og_crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_crimes =</span> <span class="fu">sum</span>(crimes)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>mys_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(mys_sf) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Districts (West Malaysia)"</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>choro_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(og_crime_df_mys_grp) <span class="sc">+</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_crimes"</span>, </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Oranges"</span>,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Crimes"</span>) <span class="sc">+</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Crime Distribution (West Malaysia)"</span>,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(choro_map, mys_map, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>og_crime_df_mys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4128 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 4,128 × 7
# Groups:   state, district, year, category [688]
   state district    year category type         crimes                  geometry
   &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt;        &lt;MULTIPOLYGON [m]&gt;
 1 JOHOR BATU PAHAT  2019 assault  causing_inj…     41 (((556714.6 192051.6, 55…
 2 JOHOR BATU PAHAT  2019 assault  murder            3 (((556714.6 192051.6, 55…
 3 JOHOR BATU PAHAT  2019 assault  rape             29 (((556714.6 192051.6, 55…
 4 JOHOR BATU PAHAT  2019 assault  robbery_gan…      0 (((556714.6 192051.6, 55…
 5 JOHOR BATU PAHAT  2019 assault  robbery_gan…     37 (((556714.6 192051.6, 55…
 6 JOHOR BATU PAHAT  2019 assault  robbery_sol…      0 (((556714.6 192051.6, 55…
 7 JOHOR BATU PAHAT  2019 assault  robbery_sol…     29 (((556714.6 192051.6, 55…
 8 JOHOR BATU PAHAT  2019 property break_in        157 (((556714.6 192051.6, 55…
 9 JOHOR BATU PAHAT  2019 property theft_other     127 (((556714.6 192051.6, 55…
10 JOHOR BATU PAHAT  2019 property theft_vehic…      4 (((556714.6 192051.6, 55…
# ℹ 4,118 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Missing Data (POKOK SENA)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note the missing data in POKOK SENA in <code>crime_df</code>, which we will be rectifying in the subsequent join with the crime aggregated by KEDAH state</p>
</div>
</div>
</section>
</section>
<section id="state-district-wrangling-population" class="level3">
<h3 class="anchored" data-anchor-id="state-district-wrangling-population">2.3.5 State-District Wrangling (Population)</h3>
<p>The crime data provided is not sufficient to paint an accurate picture of the crime patterns in Malaysia as it is heavily skewed towards places with higher population, this will not be ideal for our analysis, hence we will be importing Population by district to adjust the crime accordingly.</p>
<section id="state-district-mismatch-1" class="level4">
<h4 class="anchored" data-anchor-id="state-district-mismatch-1">2.3.5.1 State-District Mismatch</h4>
<p>The data for population is only available from 2020 - 2024. Since 2019 is missing from data set, we will do a best effort mapping where year: 2020 -&gt; 2019.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>population_row <span class="ot">&lt;-</span> population_df <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">2019</span>) </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>population_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(population_df, population_row) <span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">paste</span>(state, district, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(population_df<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2020 2021 2022 2019</code></pre>
</div>
</div>
<p>Next we check mismatch on the state-district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>state_district_population <span class="ot">&lt;-</span> <span class="fu">unique</span>(population_df<span class="sc">$</span>state_district)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>missing_in_sf <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_population, state_district_sf)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>missing_in_population <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_sf, state_district_population)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in population_df not found in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in population_df not found in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR-KULAI"                         "JOHOR-TANGKAK"                      
 [3] "KELANTAN-KECIL LOJING"               "PERAK-BAGAN DATUK"                  
 [5] "PERAK-HULU PERAK"                    "PERAK-MANJUNG"                      
 [7] "PERAK-MUALLIM"                       "PERAK-SELAMA"                       
 [9] "PULAU PINANG-SEBERANG PERAI SELATAN" "PULAU PINANG-SEBERANG PERAI TENGAH" 
[11] "PULAU PINANG-SEBERANG PERAI UTARA"   "TERENGGANU-KUALA NERUS"             
[13] "KUALA LUMPUR-W.P. KUALA LUMPUR"      "PAHANG-CAMERON HIGHLAND"            
[15] "PULAU PINANG-SP SELATAN"             "PULAU PINANG-SP TENGAH"             
[17] "PULAU PINANG-SP UTARA"              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in mys_sf not found in population_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in mys_sf not found in population_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JOHOR-KULAIJAYA"               "JOHOR-LEDANG"                 
[3] "KUALA LUMPUR-WP. KUALA LUMPUR" "PERAK-ULU PERAK"              
[5] "PERAK-MANJUNG (DINDING)"       "PULAU PINANG-S.P.SELATAN"     
[7] "PULAU PINANG-S.P. TENGAH"      "PULAU PINANG-S.P. UTARA"      </code></pre>
</div>
</div>
</section>
<section id="re-mapping-districts-1" class="level4">
<h4 class="anchored" data-anchor-id="re-mapping-districts-1">2.3.5.2 Re-Mapping Districts</h4>
<p>We employed the similar methodology to map the Population data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>population_df <span class="ot">&lt;-</span> population_df <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KULAI"</span> <span class="sc">~</span> <span class="st">"KULAIJAYA"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"TANGKAK"</span> <span class="sc">~</span> <span class="st">"LEDANG"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KELANTAN"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KECIL LOJING"</span> <span class="sc">~</span> <span class="st">"GUA MUSANG"</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PAHANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"CAMERON HIGHLAND"</span> <span class="sc">~</span> <span class="st">"CAMERON HIGHLANDS"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"HULU PERAK"</span> <span class="sc">~</span> <span class="st">"ULU PERAK"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"BAGAN DATUK"</span> <span class="sc">~</span> <span class="st">"HILIR PERAK"</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MANJUNG"</span> <span class="sc">~</span> <span class="st">"MANJUNG (DINDING)"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MUALLIM"</span> <span class="sc">~</span> <span class="st">"BATANG PADANG"</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SELAMA"</span> <span class="sc">~</span> <span class="st">"LARUT DAN MATANG"</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI SELATAN"</span> <span class="sc">~</span> <span class="st">"S.P.SELATAN"</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI TENGAH"</span> <span class="sc">~</span> <span class="st">"S.P. TENGAH"</span>,</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI UTARA"</span> <span class="sc">~</span> <span class="st">"S.P. UTARA"</span>,</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SP SELATAN"</span> <span class="sc">~</span> <span class="st">"S.P.SELATAN"</span>,</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SP TENGAH"</span> <span class="sc">~</span> <span class="st">"S.P. TENGAH"</span>,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SP UTARA"</span> <span class="sc">~</span> <span class="st">"S.P. UTARA"</span>,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"TERENGGANU"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KUALA NERUS"</span> <span class="sc">~</span> <span class="st">"KUALA TERENGGANU"</span>,</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KUALA LUMPUR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"W.P. KUALA LUMPUR"</span> <span class="sc">~</span> <span class="st">"WP. KUALA LUMPUR"</span>,</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district, year) <span class="sc">%&gt;%</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">population =</span> <span class="fu">sum</span>(population))</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>population_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 348 × 4
# Groups:   state, district [87]
   state district     year population
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 JOHOR BATU PAHAT   2019       495.
 2 JOHOR BATU PAHAT   2020       495.
 3 JOHOR BATU PAHAT   2021       497.
 4 JOHOR BATU PAHAT   2022       498.
 5 JOHOR JOHOR BAHRU  2019      1711.
 6 JOHOR JOHOR BAHRU  2020      1711.
 7 JOHOR JOHOR BAHRU  2021      1715.
 8 JOHOR JOHOR BAHRU  2022      1724.
 9 JOHOR KLUANG       2019       324.
10 JOHOR KLUANG       2020       324.
# ℹ 338 more rows</code></pre>
</div>
</div>
</section>
<section id="population-distribution" class="level4">
<h4 class="anchored" data-anchor-id="population-distribution">2.3.5.3 Population Distribution</h4>
<p>The following is a quick visualization of the population data in West Malaysia.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Overview</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>population_df_mys <span class="ot">&lt;-</span> population_df <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mys_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span> <span class="ot">=</span> <span class="st">"ADM1_EN"</span>, <span class="st">"district"</span> <span class="ot">=</span> <span class="st">"ADM2_EN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(state, district, year, population, geometry)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>population_df_mys <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(population_df_mys)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>population_df_mys_grp <span class="ot">&lt;-</span> population_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_crimes =</span> <span class="fu">sum</span>(population)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>mys_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(mys_sf) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Districts (West Malaysia)"</span>,</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>choro_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(population_df_mys_grp) <span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_crimes"</span>, </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Crimes"</span>) <span class="sc">+</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Population Distribution (West Malaysia)"</span>,</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(choro_map, mys_map, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>population_df_mys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 348 features and 4 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 348 × 5
# Groups:   state, district [87]
   state district     year population                                   geometry
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;                         &lt;MULTIPOLYGON [m]&gt;
 1 JOHOR BATU PAHAT   2019       495. (((556714.6 192051.6, 556664.6 192111.5, …
 2 JOHOR BATU PAHAT   2020       495. (((556714.6 192051.6, 556664.6 192111.5, …
 3 JOHOR BATU PAHAT   2021       497. (((556714.6 192051.6, 556664.6 192111.5, …
 4 JOHOR BATU PAHAT   2022       498. (((556714.6 192051.6, 556664.6 192111.5, …
 5 JOHOR JOHOR BAHRU  2019      1711. (((664760.7 157664.3, 664668.2 157664.3, …
 6 JOHOR JOHOR BAHRU  2020      1711. (((664760.7 157664.3, 664668.2 157664.3, …
 7 JOHOR JOHOR BAHRU  2021      1715. (((664760.7 157664.3, 664668.2 157664.3, …
 8 JOHOR JOHOR BAHRU  2022      1724. (((664760.7 157664.3, 664668.2 157664.3, …
 9 JOHOR KLUANG       2019       324. (((583499.3 195230.8, 581600.3 195991.2, …
10 JOHOR KLUANG       2020       324. (((583499.3 195230.8, 581600.3 195991.2, …
# ℹ 338 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Similarity in Observation
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can note that the districts with more crime tend to have a higher population we suggest it is positively correlated. Hence for a more accurate representation of crime rate we need to adjust the crimes to per captia (1000) for the districts.</p>
</div>
</div>
</section>
</section>
<section id="joining" class="level3">
<h3 class="anchored" data-anchor-id="joining">2.3.6 Joining</h3>
<p>We will next perform join of the data on <code>crime_df</code> with <code>population_df</code> to normalize our crime data</p>
<section id="join-with-population-data" class="level4">
<h4 class="anchored" data-anchor-id="join-with-population-data">2.3.6.1 Join with Population Data</h4>
<p>Here we compute the crimes per 1000 capita to ensure the data is normalized</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>crime_df_mys <span class="ot">&lt;-</span> crime_df <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2019</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(population_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"district"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">crimes_pc =</span> crimes<span class="sc">/</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(state, district, year, category, type, crimes, crimes_pc, population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filling-for-pokok-sena-district" class="level4">
<h4 class="anchored" data-anchor-id="filling-for-pokok-sena-district">2.3.6.2 Filling for <code>POKOK SENA</code> District</h4>
<p>Given the missing data for <code>POKOK SENA</code>, we will be getting the state average for the district in this case the state of <code>KEDAH</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>pokok_sena_rows <span class="ot">&lt;-</span> crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"KEDAH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, year, category, type) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">crimes =</span> <span class="fu">mean</span>(crimes),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">crimes_pc =</span> <span class="fu">mean</span>(crimes_pc),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">population =</span> <span class="fu">mean</span>(population)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="st">"POKOK SENA"</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>pokok_sena_rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 8
# Groups:   state, year, category [8]
   state  year category type                crimes crimes_pc population district
   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;   
 1 KEDAH  2019 assault  causing_injury      29.8    0.140          189. POKOK S…
 2 KEDAH  2019 assault  murder               1.82   0.0129         189. POKOK S…
 3 KEDAH  2019 assault  rape                13.2    0.0752         189. POKOK S…
 4 KEDAH  2019 assault  robbery_gang_armed   0.182  0.00155        189. POKOK S…
 5 KEDAH  2019 assault  robbery_gang_unar…  25.3    0.0992         189. POKOK S…
 6 KEDAH  2019 assault  robbery_solo_armed   0.182  0.000410       189. POKOK S…
 7 KEDAH  2019 assault  robbery_solo_unar…  14.7    0.0590         189. POKOK S…
 8 KEDAH  2019 property break_in           103.     0.440          189. POKOK S…
 9 KEDAH  2019 property theft_other         86.9    0.479          189. POKOK S…
10 KEDAH  2019 property theft_vehicle_lor…   7.09   0.0202         189. POKOK S…
# ℹ 38 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>crime_df_mys <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(crime_df_mys, pokok_sena_rows)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="join-with-district-boundary" class="level4">
<h4 class="anchored" data-anchor-id="join-with-district-boundary">2.3.6.3 Join with District Boundary</h4>
<p>We finish off the join with a join with our spatial dataset <code>mys_sf</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>crime_df_mys <span class="ot">&lt;-</span> crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mys_sf, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span> <span class="ot">=</span> <span class="st">"ADM1_EN"</span>, <span class="st">"district"</span> <span class="ot">=</span> <span class="st">"ADM2_EN"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(state, district, year, category, type, crimes, crimes_pc, population, geometry)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>crime_df_mys <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(crime_df_mys)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>crime_df_mys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4176 features and 8 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 4,176 × 9
# Groups:   state, district, year, category [696]
   state district    year category type              crimes crimes_pc population
   &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 JOHOR BATU PAHAT  2019 assault  causing_injury        41   0.0828        495.
 2 JOHOR BATU PAHAT  2019 assault  murder                 3   0.00606       495.
 3 JOHOR BATU PAHAT  2019 assault  rape                  29   0.0586        495.
 4 JOHOR BATU PAHAT  2019 assault  robbery_gang_arm…      0   0             495.
 5 JOHOR BATU PAHAT  2019 assault  robbery_gang_una…     37   0.0747        495.
 6 JOHOR BATU PAHAT  2019 assault  robbery_solo_arm…      0   0             495.
 7 JOHOR BATU PAHAT  2019 assault  robbery_solo_una…     29   0.0586        495.
 8 JOHOR BATU PAHAT  2019 property break_in             157   0.317         495.
 9 JOHOR BATU PAHAT  2019 property theft_other          127   0.256         495.
10 JOHOR BATU PAHAT  2019 property theft_vehicle_lo…      4   0.00808       495.
# ℹ 4,166 more rows
# ℹ 1 more variable: geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="crime-per-capita-distribution" class="level3">
<h3 class="anchored" data-anchor-id="crime-per-capita-distribution">2.3.7 Crime per Capita Distribution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>crime_df_mys_grp <span class="ot">&lt;-</span> crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_crimes_pc =</span> <span class="fu">sum</span>(crimes_pc)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>og_choro_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(og_crime_df_mys_grp) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_crimes"</span>, </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>, </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Oranges"</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Crimes"</span>) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Crime Distribution (West Malaysia)"</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>choro_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(crime_df_mys_grp) <span class="sc">+</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_crimes_pc"</span>, </span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>, </span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Oranges"</span>,</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Crimes"</span>) <span class="sc">+</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Crime per Capita Distribution"</span>,</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(og_choro_map, choro_map, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Much better!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note how much more insights we can extract from our adjusted crime choro plot. The district with population still seem to be higher in crime however we can also identify other clusters i.e.&nbsp;several cold spots in Kelantan etc.</p>
</div>
</div>
</section>
<section id="correlation-plot" class="level3">
<h3 class="anchored" data-anchor-id="correlation-plot">2.3.8 Correlation Plot</h3>
<p>Next we take a quick look at how correlated the data are with across the various types of crimes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>piv_crime_df_mys <span class="ot">&lt;-</span> crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_type =</span> <span class="fu">paste</span>(category, type, <span class="at">sep =</span> <span class="st">"-"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category, <span class="sc">-</span>type, <span class="sc">-</span>crimes, <span class="sc">-</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> cat_type,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> crimes_pc,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(<span class="fu">st_drop_geometry</span>(piv_crime_df_mys)[, <span class="dv">4</span><span class="sc">:</span><span class="dv">15</span>]),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.srt =</span> <span class="dv">45</span>, </span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>During the EDA we have noted that some crimes such as <code>robbery_gang_armed</code> tend are typically really low in record. Hence to further narrow our subsequent analysis we will group robbery as one category and vehicle theft as the other since they are highly correlated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>piv_crime_df_mys <span class="ot">&lt;-</span> piv_crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robbery =</span> <span class="st">`</span><span class="at">assault-robbery_gang_armed</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">assault-robbery_gang_unarmed</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">`</span><span class="at">assault-robbery_solo_armed</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">assault-robbery_solo_unarmed</span><span class="st">`</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">vehicle_theft =</span> <span class="st">`</span><span class="at">property-theft_vehicle_lorry</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">property-theft_vehicle_motorcar</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">`</span><span class="at">property-theft_vehicle_motorcycle</span><span class="st">`</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">assault-robbery_gang_armed</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">assault-robbery_gang_unarmed</span><span class="st">`</span>, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="st">`</span><span class="at">assault-robbery_solo_armed</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">assault-robbery_solo_unarmed</span><span class="st">`</span>,</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="st">`</span><span class="at">property-theft_vehicle_lorry</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">property-theft_vehicle_motorcar</span><span class="st">`</span>, </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="st">`</span><span class="at">property-theft_vehicle_motorcycle</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">str_remove</span>(., <span class="st">"^assault-|^property-"</span>))</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>piv_crime_df_mys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 348 features and 10 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 348 × 11
   state district   year                  geometry causing_injury  murder   rape
   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;        &lt;MULTIPOLYGON [m]&gt;          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 JOHOR BATU PAH…  2019 (((556714.6 192051.6, 55…         0.0828 0.00606 0.0586
 2 JOHOR BATU PAH…  2020 (((556714.6 192051.6, 55…         0.0868 0.00606 0.0323
 3 JOHOR BATU PAH…  2021 (((556714.6 192051.6, 55…         0.0442 0       0.0362
 4 JOHOR BATU PAH…  2022 (((556714.6 192051.6, 55…         0.0382 0.00603 0.0261
 5 JOHOR JOHOR BA…  2019 (((664760.7 157664.3, 66…         0.212  0.0117  0.0590
 6 JOHOR JOHOR BA…  2020 (((664760.7 157664.3, 66…         0.140  0.00993 0.0392
 7 JOHOR JOHOR BA…  2021 (((664760.7 157664.3, 66…         0.113  0.00466 0.0402
 8 JOHOR JOHOR BA…  2022 (((664760.7 157664.3, 66…         0.101  0.00986 0.0365
 9 JOHOR KLUANG     2019 (((583499.3 195230.8, 58…         0.185  0.0124  0.0525
10 JOHOR KLUANG     2020 (((583499.3 195230.8, 58…         0.133  0.00618 0.0494
# ℹ 338 more rows
# ℹ 4 more variables: break_in &lt;dbl&gt;, theft_other &lt;dbl&gt;, robbery &lt;dbl&gt;,
#   vehicle_theft &lt;dbl&gt;</code></pre>
</div>
</div>
<p>The final crime type correlation matrix should look like the following.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(<span class="fu">st_drop_geometry</span>(piv_crime_df_mys)[, <span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>]),</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.srt =</span> <span class="dv">45</span>, </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Initial Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Across the board it seems like only <code>robbery</code> have high correlation with <code>vehicle_theft</code>. However we will not be dropping either as they are key variables we would like extract insights from.</p>
</div>
</div>
</section>
</section>
<section id="data-enrichment" class="level2">
<h2 class="anchored" data-anchor-id="data-enrichment">2.4 Data Enrichment</h2>
<p>To further enrich our analysis we will incoporate several socio-economic data which may potentially influence/affect crime rates such labour participation rates, poverty and income inequality by district</p>
<section id="state-wrangling-1" class="level3">
<h3 class="anchored" data-anchor-id="state-wrangling-1">2.4.1 State Wrangling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(mys_sf<span class="sc">$</span>ADM1_EN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"           "KEDAH"           "KELANTAN"        "KUALA LUMPUR"   
 [5] "MELAKA"          "NEGERI SEMBILAN" "PAHANG"          "PERAK"          
 [9] "PERLIS"          "PULAU PINANG"    "TERENGGANU"      "SELANGOR"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in poverty_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in poverty_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(poverty_df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Johor"             "Kedah"             "Kelantan"         
 [4] "Melaka"            "Negeri Sembilan"   "Pahang"           
 [7] "Perak"             "Perlis"            "Pulau Pinang"     
[10] "Sabah"             "Sarawak"           "Selangor"         
[13] "Terengganu"        "W.P. Kuala Lumpur" "W.P. Labuan"      
[16] "W.P. Putrajaya"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in inequality_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in inequality_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(inequality_df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Johor"             "Kedah"             "Kelantan"         
 [4] "Melaka"            "Negeri Sembilan"   "Pahang"           
 [7] "Perak"             "Perlis"            "Pulau Pinang"     
[10] "Sabah"             "Sarawak"           "Selangor"         
[13] "Terengganu"        "W.P. Kuala Lumpur" "W.P. Labuan"      
[16] "W.P. Putrajaya"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states in labour_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states in labour_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(labour_df<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Johor"           "Kedah"           "Kelantan"        "Melaka"         
 [5] "Negeri Sembilan" "Pahang"          "Perak"           "Pulau Pinang"   
 [9] "Sabah"           "Sarawak"         "Selangor"        "Terengganu"     </code></pre>
</div>
</div>
<p>Similarly we prep the data by transforming the data and filtering out east Malaysia</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>poverty_df <span class="ot">&lt;-</span> poverty_df <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">toupper</span>(state),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">district =</span> <span class="fu">toupper</span>(district)) <span class="sc">%&gt;%</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(state <span class="sc">!=</span> <span class="st">'SABAH'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'SARAWAK'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'W.P. LABUAN'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. KUALA LUMPUR'</span>, <span class="st">'KUALA LUMPUR'</span>),</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. PUTRAJAYA'</span>, <span class="st">'KUALA LUMPUR'</span>))</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>inequality_df <span class="ot">&lt;-</span> inequality_df <span class="sc">%&gt;%</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">toupper</span>(state),</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">district =</span> <span class="fu">toupper</span>(district)) <span class="sc">%&gt;%</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(state <span class="sc">!=</span> <span class="st">'SABAH'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'SARAWAK'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'W.P. LABUAN'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. KUALA LUMPUR'</span>, <span class="st">'KUALA LUMPUR'</span>),</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">replace</span>(state, state <span class="sc">==</span> <span class="st">'W.P. PUTRAJAYA'</span>, <span class="st">'KUALA LUMPUR'</span>))</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>labour_df <span class="ot">&lt;-</span> labour_df <span class="sc">%&gt;%</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">state =</span> <span class="fu">toupper</span>(state),</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">district =</span> <span class="fu">toupper</span>(district)) <span class="sc">%&gt;%</span></span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(state <span class="sc">!=</span> <span class="st">'SABAH'</span> <span class="sc">&amp;</span> state <span class="sc">!=</span> <span class="st">'SARAWAK'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states &amp; years in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states &amp; years in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(mys_sf<span class="sc">$</span>ADM1_EN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"           "KEDAH"           "KELANTAN"        "KUALA LUMPUR"   
 [5] "MELAKA"          "NEGERI SEMBILAN" "PAHANG"          "PERAK"          
 [9] "PERLIS"          "PULAU PINANG"    "SELANGOR"        "TERENGGANU"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states &amp; years in poverty_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states &amp; years in poverty_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(poverty_df<span class="sc">$</span>state))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"           "KEDAH"           "KELANTAN"        "KUALA LUMPUR"   
 [5] "MELAKA"          "NEGERI SEMBILAN" "PAHANG"          "PERAK"          
 [9] "PERLIS"          "PULAU PINANG"    "SELANGOR"        "TERENGGANU"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(poverty_df<span class="sc">$</span>year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2019 2022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states &amp; years in inequality_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states &amp; years in inequality_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(inequality_df<span class="sc">$</span>state))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"           "KEDAH"           "KELANTAN"        "KUALA LUMPUR"   
 [5] "MELAKA"          "NEGERI SEMBILAN" "PAHANG"          "PERAK"          
 [9] "PERLIS"          "PULAU PINANG"    "SELANGOR"        "TERENGGANU"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(inequality_df<span class="sc">$</span>year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2019 2022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Unique states &amp; years in labour_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Unique states &amp; years in labour_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(labour_df<span class="sc">$</span>state))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR"           "KEDAH"           "KELANTAN"        "MELAKA"         
 [5] "NEGERI SEMBILAN" "PAHANG"          "PERAK"           "PULAU PINANG"   
 [9] "SELANGOR"        "TERENGGANU"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(labour_df<span class="sc">$</span>year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2019 2020 2021 2022</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Critical Data Issues
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the data we identified 2 issues: 1. Poverty and Inequality data is missing years 2020 and 2021 2. Labour data is missing PERLIS, KUALA LUMPUR and PUTRAJAYA</p>
</div>
</div>
</section>
<section id="state-district-wrangling-poverty-inequaltiy" class="level3">
<h3 class="anchored" data-anchor-id="state-district-wrangling-poverty-inequaltiy">2.4.2 State-District Wrangling (Poverty &amp; Inequaltiy)</h3>
<section id="filling-year-data" class="level4">
<h4 class="anchored" data-anchor-id="filling-year-data">2.4.2.1 Filling Year Data</h4>
<p>Since years 2020 and 2021 are missing from data set, we will map to prior or the next year:</p>
<ul>
<li><p>2020 -&gt; 2019</p></li>
<li><p>2021 -&gt; 2022</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>poverty_rows <span class="ot">&lt;-</span> poverty_df <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2021</span>))</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>poverty_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(poverty_df, poverty_rows)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(poverty_df<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2019 2022 2020 2021</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>inequality_rows <span class="ot">&lt;-</span> inequality_df <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2021</span>))</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>inequality_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(inequality_df, inequality_rows)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(inequality_df<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2019 2022 2020 2021</code></pre>
</div>
</div>
</section>
<section id="state-district-mismatch-2" class="level4">
<h4 class="anchored" data-anchor-id="state-district-mismatch-2">2.4.2.2 State-District Mismatch</h4>
<p>Similarly we will have to wrangle for District level too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>poverty_df <span class="ot">&lt;-</span> poverty_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">paste</span>(state, district, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>inequality_df <span class="ot">&lt;-</span> inequality_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">paste</span>(state, district, <span class="at">sep =</span> <span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since the data for inequality comes from the same ministry and the districts are the same we will only be checking for Poverty.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>state_district_poverty <span class="ot">&lt;-</span> <span class="fu">unique</span>(poverty_df<span class="sc">$</span>state_district)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>missing_in_sf <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_poverty, state_district_sf)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>missing_in_poverty <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_sf, state_district_poverty)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in poverty_df not found in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in poverty_df not found in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR-KULAI"                         "JOHOR-TANGKAK"                      
 [3] "KELANTAN-KECIL LOJING"               "PERAK-BAGAN DATUK"                  
 [5] "PERAK-HULU PERAK"                    "PERAK-MANJUNG"                      
 [7] "PERAK-MUALLIM"                       "PERAK-SELAMA"                       
 [9] "PULAU PINANG-SEBERANG PERAI SELATAN" "PULAU PINANG-SEBERANG PERAI TENGAH" 
[11] "PULAU PINANG-SEBERANG PERAI UTARA"   "TERENGGANU-KUALA NERUS"             
[13] "KUALA LUMPUR-W.P. KUALA LUMPUR"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in mys_sf not found in poverty_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in mys_sf not found in poverty_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_poverty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JOHOR-KULAIJAYA"               "JOHOR-LEDANG"                 
[3] "KUALA LUMPUR-WP. KUALA LUMPUR" "PERAK-ULU PERAK"              
[5] "PERAK-MANJUNG (DINDING)"       "PULAU PINANG-S.P.SELATAN"     
[7] "PULAU PINANG-S.P. TENGAH"      "PULAU PINANG-S.P. UTARA"      </code></pre>
</div>
</div>
</section>
<section id="re-mapping-districts-2" class="level4">
<h4 class="anchored" data-anchor-id="re-mapping-districts-2">2.4.2.3 Re-Mapping Districts</h4>
<p>This step is getting tedious, but still, very crucial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>poverty_df <span class="ot">&lt;-</span> poverty_df <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KULAI"</span> <span class="sc">~</span> <span class="st">"KULAIJAYA"</span>,</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"TANGKAK"</span> <span class="sc">~</span> <span class="st">"LEDANG"</span>,</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KELANTAN"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KECIL LOJING"</span> <span class="sc">~</span> <span class="st">"GUA MUSANG"</span>,</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"HULU PERAK"</span> <span class="sc">~</span> <span class="st">"ULU PERAK"</span>,</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"BAGAN DATUK"</span> <span class="sc">~</span> <span class="st">"HILIR PERAK"</span>,</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MANJUNG"</span> <span class="sc">~</span> <span class="st">"MANJUNG (DINDING)"</span>,</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MUALLIM"</span> <span class="sc">~</span> <span class="st">"BATANG PADANG"</span>,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SELAMA"</span> <span class="sc">~</span> <span class="st">"LARUT DAN MATANG"</span>,</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI SELATAN"</span> <span class="sc">~</span> <span class="st">"S.P.SELATAN"</span>,</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI TENGAH"</span> <span class="sc">~</span> <span class="st">"S.P. TENGAH"</span>,</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI UTARA"</span> <span class="sc">~</span> <span class="st">"S.P. UTARA"</span>,</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"TERENGGANU"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KUALA NERUS"</span> <span class="sc">~</span> <span class="st">"KUALA TERENGGANU"</span>,</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KUALA LUMPUR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"W.P. KUALA LUMPUR"</span> <span class="sc">~</span> <span class="st">"WP. KUALA LUMPUR"</span>,</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district, year) <span class="sc">%&gt;%</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">poverty_absolute =</span> <span class="fu">mean</span>(poverty_absolute),</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">poverty_relative =</span> <span class="fu">mean</span>(poverty_relative))</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>poverty_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 348 × 5
# Groups:   state, district [87]
   state district     year poverty_absolute poverty_relative
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
 1 JOHOR BATU PAHAT   2019              2.9              9  
 2 JOHOR BATU PAHAT   2020              2.9              9  
 3 JOHOR BATU PAHAT   2021              5.1             19.4
 4 JOHOR BATU PAHAT   2022              5.1             19.4
 5 JOHOR JOHOR BAHRU  2019              3.3             12.8
 6 JOHOR JOHOR BAHRU  2020              3.3             12.8
 7 JOHOR JOHOR BAHRU  2021              3.7             10.4
 8 JOHOR JOHOR BAHRU  2022              3.7             10.4
 9 JOHOR KLUANG       2019              5               24.9
10 JOHOR KLUANG       2020              5               24.9
# ℹ 338 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>inequality_df <span class="ot">&lt;-</span> inequality_df <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KULAI"</span> <span class="sc">~</span> <span class="st">"KULAIJAYA"</span>,</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"TANGKAK"</span> <span class="sc">~</span> <span class="st">"LEDANG"</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KELANTAN"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KECIL LOJING"</span> <span class="sc">~</span> <span class="st">"GUA MUSANG"</span>,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"HULU PERAK"</span> <span class="sc">~</span> <span class="st">"ULU PERAK"</span>,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"BAGAN DATUK"</span> <span class="sc">~</span> <span class="st">"HILIR PERAK"</span>,</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MANJUNG"</span> <span class="sc">~</span> <span class="st">"MANJUNG (DINDING)"</span>,</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MUALLIM"</span> <span class="sc">~</span> <span class="st">"BATANG PADANG"</span>,</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SELAMA"</span> <span class="sc">~</span> <span class="st">"LARUT DAN MATANG"</span>,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI SELATAN"</span> <span class="sc">~</span> <span class="st">"S.P.SELATAN"</span>,</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI TENGAH"</span> <span class="sc">~</span> <span class="st">"S.P. TENGAH"</span>,</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI UTARA"</span> <span class="sc">~</span> <span class="st">"S.P. UTARA"</span>,</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"TERENGGANU"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KUALA NERUS"</span> <span class="sc">~</span> <span class="st">"KUALA TERENGGANU"</span>,</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"KUALA LUMPUR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"W.P. KUALA LUMPUR"</span> <span class="sc">~</span> <span class="st">"WP. KUALA LUMPUR"</span>,</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district, year) <span class="sc">%&gt;%</span></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">gini =</span> <span class="fu">mean</span>(gini))</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>inequality_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 348 × 4
# Groups:   state, district [87]
   state district     year  gini
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 JOHOR BATU PAHAT   2019 0.295
 2 JOHOR BATU PAHAT   2020 0.295
 3 JOHOR BATU PAHAT   2021 0.338
 4 JOHOR BATU PAHAT   2022 0.338
 5 JOHOR JOHOR BAHRU  2019 0.388
 6 JOHOR JOHOR BAHRU  2020 0.388
 7 JOHOR JOHOR BAHRU  2021 0.359
 8 JOHOR JOHOR BAHRU  2022 0.359
 9 JOHOR KLUANG       2019 0.333
10 JOHOR KLUANG       2020 0.333
# ℹ 338 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="state-distrcit-wrangling-labour" class="level3">
<h3 class="anchored" data-anchor-id="state-distrcit-wrangling-labour">2.4.3 State-Distrcit Wrangling (Labour)</h3>
<section id="state-district-mismatch-3" class="level4">
<h4 class="anchored" data-anchor-id="state-district-mismatch-3">2.4.3.1 State-District Mismatch</h4>
<p>No change as with above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>labour_df <span class="ot">&lt;-</span> labour_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">paste</span>(state, district, <span class="at">sep =</span> <span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>state_district_labour <span class="ot">&lt;-</span> <span class="fu">unique</span>(labour_df<span class="sc">$</span>state_district)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>missing_in_sf <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_labour, state_district_sf)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>missing_in_labour <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(state_district_sf, state_district_labour)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in labour_df not found in mys_sf:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in labour_df not found in mys_sf:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JOHOR-KULAI"                         "JOHOR-TANGKAK"                      
[3] "PERAK-HULU PERAK"                    "PERAK-MANJUNG"                      
[5] "PULAU PINANG-SEBERANG PERAI SELATAN" "PULAU PINANG-SEBERANG PERAI TENGAH" 
[7] "PULAU PINANG-SEBERANG PERAI UTARA"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"State-District combinations in mys_sf not found in labour_df:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "State-District combinations in mys_sf not found in labour_df:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_in_labour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "JOHOR-KULAIJAYA"               "JOHOR-LEDANG"                 
 [3] "KUALA LUMPUR-WP. KUALA LUMPUR" "PERAK-ULU PERAK"              
 [5] "PERAK-MANJUNG (DINDING)"       "PERLIS-PERLIS"                
 [7] "PULAU PINANG-S.P.SELATAN"      "PULAU PINANG-S.P. TENGAH"     
 [9] "PULAU PINANG-S.P. UTARA"       "KUALA LUMPUR-W.P. PUTRAJAYA"  </code></pre>
</div>
</div>
</section>
<section id="re-mapping-districts-3" class="level4">
<h4 class="anchored" data-anchor-id="re-mapping-districts-3">2.4.3.2 Re-Mapping Districts</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>labour_df <span class="ot">&lt;-</span> labour_df <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">case_when</span>(</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"KULAI"</span> <span class="sc">~</span> <span class="st">"KULAIJAYA"</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"JOHOR"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"TANGKAK"</span> <span class="sc">~</span> <span class="st">"LEDANG"</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"HULU PERAK"</span> <span class="sc">~</span> <span class="st">"ULU PERAK"</span>,</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PERAK"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"MANJUNG"</span> <span class="sc">~</span> <span class="st">"MANJUNG (DINDING)"</span>,</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI SELATAN"</span> <span class="sc">~</span> <span class="st">"S.P.SELATAN"</span>,</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI TENGAH"</span> <span class="sc">~</span> <span class="st">"S.P. TENGAH"</span>,</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"PULAU PINANG"</span> <span class="sc">&amp;</span> district <span class="sc">==</span> <span class="st">"SEBERANG PERAI UTARA"</span> <span class="sc">~</span> <span class="st">"S.P. UTARA"</span>,</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> district</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district, year) <span class="sc">%&gt;%</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lf =</span> <span class="fu">mean</span>(lf),</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf_employed =</span> <span class="fu">mean</span>(lf_employed),</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf_unemployed =</span> <span class="fu">mean</span>(lf_unemployed),</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf_outside =</span> <span class="fu">mean</span>(lf_outside),</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_rate =</span> <span class="fu">mean</span>(p_rate),</span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">u_rate =</span> <span class="fu">mean</span>(u_rate),</span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">ep_ratio =</span> <span class="fu">mean</span>(ep_ratio))</span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>labour_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336 × 10
# Groups:   state, district [84]
   state district  year    lf lf_employed lf_unemployed lf_outside p_rate u_rate
   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 JOHOR BATU PA…  2019  214.        210.           3.7       90.4   70.3    1.7
 2 JOHOR BATU PA…  2020  219.        214.           4.7       92.2   70.4    2.1
 3 JOHOR BATU PA…  2021  216         211            5         97.1   69      2.3
 4 JOHOR BATU PA…  2022  221.        217.           4         94.6   70      1.8
 5 JOHOR JOHOR B…  2019  792.        768.          24.6      294.    73      3.1
 6 JOHOR JOHOR B…  2020  804.        771.          32.5      297.    73      4  
 7 JOHOR JOHOR B…  2021  806.        772.          34.1      298.    73      4.2
 8 JOHOR JOHOR B…  2022  830.        799           30.5      293.    73.9    3.7
 9 JOHOR KLUANG    2019  166.        160.           5.6       66.9   71.3    3.4
10 JOHOR KLUANG    2020  168.        161.           7.1       67.4   71.4    4.2
# ℹ 326 more rows
# ℹ 1 more variable: ep_ratio &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Missing labour data
</div>
</div>
<div class="callout-body-container callout-body">
<p>However we do not have labour data for the following state-districts, hence we will be using the national average for:</p>
<ol type="1">
<li><p>“PERLIS-PERLIS”</p></li>
<li><p>“KUALA LUMPUR-WP. KUALA LUMPUR”</p></li>
<li><p>“KUALA LUMPUR-W.P. PUTRAJAYA”</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="joining-1" class="level3">
<h3 class="anchored" data-anchor-id="joining-1">2.4.4 Joining</h3>
<section id="join-with-poverty-inequality-and-labour" class="level4">
<h4 class="anchored" data-anchor-id="join-with-poverty-inequality-and-labour">2.4.4.1 Join with Poverty, Inequality and Labour</h4>
<p>We join the other aspatial data with our spatial crime dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>piv_full_df_mys <span class="ot">&lt;-</span> piv_crime_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(poverty_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"district"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(inequality_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"district"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(labour_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"district"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(population_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"district"</span>, <span class="st">"year"</span>))</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>piv_full_df_mys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 348 features and 21 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 184853.1 ymin: 139843.3 xmax: 728635.8 ymax: 744607.2
Projected CRS: Kertau (RSO) / RSO Malaya (m)
# A tibble: 348 × 22
   state district   year                  geometry causing_injury  murder   rape
   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;        &lt;MULTIPOLYGON [m]&gt;          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 JOHOR BATU PAH…  2019 (((556714.6 192051.6, 55…         0.0828 0.00606 0.0586
 2 JOHOR BATU PAH…  2020 (((556714.6 192051.6, 55…         0.0868 0.00606 0.0323
 3 JOHOR BATU PAH…  2021 (((556714.6 192051.6, 55…         0.0442 0       0.0362
 4 JOHOR BATU PAH…  2022 (((556714.6 192051.6, 55…         0.0382 0.00603 0.0261
 5 JOHOR JOHOR BA…  2019 (((664760.7 157664.3, 66…         0.212  0.0117  0.0590
 6 JOHOR JOHOR BA…  2020 (((664760.7 157664.3, 66…         0.140  0.00993 0.0392
 7 JOHOR JOHOR BA…  2021 (((664760.7 157664.3, 66…         0.113  0.00466 0.0402
 8 JOHOR JOHOR BA…  2022 (((664760.7 157664.3, 66…         0.101  0.00986 0.0365
 9 JOHOR KLUANG     2019 (((583499.3 195230.8, 58…         0.185  0.0124  0.0525
10 JOHOR KLUANG     2020 (((583499.3 195230.8, 58…         0.133  0.00618 0.0494
# ℹ 338 more rows
# ℹ 15 more variables: break_in &lt;dbl&gt;, theft_other &lt;dbl&gt;, robbery &lt;dbl&gt;,
#   vehicle_theft &lt;dbl&gt;, poverty_absolute &lt;dbl&gt;, poverty_relative &lt;dbl&gt;,
#   gini &lt;dbl&gt;, lf &lt;dbl&gt;, lf_employed &lt;dbl&gt;, lf_unemployed &lt;dbl&gt;,
#   lf_outside &lt;dbl&gt;, p_rate &lt;dbl&gt;, u_rate &lt;dbl&gt;, ep_ratio &lt;dbl&gt;,
#   population &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="data-subsitution-labour" class="level4">
<h4 class="anchored" data-anchor-id="data-subsitution-labour">2.4.4.2 Data Subsitution (Labour)</h4>
<p>Similar to crime, labour force will also need to be adjusted to the districts population for a more accurate representation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>piv_full_df_mys <span class="ot">&lt;-</span> piv_full_df_mys <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lf =</span> lf<span class="sc">/</span>population,</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lf_employed =</span> lf_employed<span class="sc">/</span>population,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">lf_unemployed =</span> lf_unemployed<span class="sc">/</span>population,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lf_outside =</span> lf_outside<span class="sc">/</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we will be substituting the national average for the previously highlighted missing data from the labour dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>target_states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PERLIS"</span>, <span class="st">"KUALA LUMPUR"</span>)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>target_districts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PERLIS"</span>, <span class="st">"WP. KUALA LUMPUR"</span>, <span class="st">"W.P. PUTRAJAYA"</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>avg_values <span class="ot">&lt;-</span> piv_full_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts)) <span class="sc">%&gt;%</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lf =</span> <span class="fu">mean</span>(lf, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lf_employed =</span> <span class="fu">mean</span>(lf_employed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lf_unemployed =</span> <span class="fu">mean</span>(lf_unemployed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lf_outside =</span> <span class="fu">mean</span>(lf_outside, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_p_rate =</span> <span class="fu">mean</span>(p_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_u_rate =</span> <span class="fu">mean</span>(u_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_ep_ratio =</span> <span class="fu">mean</span>(ep_ratio, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>piv_full_df_mys <span class="ot">&lt;-</span> piv_full_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">lf =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(lf), avg_values<span class="sc">$</span>avg_lf, lf),</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lf_employed =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(lf_employed), avg_values<span class="sc">$</span>avg_lf_employed, lf_employed),</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">lf_unemployed =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(lf_unemployed), avg_values<span class="sc">$</span>avg_lf_unemployed, lf_unemployed),</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">lf_outside =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(lf_outside), avg_values<span class="sc">$</span>avg_lf_outside, lf_outside),</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_rate =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(p_rate), avg_values<span class="sc">$</span>avg_p_rate, p_rate),</span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">u_rate =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(u_rate), avg_values<span class="sc">$</span>avg_u_rate, u_rate),</span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ep_ratio =</span> <span class="fu">ifelse</span>(state <span class="sc">%in%</span> target_states <span class="sc">&amp;</span> district <span class="sc">%in%</span> target_districts <span class="sc">&amp;</span> <span class="fu">is.na</span>(ep_ratio), avg_values<span class="sc">$</span>avg_ep_ratio, ep_ratio)</span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aggregate-all-years" class="level4">
<h4 class="anchored" data-anchor-id="aggregate-all-years">2.4.4.3 Aggregate all Years</h4>
<p>We will keep the year for filtering our application, hence we will also create an aggregate the data across the 4 years (2019 - 2022)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>piv_full_df_mys_agg <span class="ot">&lt;-</span> piv_full_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, district) <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">year =</span> <span class="dv">0</span>,</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">causing_injury =</span> <span class="fu">mean</span>(causing_injury),</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">murder =</span> <span class="fu">mean</span>(murder),</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">rape =</span> <span class="fu">mean</span>(rape),</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">robbery =</span> <span class="fu">mean</span>(robbery),</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">break_in =</span> <span class="fu">mean</span>(break_in),</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">theft_other =</span> <span class="fu">mean</span>(theft_other),</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vehicle_theft =</span> <span class="fu">mean</span>(vehicle_theft),</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">poverty_absolute =</span> <span class="fu">mean</span>(poverty_absolute),</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">poverty_relative =</span> <span class="fu">mean</span>(poverty_relative),</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">gini =</span> <span class="fu">mean</span>(gini),</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf =</span> <span class="fu">mean</span>(lf),</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf_employed =</span> <span class="fu">mean</span>(lf_employed),</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf_unemployed =</span> <span class="fu">mean</span>(lf_unemployed),</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">lf_outside =</span> <span class="fu">mean</span>(lf_outside),</span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_rate =</span> <span class="fu">mean</span>(p_rate),</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">u_rate =</span> <span class="fu">mean</span>(u_rate),</span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">ep_ratio =</span> <span class="fu">mean</span>(ep_ratio))</span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>piv_full_df_mys <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(piv_full_df_mys, piv_full_df_mys_agg)</span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(piv_full_df_mys<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2019 2020 2021 2022    0</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="data-selection" class="level2">
<h2 class="anchored" data-anchor-id="data-selection">2.5 Data Selection</h2>
<p>To simplify our subsequent analysis and fine tune our clustering we will be checking for any highly correlated non-crime data and remove them for clustering.</p>
<section id="visualizing-the-correlation-of-data" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-correlation-of-data">2.5.1 Visualizing the Correlation of Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(<span class="fu">st_drop_geometry</span>(piv_full_df_mys <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">0</span>))[, <span class="dv">4</span><span class="sc">:</span><span class="dv">20</span>]),</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.srt =</span> <span class="dv">45</span>,  <span class="co"># Slant the labels by 45 degrees</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="final-selection" class="level3">
<h3 class="anchored" data-anchor-id="final-selection">2.5.2 Final Selection</h3>
<p>Since the variable</p>
<ol type="1">
<li><p><code>ep_ratio</code> is highly correlated (&gt;0.8) with <code>lf</code>, <code>lf_employed</code>, <code>lf_outside</code> and <code>p_rate</code> we can drop them from the dataframe. (Employment ratio is much more intutive too)</p></li>
<li><p><code>u_rate</code> is highly correlated (&gt;0.8) with <code>lf_unemployed</code> we can drop it too.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys <span class="ot">&lt;-</span> piv_full_df_mys <span class="sc">%&gt;%</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_district =</span> <span class="fu">str_to_title</span>(<span class="fu">paste</span>(state, district, <span class="at">sep =</span> <span class="st">"-"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lf, <span class="sc">-</span>lf_employed, <span class="sc">-</span>lf_unemployed, <span class="sc">-</span>lf_outside, <span class="sc">-</span>p_rate) <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">str_replace_all</span>(., <span class="fu">c</span>(<span class="st">"ep_ratio"</span> <span class="ot">=</span> <span class="st">"employment_ratio"</span>, <span class="st">"u_rate"</span> <span class="ot">=</span> <span class="st">"unemployment_rate"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_district, <span class="fu">everything</span>())</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(piv_df_mys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "state_district"    "state"             "district"         
 [4] "year"              "geometry"          "causing_injury"   
 [7] "murder"            "rape"              "break_in"         
[10] "theft_other"       "robbery"           "vehicle_theft"    
[13] "poverty_absolute"  "poverty_relative"  "gini"             
[16] "unemployment_rate" "employment_ratio" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(<span class="fu">st_drop_geometry</span>(piv_df_mys <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">0</span>))[, <span class="dv">5</span><span class="sc">:</span><span class="dv">16</span>]),</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks much better, now lets save it as <code>rds</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(piv_df_mys, <span class="st">"./data/rds/pivot_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"./data/rds/pivot_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="analysis-preparations" class="level1">
<h1>3. Analysis Preparations</h1>
<p>We are almost there, but before we can start clustering our data, we should take a quick glance at the data.</p>
<section id="variable-exploration" class="level2">
<h2 class="anchored" data-anchor-id="variable-exploration">3.1 Variable Exploration</h2>
<section id="data-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="data-standardisation">3.1.1 Data Standardisation</h3>
<p>We create a standardised version of the data with <code>min-max</code> scaling to ensure all the data are normalized between 0.0 - 1.0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys.all <span class="ot">&lt;-</span> piv_df_mys <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>clust_rownames <span class="ot">&lt;-</span> piv_df_mys.all<span class="sc">$</span>state_district</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>og_clust_vars <span class="ot">&lt;-</span> piv_df_mys.all <span class="sc">%&gt;%</span> </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>state_district, <span class="sc">-</span>state, <span class="sc">-</span>district, <span class="sc">-</span>year) <span class="sc">%&gt;%</span> </span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>clust_vars <span class="ot">&lt;-</span> og_clust_vars <span class="sc">%&gt;%</span> <span class="fu">normalize</span>()</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(og_clust_vars) <span class="ot">&lt;-</span> clust_rownames</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(clust_vars) <span class="ot">&lt;-</span> clust_rownames</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(clust_vars, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 12
   causing_injury murder   rape break_in theft_other robbery vehicle_theft
            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;
 1          0.165 0.142  0.0852    0.198      0.0453  0.107         0.123 
 2          0.508 0.282  0.112     0.404      0.242   0.366         0.721 
 3          0.468 0.241  0.102     0.150      0.108   0.155         0.308 
 4          0.316 0.385  0.127     0.287      0.145   0.113         0.408 
 5          0.198 0.332  0.0431    0.182      0.127   0.231         0.253 
 6          0.102 0.0476 0.0178    0.203      0.0541  0.0782        0.142 
 7          0.504 0.296  0.239     0.267      0.129   0.152         0.254 
 8          0.233 0.0993 0.0612    0.170      0.0289  0.0727        0.0900
 9          0.147 0      0.151     0.127      0.0204  0.103         0.267 
10          0.354 0.316  0.108     0.270      0.173   0.141         0.198 
# ℹ 5 more variables: poverty_absolute &lt;dbl&gt;, poverty_relative &lt;dbl&gt;,
#   gini &lt;dbl&gt;, unemployment_rate &lt;dbl&gt;, employment_ratio &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="histograms" class="level3">
<h3 class="anchored" data-anchor-id="histograms">3.1.2 Histograms</h3>
<p>In the following we will take a look at each of the variables distribution as <code>Histogram</code>, <code>Density</code> and <code>Boxplot</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Min-Max Standardisation</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>hist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(og_clust_vars)) {</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  hist_list[[col]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> og_clust_vars, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">str_to_title</span>(<span class="fu">str_replace_all</span>(col, <span class="st">"_"</span>, <span class="st">" "</span>)))</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hist_list, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>hist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(clust_vars)) {</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  hist_list[[col]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> clust_vars, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">str_to_title</span>(<span class="fu">str_replace_all</span>(col, <span class="st">"_"</span>, <span class="st">" "</span>)))</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hist_list, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="density-plot" class="level3">
<h3 class="anchored" data-anchor-id="density-plot">3.1.3 Density Plot</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Min-Max Standardisation</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>hist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(og_clust_vars)) {</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  hist_list[[col]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> og_clust_vars, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">str_to_title</span>(<span class="fu">str_replace_all</span>(col, <span class="st">"_"</span>, <span class="st">" "</span>)))</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hist_list, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>hist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(clust_vars)) {</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  hist_list[[col]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> clust_vars, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">str_to_title</span>(<span class="fu">str_replace_all</span>(col, <span class="st">"_"</span>, <span class="st">" "</span>)))</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hist_list, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="boxplots" class="level3">
<h3 class="anchored" data-anchor-id="boxplots">3.1.4 Boxplots</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Original</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Min-Max Standardisation</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>hist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(og_clust_vars)) {</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  hist_list[[col]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> og_clust_vars, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">str_to_title</span>(<span class="fu">str_replace_all</span>(col, <span class="st">"_"</span>, <span class="st">" "</span>)))</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hist_list, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>hist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(clust_vars)) {</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  hist_list[[col]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> clust_vars, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">str_to_title</span>(<span class="fu">str_replace_all</span>(col, <span class="st">"_"</span>, <span class="st">" "</span>)))</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> hist_list, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="selecting-no.-of-clusters" class="level2">
<h2 class="anchored" data-anchor-id="selecting-no.-of-clusters">3.2 Selecting No.&nbsp;of Clusters</h2>
<p>Next we will be using the NbClust package to help us determine the number of clusters with the best clustering scheme from the different results obtained by varying all combinations of number of clusters, distance measures, and clustering methods (Including gap stat).</p>
<section id="compute-nbclust" class="level3">
<h3 class="anchored" data-anchor-id="compute-nbclust">3.2.1 Compute NbClust</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>nbc <span class="ot">&lt;-</span> <span class="fu">NbClust</span>(clust_vars, <span class="at">distance =</span> <span class="st">"euclidean"</span>, <span class="at">min.nc =</span> <span class="dv">5</span>, <span class="at">max.nc =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-57-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 4 proposed 5 as the best number of clusters 
* 2 proposed 6 as the best number of clusters 
* 9 proposed 7 as the best number of clusters 
* 2 proposed 9 as the best number of clusters 
* 6 proposed 10 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  7 
 
 
******************************************************************* </code></pre>
</div>
</div>
</section>
<section id="visualizing-nb-clust" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-nb-clust">3.2.2 Visualizing NB Clust</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Avg Silhouette Width</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Within Sum of Square</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Gap Statistics</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(clust_vars, <span class="at">FUNcluster =</span> hcut, <span class="at">method =</span> <span class="st">"silhouette"</span>, <span class="at">k.max =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(clust_vars, <span class="at">FUNcluster =</span> hcut, <span class="at">method =</span> <span class="st">"wss"</span>, <span class="at">k.max =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(clust_vars, <span class="at">FUNcluster =</span> hcut, <span class="at">method =</span> <span class="st">"gap_stat"</span>, <span class="at">k.max =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
No.&nbsp;7 seems best
</div>
</div>
<div class="callout-body-container callout-body">
<p>From NbClust results it seem like 7 clustered is favored by 9 methods, however the number of cluster can be adjusted within the actual Shiny Application.</p>
</div>
</div>
</section>
</section>
<section id="hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-clustering">3.3 Hierarchical Clustering</h2>
<p>We will set our number of cluster for consistency across the subsequent clustering we will be doing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>n_clust <span class="ot">=</span> <span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="compute-pair-wise-distance" class="level3">
<h3 class="anchored" data-anchor-id="compute-pair-wise-distance">3.3.1 Compute pair-wise distance</h3>
<p>Next we will calculate the pairwise Euclidean distances between rows of the <code>clust_vars</code> data frame .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(clust_vars, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-cluster" class="level3">
<h3 class="anchored" data-anchor-id="compute-cluster">3.3.2 Compute Cluster</h3>
<section id="selecting-clustering-method" class="level4">
<h4 class="anchored" data-anchor-id="selecting-clustering-method">3.3.2.1 Selecting Clustering Method</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(clust_vars, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.6959711 0.6195356 0.7573835 0.8722831 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ward.D method
</div>
</div>
<div class="callout-body-container callout-body">
<p>A higher average silhouette width indicates better-defined clusters. In this case, Ward’s method seems to produce the best clustering solution based on the average silhouette width.</p>
</div>
</div>
</section>
<section id="perform-clustering" class="level4">
<h4 class="anchored" data-anchor-id="perform-clustering">3.3.2.2 Perform Clustering</h4>
<p>We will perform a standard Hierarchical clustering with the <code>ward.D</code> method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>clust_method <span class="ot">&lt;-</span> <span class="st">'ward.D'</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> clust_method)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-cluster" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-cluster">3.3.2.3 Visualizing Cluster</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Dendogram</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Heatmap</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Cluster</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> n_clust, </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(<span class="fu">data.matrix</span>(clust_vars)),</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> clust_method,</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> OrRd,</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> n_clust,</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">50</span>,<span class="dv">50</span>,<span class="cn">NA</span>),</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of West Malaysia by Crime indicators"</span>,</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Crime and Demographic Indicators"</span>,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Districts"</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1f592a5d53c7d37b0d99" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1f592a5d53c7d37b0d99">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87],"z":[[0.88566870379938956,0.24878701879572254,1,1,0.89299387788644891,0.14633175021341618,0.47143027570835805,0.10912343470483005,0.062857142857142861,0.18315018315018336,1,0.54773242010458922],[0.69579311396922972,0.22864258806568732,0.29374096451994269,0.85122989064927868,0.39281226443481487,0.27173044572262639,0.78907727985407028,0.1967799642218247,0.18628571428571428,0.63003663003663002,0.64893617021276606,0.28656233768303585],[0.44700787420326643,0.27088103461342683,0.1524430680250107,0.93297010491514876,0.20099829400748176,0.34666570696106314,0.66462166520280852,0.43291592128801437,0.32114285714285706,0.95238095238095277,0.39361702127659581,0.27493178377995714],[0.73354731102044102,0.29241184126233494,0.11638232444906192,0.49738787816558,0.73115965141043593,1,1,0.019677996422182469,0.25142857142857133,0.73992673992673996,0.49094478216818649,0.46621156136973946],[0.71881526232525406,0.33012232729656255,0.16758791788726565,0.94882300796034347,0.60606044108939561,0.90651993209477832,0.92078352211033243,0.041144901610017888,0.3085714285714285,0.97435897435897478,0.69148936170212771,0.85317867907676714],[0.86829141098936991,0.31389186504055194,0.20380723906671794,0.94399431885772145,0.43768107479246016,0.649016584505829,0.71687207474470283,0.075134168157423964,0.36799999999999999,0.7912087912087914,0.30851063829787234,0.71755696886016473],[0.58555699960094354,0.19538074232057093,0.11813133050908761,0.77041317327228276,0.36678351169236084,0.2806481960543179,0.31810754857589185,0.13237924865831843,0.30971428571428566,0.89377289377289404,0.047872340425531894,0.65618946563205138],[1,0.23913441169099728,0.10292004588984645,0.36272981436909196,0.43637746190237908,0.39964147533232286,0.40128204251081601,0.012522361359570661,0.24914285714285711,0.76190476190476197,0.35106382978723405,0.59547777104033461],[0.76532330661229175,0.24169609582701909,0.040454578553206701,0.76907604766610116,0.49951964516531649,0.270916354674063,0.19645115927457163,0.15563506261180679,0.25714285714285712,0.7142857142857143,0.62765957446808518,0.50894716078884572],[0.67304108478307556,0.29224403324100034,0.14232777220149995,0.61012816993188723,0.36298855878622049,0.3761535443154676,0.32462390759022886,0.10196779964221825,0.16114285714285712,0.77655677655677668,0.46808510638297873,0.395370117379099],[0.59245913667574446,0.20706723584281927,0.18122663991162927,0.6124422199290418,0.32387677582766206,0.26471112652898005,0.5185071227863518,0.13953488372093026,0.40571428571428564,0.66300366300366298,0.51595744680851063,0.43424061342955927],[0.50827659440043982,0.28208831013548402,0.11165704817297789,0.40366483704638306,0.24248035111704186,0.36559575234894182,0.72075953384784042,0.11627906976744186,0.25028571428571428,0.80219780219780235,0.53723404255319152,0.81523596492860806],[0.4701362520123914,0.33188270596540775,0.12323469330819319,0.56662177152328352,0.4329069540610736,0.54933242279252203,0.61952415836843289,0.039355992844364938,0.31999999999999995,1,0.47340425531914904,1],[0.53766398272298555,0.40896328731034054,0.090078137186146545,0.57509624892694,0.25310788154887798,0.58084127571078936,0.42651180099838937,0.060822898032200368,0.40685714285714286,0.72161172161172171,0.57446808510638314,0.99847406588198928],[0.8266098785513798,0.29482834730647706,0.2672466952887888,0.69450640121234331,0.27085362241568173,0.30470549293430949,0.18974813375583122,0.084078711985688739,0.36799999999999999,0.56776556776556808,0.53191489361702138,0.95683286840586879],[0.36121442498314327,0.31970167384432685,0.5012724888932385,0.48699634905495409,0.36263448389888064,0.34038066392015093,0.28647082172140503,0.0483005366726297,0.56228571428571428,0.3956043956043957,0.29255319148936176,0.97027962876114837],[0.56830070312500536,0.45249442797989187,0.20149542111913019,0.20958380032319252,0.14481986684279247,0.33552252764493756,0.35717102914119503,0.039355992844364938,0.31771428571428567,0.3113553113553113,0.3563829787234043,0.89639064021952564],[0.48041525320577755,0.3822885998842715,0.23239306285937883,0.31252191929874368,0.49542861788889259,0.25752205150344004,0.2255825272516617,0.0035778175313059025,0.11428571428571427,0.35897435897435903,0.64893617021276606,0.91350218880394374],[0.54381629708579615,0.13643936848180949,0.33068524748234007,0.4989015850429146,0.38820998482882108,0.092393819197013907,0.11754560417028599,0.13237924865831843,0.26628571428571424,0.52014652014652041,0.49094478216818649,0.46621156136973946],[0.51401739854979833,0,0.33384612036087352,0.25664073741320759,0.5089024428962563,0.18566356487841432,0.067718633611748943,0.14669051878354203,0.43999999999999995,0.65201465201465203,0.52127659574468088,0.53088832933803076],[0.57595555089993222,0,0.24507256971065702,0.60544494206924537,0.68603858066213264,0.081049047367033153,0.088707322684184256,0.26118067978533099,0.60799999999999998,0.67399267399267404,0.66489361702127658,0.50406002833641539],[0.62488500794795232,0.072862927073381545,0.32904433435430525,0.79727173386613215,0.48047767511272393,0.2038560184479391,0.20143694664226958,0.16994633273703041,1,0.67399267399267404,0.42553191489361708,0.78260918354728481],[0.50302214661232469,0.30169434601524003,0.17245181371093735,0.4077777878069937,0.22811474905037821,0.18198504070798466,0.29023951176506513,0.1037567084078712,0.62057142857142844,0.7985347985347987,0.61702127659574479,0.73005803173851502],[0.46755757733415848,0.24069018272878873,0.10154386719251823,0.14977651258920269,0.10837456356192555,0.15464703193966595,0.30751871549835474,0.20930232558139533,0.58285714285714274,0.58241758241758268,0.60106382978723405,0.73142353624895173],[0.35429313278127872,0.31561720711718233,0.1079041946243951,0.2698775585553202,0.17317178419607004,0.14096393564398682,0.19845539475740684,0.17531305903398928,0.48571428571428565,0.46520146520146538,0.47340425531914904,0.69445638828782041],[0.31609393720559181,0.38500199470204677,0.12745424622822593,0.2866746433763892,0.14473961267830648,0.11279306126497468,0.40820621843971899,0.18783542039355994,0.41714285714285709,0.64468864468864462,0.46276595744680854,0.69121604979256945],[0.41567133573939935,0.16330288564272613,0.1693523685467922,0.51093652149068258,0.21969567525202657,0.10748348841162515,0.44603922330048956,0.56887298747763859,0.48342857142857132,0.5787545787545787,0.34574468085106386,0.58933812154699972],[0.58773352663887846,0.18453277670841206,0.14996970896151129,0.47997292231507799,0.20905017751886831,0.2907260545089006,0.35826135891885397,0.37209302325581395,0.23428571428571424,0.58974358974359009,0.31382978723404265,0.55254427563332786],[0.553678508322621,0.10142868877419317,0.096691105621969267,0.40166176158876937,0.15525833012842233,0.092447947260380178,0.096736020069355499,0.14311270125223613,0.36685714285714283,0.69597069597069605,0,0.4611040662046364],[0.45894730448473348,0.1306880046872467,0.13335777793266157,0.24062845554147927,0.30101412724450932,0.15765943192926959,0.34947867747607897,0.033989266547406083,0.21142857142857138,0.69597069597069605,0.20212765957446807,0.69528926894533227],[0.48046451063201734,0.093868718799829567,0.10269886987989449,0.2367336473466706,0.086912913237058229,0.089094773641796091,0.1822711107111859,0.14490161001788909,0.36114285714285704,0.6263736263736267,0.31382978723404265,0.733624026047483],[0.23309747749797094,0.099282851411770956,0.061182634857519923,0.16955546416478037,0.028887904269581689,0.072664687172069739,0.09004621157402766,0.17352415026833631,0.42285714285714276,0.80219780219780235,0.21276595744680854,0.62606229096158805],[0.10217034326930531,0.047583045668043687,0.017786324403027229,0.2033326760221234,0.054146650582650425,0.078214185921277851,0.14161029773694628,0.18067978533094814,0.49828571428571422,0.60439560439560469,0.29255319148936176,0.46385256470833475],[0.1645844987869865,0.14158903695083561,0.085221247304772305,0.19791549193737581,0.045337346827504697,0.106857386316816,0.12255324822174556,0.13416815742397137,0.30971428571428566,0.38461538461538469,0.15957446808510642,0.72597827932822312],[0.28045886193791303,0.26747821517456749,0.04304362900451509,0.24979033779332274,0.058627028143092848,0.29420734761499578,0.33574562376892086,0.010733452593917713,0.18514285714285711,0.4981684981684984,0.59042553191489366,0.93780810589254171],[0.19810010009152035,0.33205564477520799,0.043091340234071837,0.18218208537630162,0.12662158353151201,0.23062383875931092,0.25333906185104726,0.055456171735241505,0.18514285714285711,0.48717948717948739,0.43617021276595747,0.51622707335190043],[0,0,0.11227864789152543,0,0,0.034726965422779935,0.18068542083078595,0.19856887298747763,0.19428571428571426,0.45787545787545803,0.37765957446808512,0.30632135420110468],[0.066919388605629307,0.21263268363921423,0.11360955289167886,0.20122604770903363,0.14405147375579103,0.05612108742756472,0.41679935063406803,0.32558139534883723,0.40228571428571425,0.4835164835164833,0.37234042553191493,0.27092149956241518],[0.1180597941699079,0.32737122007916508,0.15391082275630169,0.18000015114351639,0.11522111586821313,0.042621417874962313,0.027358628746701669,0.51341681574239717,0.41599999999999998,0.82417582417582436,0.46276595744680854,0.51317778438954531],[0.36096965609682069,0.34869901737573383,0.025351131218228278,0.27900984542195956,0.10336862344245039,0.12832883863944272,0.16524657947442006,0.35957066189624332,0.32628571428571423,0.83882783882783907,0.40957446808510639,0.58309569394042715],[0.38804360511004676,0.16927591083642438,0.24209803965696131,0.15339659017411586,0.25945206312052255,0.14252803145885518,0.097069030136058138,0.21466905187835422,0.53714285714285703,0.64835164835164871,0.53191489361702138,0.3858309624837794],[0.14707641603461233,0,0.15115310437347296,0.12687304546199699,0.020439028069196365,0.10299729177908765,0.26748380611904049,0.18604651162790695,0.4891428571428571,0.68498168498168499,0.5585106382978724,0.48929595226758893],[0.045382485271861429,0.066697602474864656,0.049914688986473429,0.25846803612396502,0.29896063060590428,0.066965166823571051,0.17395507196002177,0,0.25371428571428567,0.73626373626373631,0.49094478216818649,0.46621156136973946],[0.20479178558115266,0.10758879654892013,0.16661273162546053,0.62207823440161081,0.30301527637140141,0.072808520828467213,0.11199999367179615,0.14669051878354203,0.11542857142857138,0.71794871794871806,0.47872340425531923,0.50528296694583197],[0.15005360115295621,0.0493587570497101,0.1800591022548011,0.58490939300619171,0.31030086068451213,0.036189411477978745,0.11726264252387537,0.12164579606440072,0.082285714285714268,0.44322344322344337,0.54255319148936176,0.10105325057126981],[0.31856694990549311,0.060883407621771239,0.15469333564725737,0.4427405740489555,0.33918148001914789,0.083717140854851393,0.13554912434932628,0.14847942754919502,0.10628571428571426,0.2399267399267396,0.57446808510638303,0.16812880166617419],[0.2311858610152315,0.13060451028550901,0.21670971905609376,0.41015362940866879,0.22636001125519611,0.091371740602565879,0.06561860442209963,0.29874776386404295,0.25714285714285712,0.39194139194139199,0.48936170212765961,0.094826196949597499],[0.5247175261159045,0.32750752284640949,0.12192309679377641,0.4349176842441807,0.45733169146163627,0.080377744056759556,0.073802515670480212,0.32558139534883729,0.39542857142857141,0.38095238095238099,0.55319148936170226,0.032531745455838812],[0.57106842045633766,0,0.3208278236493276,0.8372682407692571,0.44815476436490959,0.076115571870284268,0.32077662938126972,0.39892665474060818,0.22285714285714281,0.49084249084249104,0.59042553191489366,0.19350634959887922],[0.37503872651356923,0.078904140440436449,0.30371017383765203,0.41435505213809909,0.36692317550391201,0.22186657734760926,0.45666300844751678,0.26654740608228977,0.23657142857142852,0.48717948717948739,0.65957446808510645,0.39673082553685823],[0.44313103368961682,0.19771954319818658,0.26572527178809668,0.49236806066387157,0.2723325127731076,0.16553458066021401,0.39416263540828073,0.25044722719141327,0.1885714285714285,0.3113553113553113,0.53723404255319152,0.48760847138888275],[0.44037486224159611,0.25639715695563786,0.18838730306226706,0.40254352164971491,0.25035592024029141,0.15153715749107535,0.34066701572468083,0.13595706618962433,0.11771428571428569,0.5787545787545787,0.41489361702127658,0.32654871054777163],[0.35374983215645284,0.12740054577565871,0.18292123067267069,0.55868978854765039,0.28216192978404797,0.17082338225153185,0.23129246158118003,0.096601073345259386,0.076571428571428554,0.39194139194139199,0.32446808510638303,0.66096294355490515],[0.20891417038956522,0.0687543567362041,0.29550307184878222,0.43195968270839646,0.28393392297843434,0.056012459279522503,0.23555789028578972,0.2629695885509839,0.21942857142857139,0.26739926739926734,0.27659574468085107,0.5060869166442642],[0.21121102145014478,0.19195980118221859,0.31651766795478525,0.57400155807509279,0.20365529805784258,0.03793602601568432,0.10377461740736472,0.31663685152057247,0.26285714285714279,0.33699633699633702,0.37234042553191493,0.49575719619256481],[0.26433853656191658,0.32439755749351512,0.41646173770989114,0.39617064868516244,0.34291674133148564,0.065386329455657546,0.087072610481563006,0.32200357781753131,0.27428571428571424,0.18315018315018297,0.5478723404255319,0.44772183629407081],[0.15854430541383488,0.17575719571079199,0.11745970034367056,0.32342837252375994,0.15412267441101113,0.10635124972070883,0.036422550257803929,0.18962432915921287,0.29485714285714282,0.31868131868131866,0.5106382978723405,0.64630908192500613],[0.14321266681390907,0,0.20142958934791388,0.25941754194503475,0.20171921783552729,0.05422054813705908,0.15732588507473846,0.24150268336314848,0.18057142857142855,0.27838827838827873,0.67021276595744694,0.38601094450203638],[0.23939734618799094,0.080782810450923032,0.099836646590041073,0.1363612493643345,0.24747305793566882,0.010623237225070066,0,0.25939177101967803,0.17942857142857138,0.16117216117216138,0.27659574468085107,0.2118714627868174],[0.58408252067706967,0.081203116436619829,0,0.13445891581425914,0.12604954941131291,0.026290590148500253,0.090878080950788448,0.11627906976744186,0.042285714285714281,0.15384615384615402,0.44680851063829796,0.43900610772871046],[0.60325406849318286,0.23799933900433379,0.2818757185404353,0.27393351797442606,0.22041869332565708,0.044548631726190335,0.098614179465805529,0.19499105545617174,0.19657142857142854,0.065934065934066019,0.50000000000000011,0.14675167259838842],[0.61751475064449568,0.15529606399465676,0.46048719946029076,0.37586731963749315,0.16753091013728064,0.055650261855916372,0.14694499829139993,0.32558139534883723,0.22742857142857137,0.35164835164835168,0.36702127659574474,0.36521728570951689],[0.80168953346099314,0.35507749460799687,0.32202650158901247,0.29938623391179142,0.16465410749353812,0.087339904034984386,0.17512184061165198,0.31305903398926654,0.17485714285714285,0.37362637362637369,0.46808510638297873,0.51718980266819337],[0.61284330709239809,0.36799995062427815,0.26485889051370853,0.2144539713338309,0.23675040501841979,0.11495713794327614,0.18485038640638146,0.21824686940966009,0.2011428571428571,0.31501831501831501,0.42553191489361708,0.40618772045192264],[0.61164672402699272,0.20444623779168403,0.13397591208156528,0.28941946213376035,0.19469861418258191,0.2886727382084579,0.31673598198977249,0.26207513416815742,0.27028571428571424,0.47252747252747268,0.87234042553191493,0.43058637002209599],[0.35498225610438705,0.32595482471109738,0.11707953740763224,0.13845915076802973,0.066865990000194164,0.15265768989627235,0.23549011624795546,0.25402504472271914,0.29599999999999993,0.52014652014651996,0.81382978723404265,0.19828928089139874],[0.27805308805708817,0.39596358713220775,0.010067487435922931,0.27692189388416411,0.18710964744034717,0.16254295819077461,0.19007195207142236,0.20035778175313057,0.29371428571428565,0.50183150183150205,0.59042553191489366,0.29788424076738373],[0.29713366831115995,0.44078947096821225,0.063835795962541589,0.47508582958946433,0.29047269173677326,0.11986754632078633,0.15703431490070538,0.2075134168157424,0.44342857142857139,0.75091575091575102,0.57446808510638303,0.4102811346496017],[0.50498654301834633,0.37626437169299959,0.027121175042724786,0.45514561996933017,0.16684295896382159,0.28439903050669774,0.27871870316050618,0.14669051878354203,0.20571428571428568,0.84249084249084272,0.67021276595744694,0.47172241276208238],[0.51673458720172794,0.47213350952206734,0.060565745185199582,0.24953523186023974,0.14514094560333246,0.15835461836277223,0.31337242526895842,0.18246869409660108,0.21257142857142852,0.76556776556776573,0.79255319148936187,0.37446468584470438],[0.22325489673377286,0.41089592958170174,0.21932344470064474,0.16526857220801361,0.25270827173490534,0.04683529471632316,0.10747565840715799,0.36851520572450808,0.34514285714285708,0.86446886446886473,0.7978723404255319,0.2846854575732739],[0.41763237106522177,0.26537973140575016,0.1264135985825986,0.21043356373318547,0.08921389136751437,0.17351049572334989,0.098760617459853303,0.41323792486583188,0.34628571428571425,0.91575091575091605,0.80319148936170226,0.21022057338797173],[0.24190731988302899,0.14006174283136627,0.074126099281663319,0.57398923047156902,0.1757708586911271,0.080942277629903525,0.15018406084125493,0.33273703041144903,0.2525714285714285,0.87179487179487203,0.86702127659574468,0.10720230658584121],[0.20074895887056207,0.097373890857683748,0.08498241441590336,0.50275766005772671,0.18918769420508585,0.14694797675997015,0.52480187231236619,0.34168157423971379,0.15657142857142853,0.86813186813186838,0.80319148936170226,0.22290158698107279],[0.74557749524143502,0.40006628974232294,0.37721915762469072,0.58274047320186084,0.18551271613795503,0.16040717440238186,0.4122725487166719,0.5026833631484795,0.26399999999999996,0.86446886446886473,0.39893617021276601,0.15876823339175153],[0.99926437467876328,0.17244487737443384,0.15751280934918768,0.57472704615871784,0.45463101116239635,0.16275719966476773,0.16278408107915848,0.39892665474060823,0.38285714285714278,0.78388278388278398,0.70744680851063835,0.39034729074830171],[0.93300547845739901,0.12279495656269339,0.22367655409384182,0.43905289842739859,0.22294342970548536,0.13902387154606555,0.15433225059750857,0.24508050089445438,0.39885714285714285,0.53846153846153866,0.5585106382978724,0.3155144703839009],[0.6916075802180961,0.14882936089432608,0.19808164141258736,0.33754920031351593,0.12018447481134759,0.060086608297612296,0.2389853824972758,0.44186046511627908,0.22628571428571426,0.75824175824175832,0.48936170212765961,0.045291256441124327],[0.55119592875411061,0.10084099414275502,0.092915033167957017,0.29255645811232206,0.10863829423674318,0.091546704998396081,0.049755751918064889,0.3864042933810376,0.21828571428571422,0.78754578754578775,0.69680851063829796,0],[0.22697728996542493,0.042480236742292676,0.12748343096664841,0.47539605618889363,0.14912473857818614,0.14792006967938195,0.16968642333165923,0.45617173524150267,0.21257142857142852,0.78021978021978033,0.41489361702127658,0.068205032435288582],[0.33678942603108591,0.10349627970237618,0.28358013585598096,0.24827753740086392,0.1388067780976793,0.11279016129841833,0.18720017814075782,0.5259391771019678,0.25485714285714284,0.7142857142857143,0.32978723404255322,0.16791513765414567],[0.20458936871734495,0.14035286851725115,0.13976434335349769,0.26631341920811574,0.044988746739197782,0,0.010042919933905239,0.52415026833631484,0.29942857142857138,0.54945054945054927,0.35106382978723405,0.11295684741421189],[0.47076683499317762,0.074320185614849196,0.3123396443166967,0.21223933437329262,0.1446755750506841,0.0079929915585737511,0.047267704945715645,0.79248658318425758,0.53257142857142858,0.92673992673992711,0.23936170212765961,0.31307572703037773],[0.50392935321812093,0.29634093147828272,0.2394649930870632,0.26656705942724107,0.1294046798075183,0.15212644043549534,0.25431671464799771,0.43470483005366722,0.8342857142857143,0.68864468864468864,0.39361702127659581,0.25868437988277226],[0.43161825920257862,0.62108116642367672,0.16789773282047937,0.23971285328630423,0.17979954592470651,0.069144620021681508,0.062430726408066878,1,0.46057142857142847,0.49267399267399264,0.60106382978723405,0.048740371099660847],[0.61352117887155921,0.60263395327412828,0.25360711090103838,0.46413037030083981,1,0.21800857434777737,0.24402406757825459,0.10017889087656529,0.029714285714285707,0,0.34574468085106386,0.52246501924270627],[0.73763885508941252,1,0.14889389931191316,0.10604486912098181,0.068592790991218178,0.037518801695380188,0.1718913961088985,0.032200357781753126,0,0.062271062271062348,0.28723404255319157,0.88019350862064416]],"text":[["row: Kedah-Langkawi<br>column: causing_injury<br>value: 0.885669","row: Kedah-Langkawi<br>column: murder<br>value: 0.248787","row: Kedah-Langkawi<br>column: rape<br>value: 1.000000","row: Kedah-Langkawi<br>column: break_in<br>value: 1.000000","row: Kedah-Langkawi<br>column: theft_other<br>value: 0.892994","row: Kedah-Langkawi<br>column: robbery<br>value: 0.146332","row: Kedah-Langkawi<br>column: vehicle_theft<br>value: 0.471430","row: Kedah-Langkawi<br>column: poverty_absolute<br>value: 0.109123","row: Kedah-Langkawi<br>column: poverty_relative<br>value: 0.062857","row: Kedah-Langkawi<br>column: gini<br>value: 0.183150","row: Kedah-Langkawi<br>column: unemployment_rate<br>value: 1.000000","row: Kedah-Langkawi<br>column: employment_ratio<br>value: 0.547732"],["row: Kedah-Kota Setar<br>column: causing_injury<br>value: 0.695793","row: Kedah-Kota Setar<br>column: murder<br>value: 0.228643","row: Kedah-Kota Setar<br>column: rape<br>value: 0.293741","row: Kedah-Kota Setar<br>column: break_in<br>value: 0.851230","row: Kedah-Kota Setar<br>column: theft_other<br>value: 0.392812","row: Kedah-Kota Setar<br>column: robbery<br>value: 0.271730","row: Kedah-Kota Setar<br>column: vehicle_theft<br>value: 0.789077","row: Kedah-Kota Setar<br>column: poverty_absolute<br>value: 0.196780","row: Kedah-Kota Setar<br>column: poverty_relative<br>value: 0.186286","row: Kedah-Kota Setar<br>column: gini<br>value: 0.630037","row: Kedah-Kota Setar<br>column: unemployment_rate<br>value: 0.648936","row: Kedah-Kota Setar<br>column: employment_ratio<br>value: 0.286562"],["row: Kedah-Kuala Muda<br>column: causing_injury<br>value: 0.447008","row: Kedah-Kuala Muda<br>column: murder<br>value: 0.270881","row: Kedah-Kuala Muda<br>column: rape<br>value: 0.152443","row: Kedah-Kuala Muda<br>column: break_in<br>value: 0.932970","row: Kedah-Kuala Muda<br>column: theft_other<br>value: 0.200998","row: Kedah-Kuala Muda<br>column: robbery<br>value: 0.346666","row: Kedah-Kuala Muda<br>column: vehicle_theft<br>value: 0.664622","row: Kedah-Kuala Muda<br>column: poverty_absolute<br>value: 0.432916","row: Kedah-Kuala Muda<br>column: poverty_relative<br>value: 0.321143","row: Kedah-Kuala Muda<br>column: gini<br>value: 0.952381","row: Kedah-Kuala Muda<br>column: unemployment_rate<br>value: 0.393617","row: Kedah-Kuala Muda<br>column: employment_ratio<br>value: 0.274932"],["row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: causing_injury<br>value: 0.733547","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: murder<br>value: 0.292412","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: rape<br>value: 0.116382","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: break_in<br>value: 0.497388","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: theft_other<br>value: 0.731160","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: robbery<br>value: 1.000000","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: vehicle_theft<br>value: 1.000000","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: poverty_absolute<br>value: 0.019678","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: poverty_relative<br>value: 0.251429","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: gini<br>value: 0.739927","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: unemployment_rate<br>value: 0.490945","row: Kuala Lumpur-Wp. Kuala Lumpur<br>column: employment_ratio<br>value: 0.466212"],["row: Selangor-Gombak<br>column: causing_injury<br>value: 0.718815","row: Selangor-Gombak<br>column: murder<br>value: 0.330122","row: Selangor-Gombak<br>column: rape<br>value: 0.167588","row: Selangor-Gombak<br>column: break_in<br>value: 0.948823","row: Selangor-Gombak<br>column: theft_other<br>value: 0.606060","row: Selangor-Gombak<br>column: robbery<br>value: 0.906520","row: Selangor-Gombak<br>column: vehicle_theft<br>value: 0.920784","row: Selangor-Gombak<br>column: poverty_absolute<br>value: 0.041145","row: Selangor-Gombak<br>column: poverty_relative<br>value: 0.308571","row: Selangor-Gombak<br>column: gini<br>value: 0.974359","row: Selangor-Gombak<br>column: unemployment_rate<br>value: 0.691489","row: Selangor-Gombak<br>column: employment_ratio<br>value: 0.853179"],["row: Pulau Pinang-S.p. Tengah<br>column: causing_injury<br>value: 0.868291","row: Pulau Pinang-S.p. Tengah<br>column: murder<br>value: 0.313892","row: Pulau Pinang-S.p. Tengah<br>column: rape<br>value: 0.203807","row: Pulau Pinang-S.p. Tengah<br>column: break_in<br>value: 0.943994","row: Pulau Pinang-S.p. Tengah<br>column: theft_other<br>value: 0.437681","row: Pulau Pinang-S.p. Tengah<br>column: robbery<br>value: 0.649017","row: Pulau Pinang-S.p. Tengah<br>column: vehicle_theft<br>value: 0.716872","row: Pulau Pinang-S.p. Tengah<br>column: poverty_absolute<br>value: 0.075134","row: Pulau Pinang-S.p. Tengah<br>column: poverty_relative<br>value: 0.368000","row: Pulau Pinang-S.p. Tengah<br>column: gini<br>value: 0.791209","row: Pulau Pinang-S.p. Tengah<br>column: unemployment_rate<br>value: 0.308511","row: Pulau Pinang-S.p. Tengah<br>column: employment_ratio<br>value: 0.717557"],["row: Melaka-Melaka Tengah<br>column: causing_injury<br>value: 0.585557","row: Melaka-Melaka Tengah<br>column: murder<br>value: 0.195381","row: Melaka-Melaka Tengah<br>column: rape<br>value: 0.118131","row: Melaka-Melaka Tengah<br>column: break_in<br>value: 0.770413","row: Melaka-Melaka Tengah<br>column: theft_other<br>value: 0.366784","row: Melaka-Melaka Tengah<br>column: robbery<br>value: 0.280648","row: Melaka-Melaka Tengah<br>column: vehicle_theft<br>value: 0.318108","row: Melaka-Melaka Tengah<br>column: poverty_absolute<br>value: 0.132379","row: Melaka-Melaka Tengah<br>column: poverty_relative<br>value: 0.309714","row: Melaka-Melaka Tengah<br>column: gini<br>value: 0.893773","row: Melaka-Melaka Tengah<br>column: unemployment_rate<br>value: 0.047872","row: Melaka-Melaka Tengah<br>column: employment_ratio<br>value: 0.656189"],["row: Pulau Pinang-Timur Laut<br>column: causing_injury<br>value: 1.000000","row: Pulau Pinang-Timur Laut<br>column: murder<br>value: 0.239134","row: Pulau Pinang-Timur Laut<br>column: rape<br>value: 0.102920","row: Pulau Pinang-Timur Laut<br>column: break_in<br>value: 0.362730","row: Pulau Pinang-Timur Laut<br>column: theft_other<br>value: 0.436377","row: Pulau Pinang-Timur Laut<br>column: robbery<br>value: 0.399641","row: Pulau Pinang-Timur Laut<br>column: vehicle_theft<br>value: 0.401282","row: Pulau Pinang-Timur Laut<br>column: poverty_absolute<br>value: 0.012522","row: Pulau Pinang-Timur Laut<br>column: poverty_relative<br>value: 0.249143","row: Pulau Pinang-Timur Laut<br>column: gini<br>value: 0.761905","row: Pulau Pinang-Timur Laut<br>column: unemployment_rate<br>value: 0.351064","row: Pulau Pinang-Timur Laut<br>column: employment_ratio<br>value: 0.595478"],["row: Negeri Sembilan-Port Dickson<br>column: causing_injury<br>value: 0.765323","row: Negeri Sembilan-Port Dickson<br>column: murder<br>value: 0.241696","row: Negeri Sembilan-Port Dickson<br>column: rape<br>value: 0.040455","row: Negeri Sembilan-Port Dickson<br>column: break_in<br>value: 0.769076","row: Negeri Sembilan-Port Dickson<br>column: theft_other<br>value: 0.499520","row: Negeri Sembilan-Port Dickson<br>column: robbery<br>value: 0.270916","row: Negeri Sembilan-Port Dickson<br>column: vehicle_theft<br>value: 0.196451","row: Negeri Sembilan-Port Dickson<br>column: poverty_absolute<br>value: 0.155635","row: Negeri Sembilan-Port Dickson<br>column: poverty_relative<br>value: 0.257143","row: Negeri Sembilan-Port Dickson<br>column: gini<br>value: 0.714286","row: Negeri Sembilan-Port Dickson<br>column: unemployment_rate<br>value: 0.627660","row: Negeri Sembilan-Port Dickson<br>column: employment_ratio<br>value: 0.508947"],["row: Negeri Sembilan-Seremban<br>column: causing_injury<br>value: 0.673041","row: Negeri Sembilan-Seremban<br>column: murder<br>value: 0.292244","row: Negeri Sembilan-Seremban<br>column: rape<br>value: 0.142328","row: Negeri Sembilan-Seremban<br>column: break_in<br>value: 0.610128","row: Negeri Sembilan-Seremban<br>column: theft_other<br>value: 0.362989","row: Negeri Sembilan-Seremban<br>column: robbery<br>value: 0.376154","row: Negeri Sembilan-Seremban<br>column: vehicle_theft<br>value: 0.324624","row: Negeri Sembilan-Seremban<br>column: poverty_absolute<br>value: 0.101968","row: Negeri Sembilan-Seremban<br>column: poverty_relative<br>value: 0.161143","row: Negeri Sembilan-Seremban<br>column: gini<br>value: 0.776557","row: Negeri Sembilan-Seremban<br>column: unemployment_rate<br>value: 0.468085","row: Negeri Sembilan-Seremban<br>column: employment_ratio<br>value: 0.395370"],["row: Pulau Pinang-S.p. Utara<br>column: causing_injury<br>value: 0.592459","row: Pulau Pinang-S.p. Utara<br>column: murder<br>value: 0.207067","row: Pulau Pinang-S.p. Utara<br>column: rape<br>value: 0.181227","row: Pulau Pinang-S.p. Utara<br>column: break_in<br>value: 0.612442","row: Pulau Pinang-S.p. Utara<br>column: theft_other<br>value: 0.323877","row: Pulau Pinang-S.p. Utara<br>column: robbery<br>value: 0.264711","row: Pulau Pinang-S.p. Utara<br>column: vehicle_theft<br>value: 0.518507","row: Pulau Pinang-S.p. Utara<br>column: poverty_absolute<br>value: 0.139535","row: Pulau Pinang-S.p. Utara<br>column: poverty_relative<br>value: 0.405714","row: Pulau Pinang-S.p. Utara<br>column: gini<br>value: 0.663004","row: Pulau Pinang-S.p. Utara<br>column: unemployment_rate<br>value: 0.515957","row: Pulau Pinang-S.p. Utara<br>column: employment_ratio<br>value: 0.434241"],["row: Johor-Johor Bahru<br>column: causing_injury<br>value: 0.508277","row: Johor-Johor Bahru<br>column: murder<br>value: 0.282088","row: Johor-Johor Bahru<br>column: rape<br>value: 0.111657","row: Johor-Johor Bahru<br>column: break_in<br>value: 0.403665","row: Johor-Johor Bahru<br>column: theft_other<br>value: 0.242480","row: Johor-Johor Bahru<br>column: robbery<br>value: 0.365596","row: Johor-Johor Bahru<br>column: vehicle_theft<br>value: 0.720760","row: Johor-Johor Bahru<br>column: poverty_absolute<br>value: 0.116279","row: Johor-Johor Bahru<br>column: poverty_relative<br>value: 0.250286","row: Johor-Johor Bahru<br>column: gini<br>value: 0.802198","row: Johor-Johor Bahru<br>column: unemployment_rate<br>value: 0.537234","row: Johor-Johor Bahru<br>column: employment_ratio<br>value: 0.815236"],["row: Selangor-Petaling<br>column: causing_injury<br>value: 0.470136","row: Selangor-Petaling<br>column: murder<br>value: 0.331883","row: Selangor-Petaling<br>column: rape<br>value: 0.123235","row: Selangor-Petaling<br>column: break_in<br>value: 0.566622","row: Selangor-Petaling<br>column: theft_other<br>value: 0.432907","row: Selangor-Petaling<br>column: robbery<br>value: 0.549332","row: Selangor-Petaling<br>column: vehicle_theft<br>value: 0.619524","row: Selangor-Petaling<br>column: poverty_absolute<br>value: 0.039356","row: Selangor-Petaling<br>column: poverty_relative<br>value: 0.320000","row: Selangor-Petaling<br>column: gini<br>value: 1.000000","row: Selangor-Petaling<br>column: unemployment_rate<br>value: 0.473404","row: Selangor-Petaling<br>column: employment_ratio<br>value: 1.000000"],["row: Selangor-Klang<br>column: causing_injury<br>value: 0.537664","row: Selangor-Klang<br>column: murder<br>value: 0.408963","row: Selangor-Klang<br>column: rape<br>value: 0.090078","row: Selangor-Klang<br>column: break_in<br>value: 0.575096","row: Selangor-Klang<br>column: theft_other<br>value: 0.253108","row: Selangor-Klang<br>column: robbery<br>value: 0.580841","row: Selangor-Klang<br>column: vehicle_theft<br>value: 0.426512","row: Selangor-Klang<br>column: poverty_absolute<br>value: 0.060823","row: Selangor-Klang<br>column: poverty_relative<br>value: 0.406857","row: Selangor-Klang<br>column: gini<br>value: 0.721612","row: Selangor-Klang<br>column: unemployment_rate<br>value: 0.574468","row: Selangor-Klang<br>column: employment_ratio<br>value: 0.998474"],["row: Pulau Pinang-S.p.selatan<br>column: causing_injury<br>value: 0.826610","row: Pulau Pinang-S.p.selatan<br>column: murder<br>value: 0.294828","row: Pulau Pinang-S.p.selatan<br>column: rape<br>value: 0.267247","row: Pulau Pinang-S.p.selatan<br>column: break_in<br>value: 0.694506","row: Pulau Pinang-S.p.selatan<br>column: theft_other<br>value: 0.270854","row: Pulau Pinang-S.p.selatan<br>column: robbery<br>value: 0.304705","row: Pulau Pinang-S.p.selatan<br>column: vehicle_theft<br>value: 0.189748","row: Pulau Pinang-S.p.selatan<br>column: poverty_absolute<br>value: 0.084079","row: Pulau Pinang-S.p.selatan<br>column: poverty_relative<br>value: 0.368000","row: Pulau Pinang-S.p.selatan<br>column: gini<br>value: 0.567766","row: Pulau Pinang-S.p.selatan<br>column: unemployment_rate<br>value: 0.531915","row: Pulau Pinang-S.p.selatan<br>column: employment_ratio<br>value: 0.956833"],["row: Selangor-Ulu Selangor<br>column: causing_injury<br>value: 0.361214","row: Selangor-Ulu Selangor<br>column: murder<br>value: 0.319702","row: Selangor-Ulu Selangor<br>column: rape<br>value: 0.501272","row: Selangor-Ulu Selangor<br>column: break_in<br>value: 0.486996","row: Selangor-Ulu Selangor<br>column: theft_other<br>value: 0.362634","row: Selangor-Ulu Selangor<br>column: robbery<br>value: 0.340381","row: Selangor-Ulu Selangor<br>column: vehicle_theft<br>value: 0.286471","row: Selangor-Ulu Selangor<br>column: poverty_absolute<br>value: 0.048301","row: Selangor-Ulu Selangor<br>column: poverty_relative<br>value: 0.562286","row: Selangor-Ulu Selangor<br>column: gini<br>value: 0.395604","row: Selangor-Ulu Selangor<br>column: unemployment_rate<br>value: 0.292553","row: Selangor-Ulu Selangor<br>column: employment_ratio<br>value: 0.970280"],["row: Selangor-Kuala Langat<br>column: causing_injury<br>value: 0.568301","row: Selangor-Kuala Langat<br>column: murder<br>value: 0.452494","row: Selangor-Kuala Langat<br>column: rape<br>value: 0.201495","row: Selangor-Kuala Langat<br>column: break_in<br>value: 0.209584","row: Selangor-Kuala Langat<br>column: theft_other<br>value: 0.144820","row: Selangor-Kuala Langat<br>column: robbery<br>value: 0.335523","row: Selangor-Kuala Langat<br>column: vehicle_theft<br>value: 0.357171","row: Selangor-Kuala Langat<br>column: poverty_absolute<br>value: 0.039356","row: Selangor-Kuala Langat<br>column: poverty_relative<br>value: 0.317714","row: Selangor-Kuala Langat<br>column: gini<br>value: 0.311355","row: Selangor-Kuala Langat<br>column: unemployment_rate<br>value: 0.356383","row: Selangor-Kuala Langat<br>column: employment_ratio<br>value: 0.896391"],["row: Selangor-Sepang<br>column: causing_injury<br>value: 0.480415","row: Selangor-Sepang<br>column: murder<br>value: 0.382289","row: Selangor-Sepang<br>column: rape<br>value: 0.232393","row: Selangor-Sepang<br>column: break_in<br>value: 0.312522","row: Selangor-Sepang<br>column: theft_other<br>value: 0.495429","row: Selangor-Sepang<br>column: robbery<br>value: 0.257522","row: Selangor-Sepang<br>column: vehicle_theft<br>value: 0.225583","row: Selangor-Sepang<br>column: poverty_absolute<br>value: 0.003578","row: Selangor-Sepang<br>column: poverty_relative<br>value: 0.114286","row: Selangor-Sepang<br>column: gini<br>value: 0.358974","row: Selangor-Sepang<br>column: unemployment_rate<br>value: 0.648936","row: Selangor-Sepang<br>column: employment_ratio<br>value: 0.913502"],["row: Perlis-Perlis<br>column: causing_injury<br>value: 0.543816","row: Perlis-Perlis<br>column: murder<br>value: 0.136439","row: Perlis-Perlis<br>column: rape<br>value: 0.330685","row: Perlis-Perlis<br>column: break_in<br>value: 0.498902","row: Perlis-Perlis<br>column: theft_other<br>value: 0.388210","row: Perlis-Perlis<br>column: robbery<br>value: 0.092394","row: Perlis-Perlis<br>column: vehicle_theft<br>value: 0.117546","row: Perlis-Perlis<br>column: poverty_absolute<br>value: 0.132379","row: Perlis-Perlis<br>column: poverty_relative<br>value: 0.266286","row: Perlis-Perlis<br>column: gini<br>value: 0.520147","row: Perlis-Perlis<br>column: unemployment_rate<br>value: 0.490945","row: Perlis-Perlis<br>column: employment_ratio<br>value: 0.466212"],["row: Negeri Sembilan-Rembau<br>column: causing_injury<br>value: 0.514017","row: Negeri Sembilan-Rembau<br>column: murder<br>value: 0.000000","row: Negeri Sembilan-Rembau<br>column: rape<br>value: 0.333846","row: Negeri Sembilan-Rembau<br>column: break_in<br>value: 0.256641","row: Negeri Sembilan-Rembau<br>column: theft_other<br>value: 0.508902","row: Negeri Sembilan-Rembau<br>column: robbery<br>value: 0.185664","row: Negeri Sembilan-Rembau<br>column: vehicle_theft<br>value: 0.067719","row: Negeri Sembilan-Rembau<br>column: poverty_absolute<br>value: 0.146691","row: Negeri Sembilan-Rembau<br>column: poverty_relative<br>value: 0.440000","row: Negeri Sembilan-Rembau<br>column: gini<br>value: 0.652015","row: Negeri Sembilan-Rembau<br>column: unemployment_rate<br>value: 0.521277","row: Negeri Sembilan-Rembau<br>column: employment_ratio<br>value: 0.530888"],["row: Negeri Sembilan-Kuala Pilah<br>column: causing_injury<br>value: 0.575956","row: Negeri Sembilan-Kuala Pilah<br>column: murder<br>value: 0.000000","row: Negeri Sembilan-Kuala Pilah<br>column: rape<br>value: 0.245073","row: Negeri Sembilan-Kuala Pilah<br>column: break_in<br>value: 0.605445","row: Negeri Sembilan-Kuala Pilah<br>column: theft_other<br>value: 0.686039","row: Negeri Sembilan-Kuala Pilah<br>column: robbery<br>value: 0.081049","row: Negeri Sembilan-Kuala Pilah<br>column: vehicle_theft<br>value: 0.088707","row: Negeri Sembilan-Kuala Pilah<br>column: poverty_absolute<br>value: 0.261181","row: Negeri Sembilan-Kuala Pilah<br>column: poverty_relative<br>value: 0.608000","row: Negeri Sembilan-Kuala Pilah<br>column: gini<br>value: 0.673993","row: Negeri Sembilan-Kuala Pilah<br>column: unemployment_rate<br>value: 0.664894","row: Negeri Sembilan-Kuala Pilah<br>column: employment_ratio<br>value: 0.504060"],["row: Selangor-Sabak Bernam<br>column: causing_injury<br>value: 0.624885","row: Selangor-Sabak Bernam<br>column: murder<br>value: 0.072863","row: Selangor-Sabak Bernam<br>column: rape<br>value: 0.329044","row: Selangor-Sabak Bernam<br>column: break_in<br>value: 0.797272","row: Selangor-Sabak Bernam<br>column: theft_other<br>value: 0.480478","row: Selangor-Sabak Bernam<br>column: robbery<br>value: 0.203856","row: Selangor-Sabak Bernam<br>column: vehicle_theft<br>value: 0.201437","row: Selangor-Sabak Bernam<br>column: poverty_absolute<br>value: 0.169946","row: Selangor-Sabak Bernam<br>column: poverty_relative<br>value: 1.000000","row: Selangor-Sabak Bernam<br>column: gini<br>value: 0.673993","row: Selangor-Sabak Bernam<br>column: unemployment_rate<br>value: 0.425532","row: Selangor-Sabak Bernam<br>column: employment_ratio<br>value: 0.782609"],["row: Selangor-Kuala Selangor<br>column: causing_injury<br>value: 0.503022","row: Selangor-Kuala Selangor<br>column: murder<br>value: 0.301694","row: Selangor-Kuala Selangor<br>column: rape<br>value: 0.172452","row: Selangor-Kuala Selangor<br>column: break_in<br>value: 0.407778","row: Selangor-Kuala Selangor<br>column: theft_other<br>value: 0.228115","row: Selangor-Kuala Selangor<br>column: robbery<br>value: 0.181985","row: Selangor-Kuala Selangor<br>column: vehicle_theft<br>value: 0.290240","row: Selangor-Kuala Selangor<br>column: poverty_absolute<br>value: 0.103757","row: Selangor-Kuala Selangor<br>column: poverty_relative<br>value: 0.620571","row: Selangor-Kuala Selangor<br>column: gini<br>value: 0.798535","row: Selangor-Kuala Selangor<br>column: unemployment_rate<br>value: 0.617021","row: Selangor-Kuala Selangor<br>column: employment_ratio<br>value: 0.730058"],["row: Johor-Kluang<br>column: causing_injury<br>value: 0.467558","row: Johor-Kluang<br>column: murder<br>value: 0.240690","row: Johor-Kluang<br>column: rape<br>value: 0.101544","row: Johor-Kluang<br>column: break_in<br>value: 0.149777","row: Johor-Kluang<br>column: theft_other<br>value: 0.108375","row: Johor-Kluang<br>column: robbery<br>value: 0.154647","row: Johor-Kluang<br>column: vehicle_theft<br>value: 0.307519","row: Johor-Kluang<br>column: poverty_absolute<br>value: 0.209302","row: Johor-Kluang<br>column: poverty_relative<br>value: 0.582857","row: Johor-Kluang<br>column: gini<br>value: 0.582418","row: Johor-Kluang<br>column: unemployment_rate<br>value: 0.601064","row: Johor-Kluang<br>column: employment_ratio<br>value: 0.731424"],["row: Johor-Segamat<br>column: causing_injury<br>value: 0.354293","row: Johor-Segamat<br>column: murder<br>value: 0.315617","row: Johor-Segamat<br>column: rape<br>value: 0.107904","row: Johor-Segamat<br>column: break_in<br>value: 0.269878","row: Johor-Segamat<br>column: theft_other<br>value: 0.173172","row: Johor-Segamat<br>column: robbery<br>value: 0.140964","row: Johor-Segamat<br>column: vehicle_theft<br>value: 0.198455","row: Johor-Segamat<br>column: poverty_absolute<br>value: 0.175313","row: Johor-Segamat<br>column: poverty_relative<br>value: 0.485714","row: Johor-Segamat<br>column: gini<br>value: 0.465201","row: Johor-Segamat<br>column: unemployment_rate<br>value: 0.473404","row: Johor-Segamat<br>column: employment_ratio<br>value: 0.694456"],["row: Johor-Kota Tinggi<br>column: causing_injury<br>value: 0.316094","row: Johor-Kota Tinggi<br>column: murder<br>value: 0.385002","row: Johor-Kota Tinggi<br>column: rape<br>value: 0.127454","row: Johor-Kota Tinggi<br>column: break_in<br>value: 0.286675","row: Johor-Kota Tinggi<br>column: theft_other<br>value: 0.144740","row: Johor-Kota Tinggi<br>column: robbery<br>value: 0.112793","row: Johor-Kota Tinggi<br>column: vehicle_theft<br>value: 0.408206","row: Johor-Kota Tinggi<br>column: poverty_absolute<br>value: 0.187835","row: Johor-Kota Tinggi<br>column: poverty_relative<br>value: 0.417143","row: Johor-Kota Tinggi<br>column: gini<br>value: 0.644689","row: Johor-Kota Tinggi<br>column: unemployment_rate<br>value: 0.462766","row: Johor-Kota Tinggi<br>column: employment_ratio<br>value: 0.691216"],["row: Kedah-Baling<br>column: causing_injury<br>value: 0.415671","row: Kedah-Baling<br>column: murder<br>value: 0.163303","row: Kedah-Baling<br>column: rape<br>value: 0.169352","row: Kedah-Baling<br>column: break_in<br>value: 0.510937","row: Kedah-Baling<br>column: theft_other<br>value: 0.219696","row: Kedah-Baling<br>column: robbery<br>value: 0.107483","row: Kedah-Baling<br>column: vehicle_theft<br>value: 0.446039","row: Kedah-Baling<br>column: poverty_absolute<br>value: 0.568873","row: Kedah-Baling<br>column: poverty_relative<br>value: 0.483429","row: Kedah-Baling<br>column: gini<br>value: 0.578755","row: Kedah-Baling<br>column: unemployment_rate<br>value: 0.345745","row: Kedah-Baling<br>column: employment_ratio<br>value: 0.589338"],["row: Kedah-Kulim<br>column: causing_injury<br>value: 0.587734","row: Kedah-Kulim<br>column: murder<br>value: 0.184533","row: Kedah-Kulim<br>column: rape<br>value: 0.149970","row: Kedah-Kulim<br>column: break_in<br>value: 0.479973","row: Kedah-Kulim<br>column: theft_other<br>value: 0.209050","row: Kedah-Kulim<br>column: robbery<br>value: 0.290726","row: Kedah-Kulim<br>column: vehicle_theft<br>value: 0.358261","row: Kedah-Kulim<br>column: poverty_absolute<br>value: 0.372093","row: Kedah-Kulim<br>column: poverty_relative<br>value: 0.234286","row: Kedah-Kulim<br>column: gini<br>value: 0.589744","row: Kedah-Kulim<br>column: unemployment_rate<br>value: 0.313830","row: Kedah-Kulim<br>column: employment_ratio<br>value: 0.552544"],["row: Melaka-Jasin<br>column: causing_injury<br>value: 0.553679","row: Melaka-Jasin<br>column: murder<br>value: 0.101429","row: Melaka-Jasin<br>column: rape<br>value: 0.096691","row: Melaka-Jasin<br>column: break_in<br>value: 0.401662","row: Melaka-Jasin<br>column: theft_other<br>value: 0.155258","row: Melaka-Jasin<br>column: robbery<br>value: 0.092448","row: Melaka-Jasin<br>column: vehicle_theft<br>value: 0.096736","row: Melaka-Jasin<br>column: poverty_absolute<br>value: 0.143113","row: Melaka-Jasin<br>column: poverty_relative<br>value: 0.366857","row: Melaka-Jasin<br>column: gini<br>value: 0.695971","row: Melaka-Jasin<br>column: unemployment_rate<br>value: 0.000000","row: Melaka-Jasin<br>column: employment_ratio<br>value: 0.461104"],["row: Pulau Pinang-Barat Daya<br>column: causing_injury<br>value: 0.458947","row: Pulau Pinang-Barat Daya<br>column: murder<br>value: 0.130688","row: Pulau Pinang-Barat Daya<br>column: rape<br>value: 0.133358","row: Pulau Pinang-Barat Daya<br>column: break_in<br>value: 0.240628","row: Pulau Pinang-Barat Daya<br>column: theft_other<br>value: 0.301014","row: Pulau Pinang-Barat Daya<br>column: robbery<br>value: 0.157659","row: Pulau Pinang-Barat Daya<br>column: vehicle_theft<br>value: 0.349479","row: Pulau Pinang-Barat Daya<br>column: poverty_absolute<br>value: 0.033989","row: Pulau Pinang-Barat Daya<br>column: poverty_relative<br>value: 0.211429","row: Pulau Pinang-Barat Daya<br>column: gini<br>value: 0.695971","row: Pulau Pinang-Barat Daya<br>column: unemployment_rate<br>value: 0.202128","row: Pulau Pinang-Barat Daya<br>column: employment_ratio<br>value: 0.695289"],["row: Melaka-Alor Gajah<br>column: causing_injury<br>value: 0.480465","row: Melaka-Alor Gajah<br>column: murder<br>value: 0.093869","row: Melaka-Alor Gajah<br>column: rape<br>value: 0.102699","row: Melaka-Alor Gajah<br>column: break_in<br>value: 0.236734","row: Melaka-Alor Gajah<br>column: theft_other<br>value: 0.086913","row: Melaka-Alor Gajah<br>column: robbery<br>value: 0.089095","row: Melaka-Alor Gajah<br>column: vehicle_theft<br>value: 0.182271","row: Melaka-Alor Gajah<br>column: poverty_absolute<br>value: 0.144902","row: Melaka-Alor Gajah<br>column: poverty_relative<br>value: 0.361143","row: Melaka-Alor Gajah<br>column: gini<br>value: 0.626374","row: Melaka-Alor Gajah<br>column: unemployment_rate<br>value: 0.313830","row: Melaka-Alor Gajah<br>column: employment_ratio<br>value: 0.733624"],["row: Johor-Muar<br>column: causing_injury<br>value: 0.233097","row: Johor-Muar<br>column: murder<br>value: 0.099283","row: Johor-Muar<br>column: rape<br>value: 0.061183","row: Johor-Muar<br>column: break_in<br>value: 0.169555","row: Johor-Muar<br>column: theft_other<br>value: 0.028888","row: Johor-Muar<br>column: robbery<br>value: 0.072665","row: Johor-Muar<br>column: vehicle_theft<br>value: 0.090046","row: Johor-Muar<br>column: poverty_absolute<br>value: 0.173524","row: Johor-Muar<br>column: poverty_relative<br>value: 0.422857","row: Johor-Muar<br>column: gini<br>value: 0.802198","row: Johor-Muar<br>column: unemployment_rate<br>value: 0.212766","row: Johor-Muar<br>column: employment_ratio<br>value: 0.626062"],["row: Johor-Ledang<br>column: causing_injury<br>value: 0.102170","row: Johor-Ledang<br>column: murder<br>value: 0.047583","row: Johor-Ledang<br>column: rape<br>value: 0.017786","row: Johor-Ledang<br>column: break_in<br>value: 0.203333","row: Johor-Ledang<br>column: theft_other<br>value: 0.054147","row: Johor-Ledang<br>column: robbery<br>value: 0.078214","row: Johor-Ledang<br>column: vehicle_theft<br>value: 0.141610","row: Johor-Ledang<br>column: poverty_absolute<br>value: 0.180680","row: Johor-Ledang<br>column: poverty_relative<br>value: 0.498286","row: Johor-Ledang<br>column: gini<br>value: 0.604396","row: Johor-Ledang<br>column: unemployment_rate<br>value: 0.292553","row: Johor-Ledang<br>column: employment_ratio<br>value: 0.463853"],["row: Johor-Batu Pahat<br>column: causing_injury<br>value: 0.164584","row: Johor-Batu Pahat<br>column: murder<br>value: 0.141589","row: Johor-Batu Pahat<br>column: rape<br>value: 0.085221","row: Johor-Batu Pahat<br>column: break_in<br>value: 0.197915","row: Johor-Batu Pahat<br>column: theft_other<br>value: 0.045337","row: Johor-Batu Pahat<br>column: robbery<br>value: 0.106857","row: Johor-Batu Pahat<br>column: vehicle_theft<br>value: 0.122553","row: Johor-Batu Pahat<br>column: poverty_absolute<br>value: 0.134168","row: Johor-Batu Pahat<br>column: poverty_relative<br>value: 0.309714","row: Johor-Batu Pahat<br>column: gini<br>value: 0.384615","row: Johor-Batu Pahat<br>column: unemployment_rate<br>value: 0.159574","row: Johor-Batu Pahat<br>column: employment_ratio<br>value: 0.725978"],["row: Selangor-Ulu Langat<br>column: causing_injury<br>value: 0.280459","row: Selangor-Ulu Langat<br>column: murder<br>value: 0.267478","row: Selangor-Ulu Langat<br>column: rape<br>value: 0.043044","row: Selangor-Ulu Langat<br>column: break_in<br>value: 0.249790","row: Selangor-Ulu Langat<br>column: theft_other<br>value: 0.058627","row: Selangor-Ulu Langat<br>column: robbery<br>value: 0.294207","row: Selangor-Ulu Langat<br>column: vehicle_theft<br>value: 0.335746","row: Selangor-Ulu Langat<br>column: poverty_absolute<br>value: 0.010733","row: Selangor-Ulu Langat<br>column: poverty_relative<br>value: 0.185143","row: Selangor-Ulu Langat<br>column: gini<br>value: 0.498168","row: Selangor-Ulu Langat<br>column: unemployment_rate<br>value: 0.590426","row: Selangor-Ulu Langat<br>column: employment_ratio<br>value: 0.937808"],["row: Johor-Kulaijaya<br>column: causing_injury<br>value: 0.198100","row: Johor-Kulaijaya<br>column: murder<br>value: 0.332056","row: Johor-Kulaijaya<br>column: rape<br>value: 0.043091","row: Johor-Kulaijaya<br>column: break_in<br>value: 0.182182","row: Johor-Kulaijaya<br>column: theft_other<br>value: 0.126622","row: Johor-Kulaijaya<br>column: robbery<br>value: 0.230624","row: Johor-Kulaijaya<br>column: vehicle_theft<br>value: 0.253339","row: Johor-Kulaijaya<br>column: poverty_absolute<br>value: 0.055456","row: Johor-Kulaijaya<br>column: poverty_relative<br>value: 0.185143","row: Johor-Kulaijaya<br>column: gini<br>value: 0.487179","row: Johor-Kulaijaya<br>column: unemployment_rate<br>value: 0.436170","row: Johor-Kulaijaya<br>column: employment_ratio<br>value: 0.516227"],["row: Kedah-Sik<br>column: causing_injury<br>value: 0.000000","row: Kedah-Sik<br>column: murder<br>value: 0.000000","row: Kedah-Sik<br>column: rape<br>value: 0.112279","row: Kedah-Sik<br>column: break_in<br>value: 0.000000","row: Kedah-Sik<br>column: theft_other<br>value: 0.000000","row: Kedah-Sik<br>column: robbery<br>value: 0.034727","row: Kedah-Sik<br>column: vehicle_theft<br>value: 0.180685","row: Kedah-Sik<br>column: poverty_absolute<br>value: 0.198569","row: Kedah-Sik<br>column: poverty_relative<br>value: 0.194286","row: Kedah-Sik<br>column: gini<br>value: 0.457875","row: Kedah-Sik<br>column: unemployment_rate<br>value: 0.377660","row: Kedah-Sik<br>column: employment_ratio<br>value: 0.306321"],["row: Kedah-Yan<br>column: causing_injury<br>value: 0.066919","row: Kedah-Yan<br>column: murder<br>value: 0.212633","row: Kedah-Yan<br>column: rape<br>value: 0.113610","row: Kedah-Yan<br>column: break_in<br>value: 0.201226","row: Kedah-Yan<br>column: theft_other<br>value: 0.144051","row: Kedah-Yan<br>column: robbery<br>value: 0.056121","row: Kedah-Yan<br>column: vehicle_theft<br>value: 0.416799","row: Kedah-Yan<br>column: poverty_absolute<br>value: 0.325581","row: Kedah-Yan<br>column: poverty_relative<br>value: 0.402286","row: Kedah-Yan<br>column: gini<br>value: 0.483516","row: Kedah-Yan<br>column: unemployment_rate<br>value: 0.372340","row: Kedah-Yan<br>column: employment_ratio<br>value: 0.270921"],["row: Perak-Ulu Perak<br>column: causing_injury<br>value: 0.118060","row: Perak-Ulu Perak<br>column: murder<br>value: 0.327371","row: Perak-Ulu Perak<br>column: rape<br>value: 0.153911","row: Perak-Ulu Perak<br>column: break_in<br>value: 0.180000","row: Perak-Ulu Perak<br>column: theft_other<br>value: 0.115221","row: Perak-Ulu Perak<br>column: robbery<br>value: 0.042621","row: Perak-Ulu Perak<br>column: vehicle_theft<br>value: 0.027359","row: Perak-Ulu Perak<br>column: poverty_absolute<br>value: 0.513417","row: Perak-Ulu Perak<br>column: poverty_relative<br>value: 0.416000","row: Perak-Ulu Perak<br>column: gini<br>value: 0.824176","row: Perak-Ulu Perak<br>column: unemployment_rate<br>value: 0.462766","row: Perak-Ulu Perak<br>column: employment_ratio<br>value: 0.513178"],["row: Perak-Batang Padang<br>column: causing_injury<br>value: 0.360970","row: Perak-Batang Padang<br>column: murder<br>value: 0.348699","row: Perak-Batang Padang<br>column: rape<br>value: 0.025351","row: Perak-Batang Padang<br>column: break_in<br>value: 0.279010","row: Perak-Batang Padang<br>column: theft_other<br>value: 0.103369","row: Perak-Batang Padang<br>column: robbery<br>value: 0.128329","row: Perak-Batang Padang<br>column: vehicle_theft<br>value: 0.165247","row: Perak-Batang Padang<br>column: poverty_absolute<br>value: 0.359571","row: Perak-Batang Padang<br>column: poverty_relative<br>value: 0.326286","row: Perak-Batang Padang<br>column: gini<br>value: 0.838828","row: Perak-Batang Padang<br>column: unemployment_rate<br>value: 0.409574","row: Perak-Batang Padang<br>column: employment_ratio<br>value: 0.583096"],["row: Negeri Sembilan-Jelebu<br>column: causing_injury<br>value: 0.388044","row: Negeri Sembilan-Jelebu<br>column: murder<br>value: 0.169276","row: Negeri Sembilan-Jelebu<br>column: rape<br>value: 0.242098","row: Negeri Sembilan-Jelebu<br>column: break_in<br>value: 0.153397","row: Negeri Sembilan-Jelebu<br>column: theft_other<br>value: 0.259452","row: Negeri Sembilan-Jelebu<br>column: robbery<br>value: 0.142528","row: Negeri Sembilan-Jelebu<br>column: vehicle_theft<br>value: 0.097069","row: Negeri Sembilan-Jelebu<br>column: poverty_absolute<br>value: 0.214669","row: Negeri Sembilan-Jelebu<br>column: poverty_relative<br>value: 0.537143","row: Negeri Sembilan-Jelebu<br>column: gini<br>value: 0.648352","row: Negeri Sembilan-Jelebu<br>column: unemployment_rate<br>value: 0.531915","row: Negeri Sembilan-Jelebu<br>column: employment_ratio<br>value: 0.385831"],["row: Johor-Pontian<br>column: causing_injury<br>value: 0.147076","row: Johor-Pontian<br>column: murder<br>value: 0.000000","row: Johor-Pontian<br>column: rape<br>value: 0.151153","row: Johor-Pontian<br>column: break_in<br>value: 0.126873","row: Johor-Pontian<br>column: theft_other<br>value: 0.020439","row: Johor-Pontian<br>column: robbery<br>value: 0.102997","row: Johor-Pontian<br>column: vehicle_theft<br>value: 0.267484","row: Johor-Pontian<br>column: poverty_absolute<br>value: 0.186047","row: Johor-Pontian<br>column: poverty_relative<br>value: 0.489143","row: Johor-Pontian<br>column: gini<br>value: 0.684982","row: Johor-Pontian<br>column: unemployment_rate<br>value: 0.558511","row: Johor-Pontian<br>column: employment_ratio<br>value: 0.489296"],["row: Kuala Lumpur-W.p. Putrajaya<br>column: causing_injury<br>value: 0.045382","row: Kuala Lumpur-W.p. Putrajaya<br>column: murder<br>value: 0.066698","row: Kuala Lumpur-W.p. Putrajaya<br>column: rape<br>value: 0.049915","row: Kuala Lumpur-W.p. Putrajaya<br>column: break_in<br>value: 0.258468","row: Kuala Lumpur-W.p. Putrajaya<br>column: theft_other<br>value: 0.298961","row: Kuala Lumpur-W.p. Putrajaya<br>column: robbery<br>value: 0.066965","row: Kuala Lumpur-W.p. Putrajaya<br>column: vehicle_theft<br>value: 0.173955","row: Kuala Lumpur-W.p. Putrajaya<br>column: poverty_absolute<br>value: 0.000000","row: Kuala Lumpur-W.p. Putrajaya<br>column: poverty_relative<br>value: 0.253714","row: Kuala Lumpur-W.p. Putrajaya<br>column: gini<br>value: 0.736264","row: Kuala Lumpur-W.p. Putrajaya<br>column: unemployment_rate<br>value: 0.490945","row: Kuala Lumpur-W.p. Putrajaya<br>column: employment_ratio<br>value: 0.466212"],["row: Terengganu-Kemaman<br>column: causing_injury<br>value: 0.204792","row: Terengganu-Kemaman<br>column: murder<br>value: 0.107589","row: Terengganu-Kemaman<br>column: rape<br>value: 0.166613","row: Terengganu-Kemaman<br>column: break_in<br>value: 0.622078","row: Terengganu-Kemaman<br>column: theft_other<br>value: 0.303015","row: Terengganu-Kemaman<br>column: robbery<br>value: 0.072809","row: Terengganu-Kemaman<br>column: vehicle_theft<br>value: 0.112000","row: Terengganu-Kemaman<br>column: poverty_absolute<br>value: 0.146691","row: Terengganu-Kemaman<br>column: poverty_relative<br>value: 0.115429","row: Terengganu-Kemaman<br>column: gini<br>value: 0.717949","row: Terengganu-Kemaman<br>column: unemployment_rate<br>value: 0.478723","row: Terengganu-Kemaman<br>column: employment_ratio<br>value: 0.505283"],["row: Terengganu-Dungun<br>column: causing_injury<br>value: 0.150054","row: Terengganu-Dungun<br>column: murder<br>value: 0.049359","row: Terengganu-Dungun<br>column: rape<br>value: 0.180059","row: Terengganu-Dungun<br>column: break_in<br>value: 0.584909","row: Terengganu-Dungun<br>column: theft_other<br>value: 0.310301","row: Terengganu-Dungun<br>column: robbery<br>value: 0.036189","row: Terengganu-Dungun<br>column: vehicle_theft<br>value: 0.117263","row: Terengganu-Dungun<br>column: poverty_absolute<br>value: 0.121646","row: Terengganu-Dungun<br>column: poverty_relative<br>value: 0.082286","row: Terengganu-Dungun<br>column: gini<br>value: 0.443223","row: Terengganu-Dungun<br>column: unemployment_rate<br>value: 0.542553","row: Terengganu-Dungun<br>column: employment_ratio<br>value: 0.101053"],["row: Terengganu-Kuala Terengganu<br>column: causing_injury<br>value: 0.318567","row: Terengganu-Kuala Terengganu<br>column: murder<br>value: 0.060883","row: Terengganu-Kuala Terengganu<br>column: rape<br>value: 0.154693","row: Terengganu-Kuala Terengganu<br>column: break_in<br>value: 0.442741","row: Terengganu-Kuala Terengganu<br>column: theft_other<br>value: 0.339181","row: Terengganu-Kuala Terengganu<br>column: robbery<br>value: 0.083717","row: Terengganu-Kuala Terengganu<br>column: vehicle_theft<br>value: 0.135549","row: Terengganu-Kuala Terengganu<br>column: poverty_absolute<br>value: 0.148479","row: Terengganu-Kuala Terengganu<br>column: poverty_relative<br>value: 0.106286","row: Terengganu-Kuala Terengganu<br>column: gini<br>value: 0.239927","row: Terengganu-Kuala Terengganu<br>column: unemployment_rate<br>value: 0.574468","row: Terengganu-Kuala Terengganu<br>column: employment_ratio<br>value: 0.168129"],["row: Terengganu-Marang<br>column: causing_injury<br>value: 0.231186","row: Terengganu-Marang<br>column: murder<br>value: 0.130605","row: Terengganu-Marang<br>column: rape<br>value: 0.216710","row: Terengganu-Marang<br>column: break_in<br>value: 0.410154","row: Terengganu-Marang<br>column: theft_other<br>value: 0.226360","row: Terengganu-Marang<br>column: robbery<br>value: 0.091372","row: Terengganu-Marang<br>column: vehicle_theft<br>value: 0.065619","row: Terengganu-Marang<br>column: poverty_absolute<br>value: 0.298748","row: Terengganu-Marang<br>column: poverty_relative<br>value: 0.257143","row: Terengganu-Marang<br>column: gini<br>value: 0.391941","row: Terengganu-Marang<br>column: unemployment_rate<br>value: 0.489362","row: Terengganu-Marang<br>column: employment_ratio<br>value: 0.094826"],["row: Terengganu-Hulu Terengganu<br>column: causing_injury<br>value: 0.524718","row: Terengganu-Hulu Terengganu<br>column: murder<br>value: 0.327508","row: Terengganu-Hulu Terengganu<br>column: rape<br>value: 0.121923","row: Terengganu-Hulu Terengganu<br>column: break_in<br>value: 0.434918","row: Terengganu-Hulu Terengganu<br>column: theft_other<br>value: 0.457332","row: Terengganu-Hulu Terengganu<br>column: robbery<br>value: 0.080378","row: Terengganu-Hulu Terengganu<br>column: vehicle_theft<br>value: 0.073803","row: Terengganu-Hulu Terengganu<br>column: poverty_absolute<br>value: 0.325581","row: Terengganu-Hulu Terengganu<br>column: poverty_relative<br>value: 0.395429","row: Terengganu-Hulu Terengganu<br>column: gini<br>value: 0.380952","row: Terengganu-Hulu Terengganu<br>column: unemployment_rate<br>value: 0.553191","row: Terengganu-Hulu Terengganu<br>column: employment_ratio<br>value: 0.032532"],["row: Terengganu-Besut<br>column: causing_injury<br>value: 0.571068","row: Terengganu-Besut<br>column: murder<br>value: 0.000000","row: Terengganu-Besut<br>column: rape<br>value: 0.320828","row: Terengganu-Besut<br>column: break_in<br>value: 0.837268","row: Terengganu-Besut<br>column: theft_other<br>value: 0.448155","row: Terengganu-Besut<br>column: robbery<br>value: 0.076116","row: Terengganu-Besut<br>column: vehicle_theft<br>value: 0.320777","row: Terengganu-Besut<br>column: poverty_absolute<br>value: 0.398927","row: Terengganu-Besut<br>column: poverty_relative<br>value: 0.222857","row: Terengganu-Besut<br>column: gini<br>value: 0.490842","row: Terengganu-Besut<br>column: unemployment_rate<br>value: 0.590426","row: Terengganu-Besut<br>column: employment_ratio<br>value: 0.193506"],["row: Kedah-Pendang<br>column: causing_injury<br>value: 0.375039","row: Kedah-Pendang<br>column: murder<br>value: 0.078904","row: Kedah-Pendang<br>column: rape<br>value: 0.303710","row: Kedah-Pendang<br>column: break_in<br>value: 0.414355","row: Kedah-Pendang<br>column: theft_other<br>value: 0.366923","row: Kedah-Pendang<br>column: robbery<br>value: 0.221867","row: Kedah-Pendang<br>column: vehicle_theft<br>value: 0.456663","row: Kedah-Pendang<br>column: poverty_absolute<br>value: 0.266547","row: Kedah-Pendang<br>column: poverty_relative<br>value: 0.236571","row: Kedah-Pendang<br>column: gini<br>value: 0.487179","row: Kedah-Pendang<br>column: unemployment_rate<br>value: 0.659574","row: Kedah-Pendang<br>column: employment_ratio<br>value: 0.396731"],["row: Kedah-Pokok Sena<br>column: causing_injury<br>value: 0.443131","row: Kedah-Pokok Sena<br>column: murder<br>value: 0.197720","row: Kedah-Pokok Sena<br>column: rape<br>value: 0.265725","row: Kedah-Pokok Sena<br>column: break_in<br>value: 0.492368","row: Kedah-Pokok Sena<br>column: theft_other<br>value: 0.272333","row: Kedah-Pokok Sena<br>column: robbery<br>value: 0.165535","row: Kedah-Pokok Sena<br>column: vehicle_theft<br>value: 0.394163","row: Kedah-Pokok Sena<br>column: poverty_absolute<br>value: 0.250447","row: Kedah-Pokok Sena<br>column: poverty_relative<br>value: 0.188571","row: Kedah-Pokok Sena<br>column: gini<br>value: 0.311355","row: Kedah-Pokok Sena<br>column: unemployment_rate<br>value: 0.537234","row: Kedah-Pokok Sena<br>column: employment_ratio<br>value: 0.487608"],["row: Kedah-Kubang Pasu<br>column: causing_injury<br>value: 0.440375","row: Kedah-Kubang Pasu<br>column: murder<br>value: 0.256397","row: Kedah-Kubang Pasu<br>column: rape<br>value: 0.188387","row: Kedah-Kubang Pasu<br>column: break_in<br>value: 0.402544","row: Kedah-Kubang Pasu<br>column: theft_other<br>value: 0.250356","row: Kedah-Kubang Pasu<br>column: robbery<br>value: 0.151537","row: Kedah-Kubang Pasu<br>column: vehicle_theft<br>value: 0.340667","row: Kedah-Kubang Pasu<br>column: poverty_absolute<br>value: 0.135957","row: Kedah-Kubang Pasu<br>column: poverty_relative<br>value: 0.117714","row: Kedah-Kubang Pasu<br>column: gini<br>value: 0.578755","row: Kedah-Kubang Pasu<br>column: unemployment_rate<br>value: 0.414894","row: Kedah-Kubang Pasu<br>column: employment_ratio<br>value: 0.326549"],["row: Pahang-Kuantan<br>column: causing_injury<br>value: 0.353750","row: Pahang-Kuantan<br>column: murder<br>value: 0.127401","row: Pahang-Kuantan<br>column: rape<br>value: 0.182921","row: Pahang-Kuantan<br>column: break_in<br>value: 0.558690","row: Pahang-Kuantan<br>column: theft_other<br>value: 0.282162","row: Pahang-Kuantan<br>column: robbery<br>value: 0.170823","row: Pahang-Kuantan<br>column: vehicle_theft<br>value: 0.231292","row: Pahang-Kuantan<br>column: poverty_absolute<br>value: 0.096601","row: Pahang-Kuantan<br>column: poverty_relative<br>value: 0.076571","row: Pahang-Kuantan<br>column: gini<br>value: 0.391941","row: Pahang-Kuantan<br>column: unemployment_rate<br>value: 0.324468","row: Pahang-Kuantan<br>column: employment_ratio<br>value: 0.660963"],["row: Pahang-Maran<br>column: causing_injury<br>value: 0.208914","row: Pahang-Maran<br>column: murder<br>value: 0.068754","row: Pahang-Maran<br>column: rape<br>value: 0.295503","row: Pahang-Maran<br>column: break_in<br>value: 0.431960","row: Pahang-Maran<br>column: theft_other<br>value: 0.283934","row: Pahang-Maran<br>column: robbery<br>value: 0.056012","row: Pahang-Maran<br>column: vehicle_theft<br>value: 0.235558","row: Pahang-Maran<br>column: poverty_absolute<br>value: 0.262970","row: Pahang-Maran<br>column: poverty_relative<br>value: 0.219429","row: Pahang-Maran<br>column: gini<br>value: 0.267399","row: Pahang-Maran<br>column: unemployment_rate<br>value: 0.276596","row: Pahang-Maran<br>column: employment_ratio<br>value: 0.506087"],["row: Pahang-Pekan<br>column: causing_injury<br>value: 0.211211","row: Pahang-Pekan<br>column: murder<br>value: 0.191960","row: Pahang-Pekan<br>column: rape<br>value: 0.316518","row: Pahang-Pekan<br>column: break_in<br>value: 0.574002","row: Pahang-Pekan<br>column: theft_other<br>value: 0.203655","row: Pahang-Pekan<br>column: robbery<br>value: 0.037936","row: Pahang-Pekan<br>column: vehicle_theft<br>value: 0.103775","row: Pahang-Pekan<br>column: poverty_absolute<br>value: 0.316637","row: Pahang-Pekan<br>column: poverty_relative<br>value: 0.262857","row: Pahang-Pekan<br>column: gini<br>value: 0.336996","row: Pahang-Pekan<br>column: unemployment_rate<br>value: 0.372340","row: Pahang-Pekan<br>column: employment_ratio<br>value: 0.495757"],["row: Pahang-Jerantut<br>column: causing_injury<br>value: 0.264339","row: Pahang-Jerantut<br>column: murder<br>value: 0.324398","row: Pahang-Jerantut<br>column: rape<br>value: 0.416462","row: Pahang-Jerantut<br>column: break_in<br>value: 0.396171","row: Pahang-Jerantut<br>column: theft_other<br>value: 0.342917","row: Pahang-Jerantut<br>column: robbery<br>value: 0.065386","row: Pahang-Jerantut<br>column: vehicle_theft<br>value: 0.087073","row: Pahang-Jerantut<br>column: poverty_absolute<br>value: 0.322004","row: Pahang-Jerantut<br>column: poverty_relative<br>value: 0.274286","row: Pahang-Jerantut<br>column: gini<br>value: 0.183150","row: Pahang-Jerantut<br>column: unemployment_rate<br>value: 0.547872","row: Pahang-Jerantut<br>column: employment_ratio<br>value: 0.447722"],["row: Kedah-Bandar Baharu<br>column: causing_injury<br>value: 0.158544","row: Kedah-Bandar Baharu<br>column: murder<br>value: 0.175757","row: Kedah-Bandar Baharu<br>column: rape<br>value: 0.117460","row: Kedah-Bandar Baharu<br>column: break_in<br>value: 0.323428","row: Kedah-Bandar Baharu<br>column: theft_other<br>value: 0.154123","row: Kedah-Bandar Baharu<br>column: robbery<br>value: 0.106351","row: Kedah-Bandar Baharu<br>column: vehicle_theft<br>value: 0.036423","row: Kedah-Bandar Baharu<br>column: poverty_absolute<br>value: 0.189624","row: Kedah-Bandar Baharu<br>column: poverty_relative<br>value: 0.294857","row: Kedah-Bandar Baharu<br>column: gini<br>value: 0.318681","row: Kedah-Bandar Baharu<br>column: unemployment_rate<br>value: 0.510638","row: Kedah-Bandar Baharu<br>column: employment_ratio<br>value: 0.646309"],["row: Terengganu-Setiu<br>column: causing_injury<br>value: 0.143213","row: Terengganu-Setiu<br>column: murder<br>value: 0.000000","row: Terengganu-Setiu<br>column: rape<br>value: 0.201430","row: Terengganu-Setiu<br>column: break_in<br>value: 0.259418","row: Terengganu-Setiu<br>column: theft_other<br>value: 0.201719","row: Terengganu-Setiu<br>column: robbery<br>value: 0.054221","row: Terengganu-Setiu<br>column: vehicle_theft<br>value: 0.157326","row: Terengganu-Setiu<br>column: poverty_absolute<br>value: 0.241503","row: Terengganu-Setiu<br>column: poverty_relative<br>value: 0.180571","row: Terengganu-Setiu<br>column: gini<br>value: 0.278388","row: Terengganu-Setiu<br>column: unemployment_rate<br>value: 0.670213","row: Terengganu-Setiu<br>column: employment_ratio<br>value: 0.386011"],["row: Pahang-Lipis<br>column: causing_injury<br>value: 0.239397","row: Pahang-Lipis<br>column: murder<br>value: 0.080783","row: Pahang-Lipis<br>column: rape<br>value: 0.099837","row: Pahang-Lipis<br>column: break_in<br>value: 0.136361","row: Pahang-Lipis<br>column: theft_other<br>value: 0.247473","row: Pahang-Lipis<br>column: robbery<br>value: 0.010623","row: Pahang-Lipis<br>column: vehicle_theft<br>value: 0.000000","row: Pahang-Lipis<br>column: poverty_absolute<br>value: 0.259392","row: Pahang-Lipis<br>column: poverty_relative<br>value: 0.179429","row: Pahang-Lipis<br>column: gini<br>value: 0.161172","row: Pahang-Lipis<br>column: unemployment_rate<br>value: 0.276596","row: Pahang-Lipis<br>column: employment_ratio<br>value: 0.211871"],["row: Pahang-Raub<br>column: causing_injury<br>value: 0.584083","row: Pahang-Raub<br>column: murder<br>value: 0.081203","row: Pahang-Raub<br>column: rape<br>value: 0.000000","row: Pahang-Raub<br>column: break_in<br>value: 0.134459","row: Pahang-Raub<br>column: theft_other<br>value: 0.126050","row: Pahang-Raub<br>column: robbery<br>value: 0.026291","row: Pahang-Raub<br>column: vehicle_theft<br>value: 0.090878","row: Pahang-Raub<br>column: poverty_absolute<br>value: 0.116279","row: Pahang-Raub<br>column: poverty_relative<br>value: 0.042286","row: Pahang-Raub<br>column: gini<br>value: 0.153846","row: Pahang-Raub<br>column: unemployment_rate<br>value: 0.446809","row: Pahang-Raub<br>column: employment_ratio<br>value: 0.439006"],["row: Pahang-Bera<br>column: causing_injury<br>value: 0.603254","row: Pahang-Bera<br>column: murder<br>value: 0.237999","row: Pahang-Bera<br>column: rape<br>value: 0.281876","row: Pahang-Bera<br>column: break_in<br>value: 0.273934","row: Pahang-Bera<br>column: theft_other<br>value: 0.220419","row: Pahang-Bera<br>column: robbery<br>value: 0.044549","row: Pahang-Bera<br>column: vehicle_theft<br>value: 0.098614","row: Pahang-Bera<br>column: poverty_absolute<br>value: 0.194991","row: Pahang-Bera<br>column: poverty_relative<br>value: 0.196571","row: Pahang-Bera<br>column: gini<br>value: 0.065934","row: Pahang-Bera<br>column: unemployment_rate<br>value: 0.500000","row: Pahang-Bera<br>column: employment_ratio<br>value: 0.146752"],["row: Pahang-Rompin<br>column: causing_injury<br>value: 0.617515","row: Pahang-Rompin<br>column: murder<br>value: 0.155296","row: Pahang-Rompin<br>column: rape<br>value: 0.460487","row: Pahang-Rompin<br>column: break_in<br>value: 0.375867","row: Pahang-Rompin<br>column: theft_other<br>value: 0.167531","row: Pahang-Rompin<br>column: robbery<br>value: 0.055650","row: Pahang-Rompin<br>column: vehicle_theft<br>value: 0.146945","row: Pahang-Rompin<br>column: poverty_absolute<br>value: 0.325581","row: Pahang-Rompin<br>column: poverty_relative<br>value: 0.227429","row: Pahang-Rompin<br>column: gini<br>value: 0.351648","row: Pahang-Rompin<br>column: unemployment_rate<br>value: 0.367021","row: Pahang-Rompin<br>column: employment_ratio<br>value: 0.365217"],["row: Kedah-Padang Terap<br>column: causing_injury<br>value: 0.801690","row: Kedah-Padang Terap<br>column: murder<br>value: 0.355077","row: Kedah-Padang Terap<br>column: rape<br>value: 0.322027","row: Kedah-Padang Terap<br>column: break_in<br>value: 0.299386","row: Kedah-Padang Terap<br>column: theft_other<br>value: 0.164654","row: Kedah-Padang Terap<br>column: robbery<br>value: 0.087340","row: Kedah-Padang Terap<br>column: vehicle_theft<br>value: 0.175122","row: Kedah-Padang Terap<br>column: poverty_absolute<br>value: 0.313059","row: Kedah-Padang Terap<br>column: poverty_relative<br>value: 0.174857","row: Kedah-Padang Terap<br>column: gini<br>value: 0.373626","row: Kedah-Padang Terap<br>column: unemployment_rate<br>value: 0.468085","row: Kedah-Padang Terap<br>column: employment_ratio<br>value: 0.517190"],["row: Pahang-Temerloh<br>column: causing_injury<br>value: 0.612843","row: Pahang-Temerloh<br>column: murder<br>value: 0.368000","row: Pahang-Temerloh<br>column: rape<br>value: 0.264859","row: Pahang-Temerloh<br>column: break_in<br>value: 0.214454","row: Pahang-Temerloh<br>column: theft_other<br>value: 0.236750","row: Pahang-Temerloh<br>column: robbery<br>value: 0.114957","row: Pahang-Temerloh<br>column: vehicle_theft<br>value: 0.184850","row: Pahang-Temerloh<br>column: poverty_absolute<br>value: 0.218247","row: Pahang-Temerloh<br>column: poverty_relative<br>value: 0.201143","row: Pahang-Temerloh<br>column: gini<br>value: 0.315018","row: Pahang-Temerloh<br>column: unemployment_rate<br>value: 0.425532","row: Pahang-Temerloh<br>column: employment_ratio<br>value: 0.406188"],["row: Perak-Larut Dan Matang<br>column: causing_injury<br>value: 0.611647","row: Perak-Larut Dan Matang<br>column: murder<br>value: 0.204446","row: Perak-Larut Dan Matang<br>column: rape<br>value: 0.133976","row: Perak-Larut Dan Matang<br>column: break_in<br>value: 0.289419","row: Perak-Larut Dan Matang<br>column: theft_other<br>value: 0.194699","row: Perak-Larut Dan Matang<br>column: robbery<br>value: 0.288673","row: Perak-Larut Dan Matang<br>column: vehicle_theft<br>value: 0.316736","row: Perak-Larut Dan Matang<br>column: poverty_absolute<br>value: 0.262075","row: Perak-Larut Dan Matang<br>column: poverty_relative<br>value: 0.270286","row: Perak-Larut Dan Matang<br>column: gini<br>value: 0.472527","row: Perak-Larut Dan Matang<br>column: unemployment_rate<br>value: 0.872340","row: Perak-Larut Dan Matang<br>column: employment_ratio<br>value: 0.430586"],["row: Perak-Kerian<br>column: causing_injury<br>value: 0.354982","row: Perak-Kerian<br>column: murder<br>value: 0.325955","row: Perak-Kerian<br>column: rape<br>value: 0.117080","row: Perak-Kerian<br>column: break_in<br>value: 0.138459","row: Perak-Kerian<br>column: theft_other<br>value: 0.066866","row: Perak-Kerian<br>column: robbery<br>value: 0.152658","row: Perak-Kerian<br>column: vehicle_theft<br>value: 0.235490","row: Perak-Kerian<br>column: poverty_absolute<br>value: 0.254025","row: Perak-Kerian<br>column: poverty_relative<br>value: 0.296000","row: Perak-Kerian<br>column: gini<br>value: 0.520147","row: Perak-Kerian<br>column: unemployment_rate<br>value: 0.813830","row: Perak-Kerian<br>column: employment_ratio<br>value: 0.198289"],["row: Perak-Kampar<br>column: causing_injury<br>value: 0.278053","row: Perak-Kampar<br>column: murder<br>value: 0.395964","row: Perak-Kampar<br>column: rape<br>value: 0.010067","row: Perak-Kampar<br>column: break_in<br>value: 0.276922","row: Perak-Kampar<br>column: theft_other<br>value: 0.187110","row: Perak-Kampar<br>column: robbery<br>value: 0.162543","row: Perak-Kampar<br>column: vehicle_theft<br>value: 0.190072","row: Perak-Kampar<br>column: poverty_absolute<br>value: 0.200358","row: Perak-Kampar<br>column: poverty_relative<br>value: 0.293714","row: Perak-Kampar<br>column: gini<br>value: 0.501832","row: Perak-Kampar<br>column: unemployment_rate<br>value: 0.590426","row: Perak-Kampar<br>column: employment_ratio<br>value: 0.297884"],["row: Negeri Sembilan-Tampin<br>column: causing_injury<br>value: 0.297134","row: Negeri Sembilan-Tampin<br>column: murder<br>value: 0.440789","row: Negeri Sembilan-Tampin<br>column: rape<br>value: 0.063836","row: Negeri Sembilan-Tampin<br>column: break_in<br>value: 0.475086","row: Negeri Sembilan-Tampin<br>column: theft_other<br>value: 0.290473","row: Negeri Sembilan-Tampin<br>column: robbery<br>value: 0.119868","row: Negeri Sembilan-Tampin<br>column: vehicle_theft<br>value: 0.157034","row: Negeri Sembilan-Tampin<br>column: poverty_absolute<br>value: 0.207513","row: Negeri Sembilan-Tampin<br>column: poverty_relative<br>value: 0.443429","row: Negeri Sembilan-Tampin<br>column: gini<br>value: 0.750916","row: Negeri Sembilan-Tampin<br>column: unemployment_rate<br>value: 0.574468","row: Negeri Sembilan-Tampin<br>column: employment_ratio<br>value: 0.410281"],["row: Perak-Kinta<br>column: causing_injury<br>value: 0.504987","row: Perak-Kinta<br>column: murder<br>value: 0.376264","row: Perak-Kinta<br>column: rape<br>value: 0.027121","row: Perak-Kinta<br>column: break_in<br>value: 0.455146","row: Perak-Kinta<br>column: theft_other<br>value: 0.166843","row: Perak-Kinta<br>column: robbery<br>value: 0.284399","row: Perak-Kinta<br>column: vehicle_theft<br>value: 0.278719","row: Perak-Kinta<br>column: poverty_absolute<br>value: 0.146691","row: Perak-Kinta<br>column: poverty_relative<br>value: 0.205714","row: Perak-Kinta<br>column: gini<br>value: 0.842491","row: Perak-Kinta<br>column: unemployment_rate<br>value: 0.670213","row: Perak-Kinta<br>column: employment_ratio<br>value: 0.471722"],["row: Perak-Manjung (Dinding)<br>column: causing_injury<br>value: 0.516735","row: Perak-Manjung (Dinding)<br>column: murder<br>value: 0.472134","row: Perak-Manjung (Dinding)<br>column: rape<br>value: 0.060566","row: Perak-Manjung (Dinding)<br>column: break_in<br>value: 0.249535","row: Perak-Manjung (Dinding)<br>column: theft_other<br>value: 0.145141","row: Perak-Manjung (Dinding)<br>column: robbery<br>value: 0.158355","row: Perak-Manjung (Dinding)<br>column: vehicle_theft<br>value: 0.313372","row: Perak-Manjung (Dinding)<br>column: poverty_absolute<br>value: 0.182469","row: Perak-Manjung (Dinding)<br>column: poverty_relative<br>value: 0.212571","row: Perak-Manjung (Dinding)<br>column: gini<br>value: 0.765568","row: Perak-Manjung (Dinding)<br>column: unemployment_rate<br>value: 0.792553","row: Perak-Manjung (Dinding)<br>column: employment_ratio<br>value: 0.374465"],["row: Perak-Perak Tengah<br>column: causing_injury<br>value: 0.223255","row: Perak-Perak Tengah<br>column: murder<br>value: 0.410896","row: Perak-Perak Tengah<br>column: rape<br>value: 0.219323","row: Perak-Perak Tengah<br>column: break_in<br>value: 0.165269","row: Perak-Perak Tengah<br>column: theft_other<br>value: 0.252708","row: Perak-Perak Tengah<br>column: robbery<br>value: 0.046835","row: Perak-Perak Tengah<br>column: vehicle_theft<br>value: 0.107476","row: Perak-Perak Tengah<br>column: poverty_absolute<br>value: 0.368515","row: Perak-Perak Tengah<br>column: poverty_relative<br>value: 0.345143","row: Perak-Perak Tengah<br>column: gini<br>value: 0.864469","row: Perak-Perak Tengah<br>column: unemployment_rate<br>value: 0.797872","row: Perak-Perak Tengah<br>column: employment_ratio<br>value: 0.284685"],["row: Perak-Kuala Kangsar<br>column: causing_injury<br>value: 0.417632","row: Perak-Kuala Kangsar<br>column: murder<br>value: 0.265380","row: Perak-Kuala Kangsar<br>column: rape<br>value: 0.126414","row: Perak-Kuala Kangsar<br>column: break_in<br>value: 0.210434","row: Perak-Kuala Kangsar<br>column: theft_other<br>value: 0.089214","row: Perak-Kuala Kangsar<br>column: robbery<br>value: 0.173510","row: Perak-Kuala Kangsar<br>column: vehicle_theft<br>value: 0.098761","row: Perak-Kuala Kangsar<br>column: poverty_absolute<br>value: 0.413238","row: Perak-Kuala Kangsar<br>column: poverty_relative<br>value: 0.346286","row: Perak-Kuala Kangsar<br>column: gini<br>value: 0.915751","row: Perak-Kuala Kangsar<br>column: unemployment_rate<br>value: 0.803191","row: Perak-Kuala Kangsar<br>column: employment_ratio<br>value: 0.210221"],["row: Kelantan-Machang<br>column: causing_injury<br>value: 0.241907","row: Kelantan-Machang<br>column: murder<br>value: 0.140062","row: Kelantan-Machang<br>column: rape<br>value: 0.074126","row: Kelantan-Machang<br>column: break_in<br>value: 0.573989","row: Kelantan-Machang<br>column: theft_other<br>value: 0.175771","row: Kelantan-Machang<br>column: robbery<br>value: 0.080942","row: Kelantan-Machang<br>column: vehicle_theft<br>value: 0.150184","row: Kelantan-Machang<br>column: poverty_absolute<br>value: 0.332737","row: Kelantan-Machang<br>column: poverty_relative<br>value: 0.252571","row: Kelantan-Machang<br>column: gini<br>value: 0.871795","row: Kelantan-Machang<br>column: unemployment_rate<br>value: 0.867021","row: Kelantan-Machang<br>column: employment_ratio<br>value: 0.107202"],["row: Kelantan-Kota Bharu<br>column: causing_injury<br>value: 0.200749","row: Kelantan-Kota Bharu<br>column: murder<br>value: 0.097374","row: Kelantan-Kota Bharu<br>column: rape<br>value: 0.084982","row: Kelantan-Kota Bharu<br>column: break_in<br>value: 0.502758","row: Kelantan-Kota Bharu<br>column: theft_other<br>value: 0.189188","row: Kelantan-Kota Bharu<br>column: robbery<br>value: 0.146948","row: Kelantan-Kota Bharu<br>column: vehicle_theft<br>value: 0.524802","row: Kelantan-Kota Bharu<br>column: poverty_absolute<br>value: 0.341682","row: Kelantan-Kota Bharu<br>column: poverty_relative<br>value: 0.156571","row: Kelantan-Kota Bharu<br>column: gini<br>value: 0.868132","row: Kelantan-Kota Bharu<br>column: unemployment_rate<br>value: 0.803191","row: Kelantan-Kota Bharu<br>column: employment_ratio<br>value: 0.222902"],["row: Kelantan-Pasir Puteh<br>column: causing_injury<br>value: 0.745577","row: Kelantan-Pasir Puteh<br>column: murder<br>value: 0.400066","row: Kelantan-Pasir Puteh<br>column: rape<br>value: 0.377219","row: Kelantan-Pasir Puteh<br>column: break_in<br>value: 0.582740","row: Kelantan-Pasir Puteh<br>column: theft_other<br>value: 0.185513","row: Kelantan-Pasir Puteh<br>column: robbery<br>value: 0.160407","row: Kelantan-Pasir Puteh<br>column: vehicle_theft<br>value: 0.412273","row: Kelantan-Pasir Puteh<br>column: poverty_absolute<br>value: 0.502683","row: Kelantan-Pasir Puteh<br>column: poverty_relative<br>value: 0.264000","row: Kelantan-Pasir Puteh<br>column: gini<br>value: 0.864469","row: Kelantan-Pasir Puteh<br>column: unemployment_rate<br>value: 0.398936","row: Kelantan-Pasir Puteh<br>column: employment_ratio<br>value: 0.158768"],["row: Perak-Hilir Perak<br>column: causing_injury<br>value: 0.999264","row: Perak-Hilir Perak<br>column: murder<br>value: 0.172445","row: Perak-Hilir Perak<br>column: rape<br>value: 0.157513","row: Perak-Hilir Perak<br>column: break_in<br>value: 0.574727","row: Perak-Hilir Perak<br>column: theft_other<br>value: 0.454631","row: Perak-Hilir Perak<br>column: robbery<br>value: 0.162757","row: Perak-Hilir Perak<br>column: vehicle_theft<br>value: 0.162784","row: Perak-Hilir Perak<br>column: poverty_absolute<br>value: 0.398927","row: Perak-Hilir Perak<br>column: poverty_relative<br>value: 0.382857","row: Perak-Hilir Perak<br>column: gini<br>value: 0.783883","row: Perak-Hilir Perak<br>column: unemployment_rate<br>value: 0.707447","row: Perak-Hilir Perak<br>column: employment_ratio<br>value: 0.390347"],["row: Negeri Sembilan-Jempol<br>column: causing_injury<br>value: 0.933005","row: Negeri Sembilan-Jempol<br>column: murder<br>value: 0.122795","row: Negeri Sembilan-Jempol<br>column: rape<br>value: 0.223677","row: Negeri Sembilan-Jempol<br>column: break_in<br>value: 0.439053","row: Negeri Sembilan-Jempol<br>column: theft_other<br>value: 0.222943","row: Negeri Sembilan-Jempol<br>column: robbery<br>value: 0.139024","row: Negeri Sembilan-Jempol<br>column: vehicle_theft<br>value: 0.154332","row: Negeri Sembilan-Jempol<br>column: poverty_absolute<br>value: 0.245081","row: Negeri Sembilan-Jempol<br>column: poverty_relative<br>value: 0.398857","row: Negeri Sembilan-Jempol<br>column: gini<br>value: 0.538462","row: Negeri Sembilan-Jempol<br>column: unemployment_rate<br>value: 0.558511","row: Negeri Sembilan-Jempol<br>column: employment_ratio<br>value: 0.315514"],["row: Kelantan-Bachok<br>column: causing_injury<br>value: 0.691608","row: Kelantan-Bachok<br>column: murder<br>value: 0.148829","row: Kelantan-Bachok<br>column: rape<br>value: 0.198082","row: Kelantan-Bachok<br>column: break_in<br>value: 0.337549","row: Kelantan-Bachok<br>column: theft_other<br>value: 0.120184","row: Kelantan-Bachok<br>column: robbery<br>value: 0.060087","row: Kelantan-Bachok<br>column: vehicle_theft<br>value: 0.238985","row: Kelantan-Bachok<br>column: poverty_absolute<br>value: 0.441860","row: Kelantan-Bachok<br>column: poverty_relative<br>value: 0.226286","row: Kelantan-Bachok<br>column: gini<br>value: 0.758242","row: Kelantan-Bachok<br>column: unemployment_rate<br>value: 0.489362","row: Kelantan-Bachok<br>column: employment_ratio<br>value: 0.045291"],["row: Kelantan-Pasir Mas<br>column: causing_injury<br>value: 0.551196","row: Kelantan-Pasir Mas<br>column: murder<br>value: 0.100841","row: Kelantan-Pasir Mas<br>column: rape<br>value: 0.092915","row: Kelantan-Pasir Mas<br>column: break_in<br>value: 0.292556","row: Kelantan-Pasir Mas<br>column: theft_other<br>value: 0.108638","row: Kelantan-Pasir Mas<br>column: robbery<br>value: 0.091547","row: Kelantan-Pasir Mas<br>column: vehicle_theft<br>value: 0.049756","row: Kelantan-Pasir Mas<br>column: poverty_absolute<br>value: 0.386404","row: Kelantan-Pasir Mas<br>column: poverty_relative<br>value: 0.218286","row: Kelantan-Pasir Mas<br>column: gini<br>value: 0.787546","row: Kelantan-Pasir Mas<br>column: unemployment_rate<br>value: 0.696809","row: Kelantan-Pasir Mas<br>column: employment_ratio<br>value: 0.000000"],["row: Kelantan-Tumpat<br>column: causing_injury<br>value: 0.226977","row: Kelantan-Tumpat<br>column: murder<br>value: 0.042480","row: Kelantan-Tumpat<br>column: rape<br>value: 0.127483","row: Kelantan-Tumpat<br>column: break_in<br>value: 0.475396","row: Kelantan-Tumpat<br>column: theft_other<br>value: 0.149125","row: Kelantan-Tumpat<br>column: robbery<br>value: 0.147920","row: Kelantan-Tumpat<br>column: vehicle_theft<br>value: 0.169686","row: Kelantan-Tumpat<br>column: poverty_absolute<br>value: 0.456172","row: Kelantan-Tumpat<br>column: poverty_relative<br>value: 0.212571","row: Kelantan-Tumpat<br>column: gini<br>value: 0.780220","row: Kelantan-Tumpat<br>column: unemployment_rate<br>value: 0.414894","row: Kelantan-Tumpat<br>column: employment_ratio<br>value: 0.068205"],["row: Kelantan-Tanah Merah<br>column: causing_injury<br>value: 0.336789","row: Kelantan-Tanah Merah<br>column: murder<br>value: 0.103496","row: Kelantan-Tanah Merah<br>column: rape<br>value: 0.283580","row: Kelantan-Tanah Merah<br>column: break_in<br>value: 0.248278","row: Kelantan-Tanah Merah<br>column: theft_other<br>value: 0.138807","row: Kelantan-Tanah Merah<br>column: robbery<br>value: 0.112790","row: Kelantan-Tanah Merah<br>column: vehicle_theft<br>value: 0.187200","row: Kelantan-Tanah Merah<br>column: poverty_absolute<br>value: 0.525939","row: Kelantan-Tanah Merah<br>column: poverty_relative<br>value: 0.254857","row: Kelantan-Tanah Merah<br>column: gini<br>value: 0.714286","row: Kelantan-Tanah Merah<br>column: unemployment_rate<br>value: 0.329787","row: Kelantan-Tanah Merah<br>column: employment_ratio<br>value: 0.167915"],["row: Kelantan-Jeli<br>column: causing_injury<br>value: 0.204589","row: Kelantan-Jeli<br>column: murder<br>value: 0.140353","row: Kelantan-Jeli<br>column: rape<br>value: 0.139764","row: Kelantan-Jeli<br>column: break_in<br>value: 0.266313","row: Kelantan-Jeli<br>column: theft_other<br>value: 0.044989","row: Kelantan-Jeli<br>column: robbery<br>value: 0.000000","row: Kelantan-Jeli<br>column: vehicle_theft<br>value: 0.010043","row: Kelantan-Jeli<br>column: poverty_absolute<br>value: 0.524150","row: Kelantan-Jeli<br>column: poverty_relative<br>value: 0.299429","row: Kelantan-Jeli<br>column: gini<br>value: 0.549451","row: Kelantan-Jeli<br>column: unemployment_rate<br>value: 0.351064","row: Kelantan-Jeli<br>column: employment_ratio<br>value: 0.112957"],["row: Kelantan-Kuala Krai<br>column: causing_injury<br>value: 0.470767","row: Kelantan-Kuala Krai<br>column: murder<br>value: 0.074320","row: Kelantan-Kuala Krai<br>column: rape<br>value: 0.312340","row: Kelantan-Kuala Krai<br>column: break_in<br>value: 0.212239","row: Kelantan-Kuala Krai<br>column: theft_other<br>value: 0.144676","row: Kelantan-Kuala Krai<br>column: robbery<br>value: 0.007993","row: Kelantan-Kuala Krai<br>column: vehicle_theft<br>value: 0.047268","row: Kelantan-Kuala Krai<br>column: poverty_absolute<br>value: 0.792487","row: Kelantan-Kuala Krai<br>column: poverty_relative<br>value: 0.532571","row: Kelantan-Kuala Krai<br>column: gini<br>value: 0.926740","row: Kelantan-Kuala Krai<br>column: unemployment_rate<br>value: 0.239362","row: Kelantan-Kuala Krai<br>column: employment_ratio<br>value: 0.313076"],["row: Johor-Mersing<br>column: causing_injury<br>value: 0.503929","row: Johor-Mersing<br>column: murder<br>value: 0.296341","row: Johor-Mersing<br>column: rape<br>value: 0.239465","row: Johor-Mersing<br>column: break_in<br>value: 0.266567","row: Johor-Mersing<br>column: theft_other<br>value: 0.129405","row: Johor-Mersing<br>column: robbery<br>value: 0.152126","row: Johor-Mersing<br>column: vehicle_theft<br>value: 0.254317","row: Johor-Mersing<br>column: poverty_absolute<br>value: 0.434705","row: Johor-Mersing<br>column: poverty_relative<br>value: 0.834286","row: Johor-Mersing<br>column: gini<br>value: 0.688645","row: Johor-Mersing<br>column: unemployment_rate<br>value: 0.393617","row: Johor-Mersing<br>column: employment_ratio<br>value: 0.258684"],["row: Kelantan-Gua Musang<br>column: causing_injury<br>value: 0.431618","row: Kelantan-Gua Musang<br>column: murder<br>value: 0.621081","row: Kelantan-Gua Musang<br>column: rape<br>value: 0.167898","row: Kelantan-Gua Musang<br>column: break_in<br>value: 0.239713","row: Kelantan-Gua Musang<br>column: theft_other<br>value: 0.179800","row: Kelantan-Gua Musang<br>column: robbery<br>value: 0.069145","row: Kelantan-Gua Musang<br>column: vehicle_theft<br>value: 0.062431","row: Kelantan-Gua Musang<br>column: poverty_absolute<br>value: 1.000000","row: Kelantan-Gua Musang<br>column: poverty_relative<br>value: 0.460571","row: Kelantan-Gua Musang<br>column: gini<br>value: 0.492674","row: Kelantan-Gua Musang<br>column: unemployment_rate<br>value: 0.601064","row: Kelantan-Gua Musang<br>column: employment_ratio<br>value: 0.048740"],["row: Pahang-Bentong<br>column: causing_injury<br>value: 0.613521","row: Pahang-Bentong<br>column: murder<br>value: 0.602634","row: Pahang-Bentong<br>column: rape<br>value: 0.253607","row: Pahang-Bentong<br>column: break_in<br>value: 0.464130","row: Pahang-Bentong<br>column: theft_other<br>value: 1.000000","row: Pahang-Bentong<br>column: robbery<br>value: 0.218009","row: Pahang-Bentong<br>column: vehicle_theft<br>value: 0.244024","row: Pahang-Bentong<br>column: poverty_absolute<br>value: 0.100179","row: Pahang-Bentong<br>column: poverty_relative<br>value: 0.029714","row: Pahang-Bentong<br>column: gini<br>value: 0.000000","row: Pahang-Bentong<br>column: unemployment_rate<br>value: 0.345745","row: Pahang-Bentong<br>column: employment_ratio<br>value: 0.522465"],["row: Pahang-Cameron Highlands<br>column: causing_injury<br>value: 0.737639","row: Pahang-Cameron Highlands<br>column: murder<br>value: 1.000000","row: Pahang-Cameron Highlands<br>column: rape<br>value: 0.148894","row: Pahang-Cameron Highlands<br>column: break_in<br>value: 0.106045","row: Pahang-Cameron Highlands<br>column: theft_other<br>value: 0.068593","row: Pahang-Cameron Highlands<br>column: robbery<br>value: 0.037519","row: Pahang-Cameron Highlands<br>column: vehicle_theft<br>value: 0.171891","row: Pahang-Cameron Highlands<br>column: poverty_absolute<br>value: 0.032200","row: Pahang-Cameron Highlands<br>column: poverty_relative<br>value: 0.000000","row: Pahang-Cameron Highlands<br>column: gini<br>value: 0.062271","row: Pahang-Cameron Highlands<br>column: unemployment_rate<br>value: 0.287234","row: Pahang-Cameron Highlands<br>column: employment_ratio<br>value: 0.880194"]],"colorscale":[[0,"#FFF7EC"],[0.0035778175313059025,"#FEF6EA"],[0.0079929915585737511,"#FEF6E9"],[0.010042919933905239,"#FEF5E8"],[0.010067487435922931,"#FEF5E8"],[0.010623237225070066,"#FEF5E8"],[0.010733452593917713,"#FEF5E8"],[0.012522361359570661,"#FEF5E8"],[0.017786324403027229,"#FEF4E6"],[0.019677996422182469,"#FEF4E6"],[0.020439028069196365,"#FEF4E6"],[0.025351131218228278,"#FEF4E5"],[0.026290590148500253,"#FEF3E4"],[0.027121175042724786,"#FEF3E4"],[0.027358628746701669,"#FEF3E4"],[0.028887904269581689,"#FEF3E3"],[0.029714285714285707,"#FEF3E3"],[0.032200357781753126,"#FEF3E2"],[0.032531745455838812,"#FEF3E2"],[0.033989266547406083,"#FEF2E1"],[0.034726965422779935,"#FEF2E1"],[0.036189411477978745,"#FEF2E1"],[0.036422550257803929,"#FEF2E1"],[0.037518801695380188,"#FEF2E0"],[0.03793602601568432,"#FEF2E0"],[0.039355992844364938,"#FEF2E0"],[0.040454578553206701,"#FEF2E0"],[0.041144901610017888,"#FEF2E0"],[0.042285714285714281,"#FEF1DF"],[0.042480236742292676,"#FEF1DF"],[0.042621417874962313,"#FEF1DF"],[0.04304362900451509,"#FEF1DF"],[0.043091340234071837,"#FEF1DF"],[0.044548631726190335,"#FEF1DF"],[0.044988746739197782,"#FEF1DF"],[0.045291256441124327,"#FEF1DE"],[0.045337346827504697,"#FEF1DE"],[0.045382485271861429,"#FEF1DE"],[0.04683529471632316,"#FEF1DE"],[0.047267704945715645,"#FEF1DE"],[0.047583045668043687,"#FEF1DE"],[0.047872340425531894,"#FEF1DE"],[0.0483005366726297,"#FEF1DE"],[0.048740371099660847,"#FEF1DE"],[0.0493587570497101,"#FEF0DD"],[0.049755751918064889,"#FEF0DD"],[0.049914688986473429,"#FEF0DD"],[0.054146650582650425,"#FEF0DC"],[0.05422054813705908,"#FEF0DC"],[0.055456171735241505,"#FEF0DC"],[0.055650261855916372,"#FEF0DC"],[0.056012459279522503,"#FEF0DC"],[0.05612108742756472,"#FEF0DC"],[0.058627028143092848,"#FEEFDB"],[0.060086608297612296,"#FEEFDA"],[0.060565745185199582,"#FEEFDA"],[0.060822898032200368,"#FEEFDA"],[0.060883407621771239,"#FEEFDA"],[0.061182634857519923,"#FEEFDA"],[0.062271062271062348,"#FEEFD9"],[0.062430726408066878,"#FEEFD9"],[0.062857142857142861,"#FEEFD9"],[0.063835795962541589,"#FEEFD9"],[0.065386329455657546,"#FEEFD8"],[0.06561860442209963,"#FEEFD8"],[0.065934065934066019,"#FEEFD8"],[0.066697602474864656,"#FEEFD8"],[0.066865990000194164,"#FEEFD8"],[0.066919388605629307,"#FEEFD8"],[0.066965166823571051,"#FEEFD8"],[0.067718633611748943,"#FEEFD8"],[0.068205032435288582,"#FEEFD8"],[0.068592790991218178,"#FEEFD8"],[0.0687543567362041,"#FEEED7"],[0.069144620021681508,"#FEEED7"],[0.072664687172069739,"#FEEED6"],[0.072808520828467213,"#FEEED6"],[0.072862927073381545,"#FEEED6"],[0.073802515670480212,"#FEEED6"],[0.074126099281663319,"#FEEED6"],[0.074320185614849196,"#FEEED6"],[0.075134168157423964,"#FEEED6"],[0.076115571870284268,"#FEEED6"],[0.076571428571428554,"#FEEDD5"],[0.078214185921277851,"#FEEDD5"],[0.078904140440436449,"#FEEDD5"],[0.080377744056759556,"#FEEDD5"],[0.080782810450923032,"#FEEDD4"],[0.080942277629903525,"#FEEDD4"],[0.081049047367033153,"#FEEDD4"],[0.081203116436619829,"#FEEDD4"],[0.082285714285714268,"#FEEDD4"],[0.083717140854851393,"#FEEDD4"],[0.084078711985688739,"#FEEDD4"],[0.08498241441590336,"#FEECD3"],[0.085221247304772305,"#FEECD3"],[0.086912913237058229,"#FEECD3"],[0.087072610481563006,"#FEECD3"],[0.087339904034984386,"#FEECD3"],[0.088707322684184256,"#FEECD2"],[0.089094773641796091,"#FEECD2"],[0.08921389136751437,"#FEECD2"],[0.09004621157402766,"#FEECD2"],[0.090078137186146545,"#FEECD2"],[0.090878080950788448,"#FEECD2"],[0.091371740602565879,"#FEECD1"],[0.091546704998396081,"#FEECD1"],[0.092393819197013907,"#FEEBD1"],[0.092447947260380178,"#FEEBD1"],[0.092915033167957017,"#FEEBD1"],[0.093868718799829567,"#FEEBD0"],[0.094826196949597499,"#FEEBD0"],[0.096601073345259386,"#FEEBCF"],[0.096691105621969267,"#FEEBCF"],[0.096736020069355499,"#FEEBCF"],[0.097069030136058138,"#FEEBCF"],[0.097373890857683748,"#FEEBCF"],[0.098614179465805529,"#FEEBCF"],[0.098760617459853303,"#FEEBCF"],[0.099282851411770956,"#FEEBCF"],[0.099836646590041073,"#FEEBCF"],[0.10017889087656529,"#FEEACE"],[0.10084099414275502,"#FEEACE"],[0.10105325057126981,"#FEEACE"],[0.10142868877419317,"#FEEACE"],[0.10154386719251823,"#FEEACE"],[0.10196779964221825,"#FEEACE"],[0.10217034326930531,"#FEEACE"],[0.10269886987989449,"#FEEACE"],[0.10292004588984645,"#FEEACE"],[0.10299729177908765,"#FEEACE"],[0.10336862344245039,"#FEEACE"],[0.10349627970237618,"#FEEACE"],[0.1037567084078712,"#FEEACE"],[0.10377461740736472,"#FEEACE"],[0.10604486912098181,"#FEEACD"],[0.10628571428571426,"#FEEACD"],[0.10635124972070883,"#FEEACD"],[0.106857386316816,"#FEEACD"],[0.10720230658584121,"#FEEACD"],[0.10747565840715799,"#FEEACD"],[0.10748348841162515,"#FEEACD"],[0.10758879654892013,"#FEEACD"],[0.1079041946243951,"#FEE9CC"],[0.10837456356192555,"#FEE9CC"],[0.10863829423674318,"#FEE9CC"],[0.10912343470483005,"#FEE9CC"],[0.11165704817297789,"#FEE9CC"],[0.11199999367179615,"#FEE9CB"],[0.11227864789152543,"#FEE9CB"],[0.11279016129841833,"#FEE9CB"],[0.11279306126497468,"#FEE9CB"],[0.11295684741421189,"#FEE9CB"],[0.11360955289167886,"#FEE9CB"],[0.11428571428571427,"#FEE9CB"],[0.11495713794327614,"#FEE9CB"],[0.11522111586821313,"#FEE9CB"],[0.11542857142857138,"#FEE9CB"],[0.11627906976744186,"#FEE8CA"],[0.11638232444906192,"#FEE8CA"],[0.11707953740763224,"#FEE8CA"],[0.11726264252387537,"#FEE8CA"],[0.11745970034367056,"#FEE8CA"],[0.11754560417028599,"#FEE8CA"],[0.11771428571428569,"#FEE8CA"],[0.1180597941699079,"#FEE8CA"],[0.11813133050908761,"#FEE8CA"],[0.11986754632078633,"#FEE8C9"],[0.12018447481134759,"#FEE8C9"],[0.12164579606440072,"#FEE8C8"],[0.12192309679377641,"#FEE8C8"],[0.12255324822174556,"#FEE8C8"],[0.12279495656269339,"#FEE8C8"],[0.12323469330819319,"#FEE8C8"],[0.12604954941131291,"#FDE7C7"],[0.1264135985825986,"#FDE7C7"],[0.12662158353151201,"#FDE7C7"],[0.12687304546199699,"#FDE7C7"],[0.12740054577565871,"#FDE7C7"],[0.12745424622822593,"#FDE7C6"],[0.12748343096664841,"#FDE7C6"],[0.12832883863944272,"#FDE7C6"],[0.1294046798075183,"#FDE7C6"],[0.13060451028550901,"#FDE7C6"],[0.1306880046872467,"#FDE7C6"],[0.13237924865831843,"#FDE6C5"],[0.13335777793266157,"#FDE6C5"],[0.13397591208156528,"#FDE6C5"],[0.13416815742397137,"#FDE6C5"],[0.13445891581425914,"#FDE6C4"],[0.13554912434932628,"#FDE6C4"],[0.13595706618962433,"#FDE6C4"],[0.1363612493643345,"#FDE6C3"],[0.13643936848180949,"#FDE6C3"],[0.13845915076802973,"#FDE6C3"],[0.1388067780976793,"#FDE6C3"],[0.13902387154606555,"#FDE6C3"],[0.13953488372093026,"#FDE5C2"],[0.13976434335349769,"#FDE5C2"],[0.14006174283136627,"#FDE5C2"],[0.14035286851725115,"#FDE5C2"],[0.14096393564398682,"#FDE5C2"],[0.14158903695083561,"#FDE5C2"],[0.14161029773694628,"#FDE5C2"],[0.14232777220149995,"#FDE5C2"],[0.14252803145885518,"#FDE5C2"],[0.14311270125223613,"#FDE5C2"],[0.14321266681390907,"#FDE4C1"],[0.14405147375579103,"#FDE4C1"],[0.1446755750506841,"#FDE4C1"],[0.14473961267830648,"#FDE4C1"],[0.14481986684279247,"#FDE4C1"],[0.14490161001788909,"#FDE4C1"],[0.14514094560333246,"#FDE4C1"],[0.14633175021341618,"#FDE4C0"],[0.14669051878354203,"#FDE4C0"],[0.14675167259838842,"#FDE4C0"],[0.14694499829139993,"#FDE4C0"],[0.14694797675997015,"#FDE4C0"],[0.14707641603461233,"#FDE4C0"],[0.14792006967938195,"#FDE4C0"],[0.14847942754919502,"#FDE4BF"],[0.14882936089432608,"#FDE4BF"],[0.14889389931191316,"#FDE4BF"],[0.14912473857818614,"#FDE4BF"],[0.14977651258920269,"#FDE4BF"],[0.14996970896151129,"#FDE4BF"],[0.15005360115295621,"#FDE4BF"],[0.15018406084125493,"#FDE4BF"],[0.15115310437347296,"#FDE3BE"],[0.15153715749107535,"#FDE3BE"],[0.15212644043549534,"#FDE3BE"],[0.1524430680250107,"#FDE3BE"],[0.15265768989627235,"#FDE3BE"],[0.15339659017411586,"#FDE3BE"],[0.15384615384615402,"#FDE3BE"],[0.15391082275630169,"#FDE3BE"],[0.15412267441101113,"#FDE3BE"],[0.15433225059750857,"#FDE3BE"],[0.15464703193966595,"#FDE3BE"],[0.15469333564725737,"#FDE3BE"],[0.15525833012842233,"#FDE2BD"],[0.15529606399465676,"#FDE2BD"],[0.15563506261180679,"#FDE2BD"],[0.15657142857142853,"#FDE2BD"],[0.15703431490070538,"#FDE2BD"],[0.15732588507473846,"#FDE2BD"],[0.15751280934918768,"#FDE2BD"],[0.15765943192926959,"#FDE2BD"],[0.15835461836277223,"#FDE2BC"],[0.15854430541383488,"#FDE2BC"],[0.15876823339175153,"#FDE2BC"],[0.15957446808510642,"#FDE2BC"],[0.16040717440238186,"#FDE2BB"],[0.16114285714285712,"#FDE2BB"],[0.16117216117216138,"#FDE2BB"],[0.16254295819077461,"#FDE2BB"],[0.16275719966476773,"#FDE1BA"],[0.16278408107915848,"#FDE1BA"],[0.16330288564272613,"#FDE1BA"],[0.1645844987869865,"#FDE1BA"],[0.16465410749353812,"#FDE1BA"],[0.16524657947442006,"#FDE1BA"],[0.16526857220801361,"#FDE1BA"],[0.16553458066021401,"#FDE1BA"],[0.16661273162546053,"#FDE1BA"],[0.16684295896382159,"#FDE1B9"],[0.16753091013728064,"#FDE1B9"],[0.16758791788726565,"#FDE1B9"],[0.16789773282047937,"#FDE1B9"],[0.16791513765414567,"#FDE1B9"],[0.16812880166617419,"#FDE1B9"],[0.16927591083642438,"#FDE1B9"],[0.1693523685467922,"#FDE1B9"],[0.16955546416478037,"#FDE1B9"],[0.16968642333165923,"#FDE1B9"],[0.16994633273703041,"#FDE1B9"],[0.17082338225153185,"#FDE0B8"],[0.1718913961088985,"#FDE0B8"],[0.17244487737443384,"#FDE0B8"],[0.17245181371093735,"#FDE0B8"],[0.17317178419607004,"#FDE0B8"],[0.17351049572334989,"#FDE0B8"],[0.17352415026833631,"#FDE0B8"],[0.17395507196002177,"#FDE0B7"],[0.17485714285714285,"#FDDFB7"],[0.17512184061165198,"#FDDFB7"],[0.17531305903398928,"#FDDFB7"],[0.17575719571079199,"#FDDFB6"],[0.1757708586911271,"#FDDFB6"],[0.17942857142857138,"#FDDFB5"],[0.17979954592470651,"#FDDFB5"],[0.18000015114351639,"#FDDFB5"],[0.1800591022548011,"#FDDFB5"],[0.18057142857142855,"#FDDFB5"],[0.18067978533094814,"#FDDFB5"],[0.18068542083078595,"#FDDFB5"],[0.18122663991162927,"#FDDFB5"],[0.18198504070798466,"#FDDFB5"],[0.18218208537630162,"#FDDFB5"],[0.1822711107111859,"#FDDFB5"],[0.18246869409660108,"#FDDEB4"],[0.18292123067267069,"#FDDEB4"],[0.18315018315018297,"#FDDEB4"],[0.18315018315018336,"#FDDEB4"],[0.18453277670841206,"#FDDEB4"],[0.18485038640638146,"#FDDEB4"],[0.18514285714285711,"#FDDEB4"],[0.18551271613795503,"#FDDEB3"],[0.18566356487841432,"#FDDEB3"],[0.18604651162790695,"#FDDEB3"],[0.18628571428571428,"#FDDDB3"],[0.18710964744034717,"#FDDDB3"],[0.18720017814075782,"#FDDDB3"],[0.18783542039355994,"#FDDDB2"],[0.18838730306226706,"#FDDDB2"],[0.1885714285714285,"#FDDDB2"],[0.18918769420508585,"#FDDDB2"],[0.18962432915921287,"#FDDDB2"],[0.18974813375583122,"#FDDDB2"],[0.19007195207142236,"#FDDDB2"],[0.19195980118221859,"#FDDDB1"],[0.19350634959887922,"#FDDDB1"],[0.19428571428571426,"#FDDCB0"],[0.19469861418258191,"#FDDCB0"],[0.19499105545617174,"#FDDCB0"],[0.19538074232057093,"#FDDCB0"],[0.19645115927457163,"#FDDCB0"],[0.19657142857142854,"#FDDCB0"],[0.1967799642218247,"#FDDCB0"],[0.19771954319818658,"#FDDCAF"],[0.19791549193737581,"#FDDCAF"],[0.19808164141258736,"#FDDCAF"],[0.19810010009152035,"#FDDCAF"],[0.19828928089139874,"#FDDCAF"],[0.19845539475740684,"#FDDCAF"],[0.19856887298747763,"#FDDCAF"],[0.20035778175313057,"#FDDCAE"],[0.20074895887056207,"#FDDCAE"],[0.20099829400748176,"#FDDCAE"],[0.2011428571428571,"#FDDCAE"],[0.20122604770903363,"#FDDCAE"],[0.20142958934791388,"#FDDCAE"],[0.20143694664226958,"#FDDCAE"],[0.20149542111913019,"#FDDCAE"],[0.20171921783552729,"#FDDCAE"],[0.20212765957446807,"#FDDBAD"],[0.2033326760221234,"#FDDBAD"],[0.20365529805784258,"#FDDBAD"],[0.20380723906671794,"#FDDBAD"],[0.2038560184479391,"#FDDBAD"],[0.20444623779168403,"#FDDBAD"],[0.20458936871734495,"#FDDBAD"],[0.20479178558115266,"#FDDBAD"],[0.20571428571428568,"#FDDBAD"],[0.20706723584281927,"#FDDAAC"],[0.2075134168157424,"#FDDAAC"],[0.20891417038956522,"#FDDAAB"],[0.20905017751886831,"#FDDAAB"],[0.20930232558139533,"#FDDAAB"],[0.20958380032319252,"#FDDAAB"],[0.21022057338797173,"#FDDAAB"],[0.21043356373318547,"#FDDAAB"],[0.21121102145014478,"#FDDAAA"],[0.21142857142857138,"#FDDAAA"],[0.2118714627868174,"#FDDAAA"],[0.21223933437329262,"#FDDAAA"],[0.21257142857142852,"#FDDAAA"],[0.21263268363921423,"#FDDAAA"],[0.21276595744680854,"#FDDAAA"],[0.2144539713338309,"#FDD9A9"],[0.21466905187835422,"#FDD9A9"],[0.21670971905609376,"#FDD9A9"],[0.21800857434777737,"#FDD8A8"],[0.21824686940966009,"#FDD8A8"],[0.21828571428571422,"#FDD8A8"],[0.21932344470064474,"#FDD8A8"],[0.21942857142857139,"#FDD8A8"],[0.21969567525202657,"#FDD8A8"],[0.22041869332565708,"#FDD8A8"],[0.22186657734760926,"#FDD8A7"],[0.22285714285714281,"#FDD8A6"],[0.22290158698107279,"#FDD8A6"],[0.22294342970548536,"#FDD8A6"],[0.22325489673377286,"#FDD8A6"],[0.22367655409384182,"#FDD8A6"],[0.2255825272516617,"#FDD7A5"],[0.22628571428571426,"#FDD7A5"],[0.22636001125519611,"#FDD7A5"],[0.22697728996542493,"#FDD7A5"],[0.22742857142857137,"#FDD7A5"],[0.22811474905037821,"#FDD7A5"],[0.22864258806568732,"#FDD7A5"],[0.23062383875931092,"#FDD6A4"],[0.2311858610152315,"#FDD6A4"],[0.23129246158118003,"#FDD6A4"],[0.23239306285937883,"#FDD6A3"],[0.23309747749797094,"#FDD6A3"],[0.23428571428571424,"#FDD6A3"],[0.23549011624795546,"#FDD6A2"],[0.23555789028578972,"#FDD6A2"],[0.23657142857142852,"#FDD6A2"],[0.2367336473466706,"#FDD6A2"],[0.23675040501841979,"#FDD6A2"],[0.23799933900433379,"#FDD5A1"],[0.2389853824972758,"#FDD5A1"],[0.23913441169099728,"#FDD5A1"],[0.23936170212765961,"#FDD5A1"],[0.23939734618799094,"#FDD5A1"],[0.2394649930870632,"#FDD5A1"],[0.23971285328630423,"#FDD5A1"],[0.2399267399267396,"#FDD5A1"],[0.24062845554147927,"#FDD5A1"],[0.24069018272878873,"#FDD5A1"],[0.24150268336314848,"#FDD5A0"],[0.24169609582701909,"#FDD5A0"],[0.24190731988302899,"#FDD5A0"],[0.24209803965696131,"#FDD5A0"],[0.24248035111704186,"#FDD5A0"],[0.24402406757825459,"#FDD5A0"],[0.24507256971065702,"#FDD59F"],[0.24508050089445438,"#FDD59F"],[0.24747305793566882,"#FDD49E"],[0.24827753740086392,"#FDD49E"],[0.24878701879572254,"#FDD49E"],[0.24914285714285711,"#FDD39D"],[0.24953523186023974,"#FDD39D"],[0.24979033779332274,"#FDD39D"],[0.25028571428571428,"#FDD39D"],[0.25035592024029141,"#FDD39D"],[0.25044722719141327,"#FDD39D"],[0.25142857142857133,"#FDD39D"],[0.2525714285714285,"#FDD39D"],[0.25270827173490534,"#FDD39D"],[0.25310788154887798,"#FDD39C"],[0.25333906185104726,"#FDD39C"],[0.25360711090103838,"#FDD39C"],[0.25371428571428567,"#FDD39C"],[0.25402504472271914,"#FDD39C"],[0.25431671464799771,"#FDD39C"],[0.25485714285714284,"#FDD39C"],[0.25639715695563786,"#FDD39C"],[0.25664073741320759,"#FDD39C"],[0.25714285714285712,"#FDD29C"],[0.25752205150344004,"#FDD29C"],[0.25846803612396502,"#FDD29C"],[0.25868437988277226,"#FDD29C"],[0.25939177101967803,"#FDD29C"],[0.25941754194503475,"#FDD29C"],[0.25945206312052255,"#FDD29C"],[0.26118067978533099,"#FDD19B"],[0.26207513416815742,"#FDD19B"],[0.26285714285714279,"#FDD19B"],[0.2629695885509839,"#FDD19B"],[0.26399999999999996,"#FDD19B"],[0.26433853656191658,"#FDD19B"],[0.26471112652898005,"#FDD09A"],[0.26485889051370853,"#FDD09A"],[0.26537973140575016,"#FDD09A"],[0.26572527178809668,"#FDD09A"],[0.26628571428571424,"#FDD09A"],[0.26631341920811574,"#FDD09A"],[0.26654740608228977,"#FDD09A"],[0.26656705942724107,"#FDD09A"],[0.2672466952887888,"#FDD09A"],[0.26739926739926734,"#FDD09A"],[0.26747821517456749,"#FDD09A"],[0.26748380611904049,"#FDD09A"],[0.2698775585553202,"#FDCF99"],[0.27028571428571424,"#FDCF99"],[0.27085362241568173,"#FDCF99"],[0.27088103461342683,"#FDCF99"],[0.270916354674063,"#FDCF99"],[0.27092149956241518,"#FDCF99"],[0.27173044572262639,"#FDCF99"],[0.2723325127731076,"#FDCF99"],[0.27393351797442606,"#FDCF98"],[0.27428571428571424,"#FDCF98"],[0.27493178377995714,"#FDCF98"],[0.27659574468085107,"#FDCE98"],[0.27692189388416411,"#FDCE98"],[0.27805308805708817,"#FDCE98"],[0.27838827838827873,"#FDCE98"],[0.27871870316050618,"#FDCE98"],[0.27900984542195956,"#FDCE98"],[0.28045886193791303,"#FDCD97"],[0.2806481960543179,"#FDCD97"],[0.2818757185404353,"#FDCD97"],[0.28208831013548402,"#FDCD97"],[0.28216192978404797,"#FDCD97"],[0.28358013585598096,"#FDCD97"],[0.28393392297843434,"#FDCD97"],[0.28439903050669774,"#FDCC96"],[0.2846854575732739,"#FDCC96"],[0.28647082172140503,"#FDCC96"],[0.28656233768303585,"#FDCC96"],[0.2866746433763892,"#FDCC96"],[0.28723404255319157,"#FDCC96"],[0.2886727382084579,"#FDCB95"],[0.28941946213376035,"#FDCB95"],[0.29023951176506513,"#FDCB95"],[0.29047269173677326,"#FDCB95"],[0.2907260545089006,"#FDCB95"],[0.29224403324100034,"#FDCB94"],[0.29241184126233494,"#FDCB94"],[0.29255319148936176,"#FDCB94"],[0.29255645811232206,"#FDCB94"],[0.29371428571428565,"#FDCB94"],[0.29374096451994269,"#FDCB94"],[0.29420734761499578,"#FDCB94"],[0.29482834730647706,"#FDCB94"],[0.29485714285714282,"#FDCB94"],[0.29550307184878222,"#FDCB94"],[0.29599999999999993,"#FDCB94"],[0.29634093147828272,"#FDCA94"],[0.29713366831115995,"#FDCA94"],[0.29788424076738373,"#FDCA94"],[0.29874776386404295,"#FDCA94"],[0.29896063060590428,"#FDCA94"],[0.29938623391179142,"#FDCA94"],[0.29942857142857138,"#FDCA94"],[0.30101412724450932,"#FDC993"],[0.30169434601524003,"#FDC993"],[0.30301527637140141,"#FDC993"],[0.30371017383765203,"#FDC993"],[0.30470549293430949,"#FDC892"],[0.30632135420110468,"#FDC892"],[0.30751871549835474,"#FDC892"],[0.30851063829787234,"#FDC891"],[0.3085714285714285,"#FDC891"],[0.30971428571428566,"#FDC891"],[0.31030086068451213,"#FDC891"],[0.3113553113553113,"#FDC891"],[0.3123396443166967,"#FDC790"],[0.31252191929874368,"#FDC790"],[0.31305903398926654,"#FDC790"],[0.31307572703037773,"#FDC790"],[0.31337242526895842,"#FDC790"],[0.31382978723404265,"#FDC790"],[0.31389186504055194,"#FDC790"],[0.31501831501831501,"#FDC790"],[0.3155144703839009,"#FDC790"],[0.31561720711718233,"#FDC790"],[0.31609393720559181,"#FDC68F"],[0.31651766795478525,"#FDC68F"],[0.31663685152057247,"#FDC68F"],[0.31673598198977249,"#FDC68F"],[0.31771428571428567,"#FDC68F"],[0.31810754857589185,"#FDC68F"],[0.31856694990549311,"#FDC68F"],[0.31868131868131866,"#FDC68F"],[0.31970167384432685,"#FDC58F"],[0.31999999999999995,"#FDC58F"],[0.32077662938126972,"#FDC58F"],[0.3208278236493276,"#FDC58F"],[0.32114285714285706,"#FDC58F"],[0.32200357781753131,"#FDC58F"],[0.32202650158901247,"#FDC58F"],[0.32342837252375994,"#FDC58F"],[0.32387677582766206,"#FDC48E"],[0.32439755749351512,"#FDC48E"],[0.32446808510638303,"#FDC48E"],[0.32462390759022886,"#FDC48E"],[0.32558139534883723,"#FDC48E"],[0.32558139534883729,"#FDC48E"],[0.32595482471109738,"#FDC48E"],[0.32628571428571423,"#FDC48E"],[0.32654871054777163,"#FDC48E"],[0.32737122007916508,"#FDC48E"],[0.32750752284640949,"#FDC48D"],[0.32904433435430525,"#FDC48D"],[0.32978723404255322,"#FDC48D"],[0.33012232729656255,"#FDC48D"],[0.33068524748234007,"#FDC48D"],[0.33188270596540775,"#FDC38C"],[0.33205564477520799,"#FDC38C"],[0.33273703041144903,"#FDC38C"],[0.33384612036087352,"#FDC38C"],[0.33552252764493756,"#FDC28B"],[0.33574562376892086,"#FDC28B"],[0.33678942603108591,"#FDC28B"],[0.33699633699633702,"#FDC28B"],[0.33754920031351593,"#FDC28B"],[0.33918148001914789,"#FDC28B"],[0.34038066392015093,"#FDC18B"],[0.34066701572468083,"#FDC18B"],[0.34168157423971379,"#FDC18B"],[0.34291674133148564,"#FDC18B"],[0.34514285714285708,"#FDC08A"],[0.34574468085106386,"#FDC08A"],[0.34628571428571425,"#FDC08A"],[0.34666570696106314,"#FDC08A"],[0.34869901737573383,"#FDC089"],[0.34947867747607897,"#FDC089"],[0.35106382978723405,"#FDBF88"],[0.35164835164835168,"#FDBF88"],[0.35374983215645284,"#FDBF88"],[0.35429313278127872,"#FDBF88"],[0.35498225610438705,"#FDBE87"],[0.35507749460799687,"#FDBE87"],[0.3563829787234043,"#FDBE87"],[0.35717102914119503,"#FDBE87"],[0.35826135891885397,"#FDBE87"],[0.35897435897435903,"#FDBD86"],[0.35957066189624332,"#FDBD86"],[0.36096965609682069,"#FDBD86"],[0.36114285714285704,"#FDBD86"],[0.36121442498314327,"#FDBD86"],[0.36263448389888064,"#FDBD86"],[0.36272981436909196,"#FDBD86"],[0.36298855878622049,"#FDBD86"],[0.36521728570951689,"#FDBD86"],[0.36559575234894182,"#FDBD86"],[0.36678351169236084,"#FDBC85"],[0.36685714285714283,"#FDBC85"],[0.36692317550391201,"#FDBC85"],[0.36702127659574474,"#FDBC85"],[0.36799995062427815,"#FDBC85"],[0.36799999999999999,"#FDBC85"],[0.36851520572450808,"#FDBC85"],[0.37209302325581395,"#FDBB84"],[0.37234042553191493,"#FDBB84"],[0.37362637362637369,"#FDBB84"],[0.37446468584470438,"#FDBB84"],[0.37503872651356923,"#FCBA83"],[0.37586731963749315,"#FCBA83"],[0.3761535443154676,"#FCBA83"],[0.37626437169299959,"#FCBA83"],[0.37721915762469072,"#FCBA83"],[0.37765957446808512,"#FCBA83"],[0.38095238095238099,"#FCB982"],[0.3822885998842715,"#FCB881"],[0.38285714285714278,"#FCB881"],[0.38461538461538469,"#FCB780"],[0.38500199470204677,"#FCB780"],[0.3858309624837794,"#FCB780"],[0.38601094450203638,"#FCB780"],[0.3864042933810376,"#FCB67F"],[0.38804360511004676,"#FCB67F"],[0.38820998482882108,"#FCB67F"],[0.39034729074830171,"#FCB57E"],[0.39194139194139199,"#FCB47E"],[0.39281226443481487,"#FCB47E"],[0.39361702127659581,"#FCB47D"],[0.39416263540828073,"#FCB37D"],[0.395370117379099,"#FCB37C"],[0.39542857142857141,"#FCB37C"],[0.3956043956043957,"#FCB37C"],[0.39596358713220775,"#FCB37C"],[0.39617064868516244,"#FCB37C"],[0.39673082553685823,"#FCB37C"],[0.39885714285714285,"#FCB27B"],[0.39892665474060818,"#FCB27B"],[0.39892665474060823,"#FCB27B"],[0.39893617021276601,"#FCB27B"],[0.39964147533232286,"#FCB17B"],[0.40006628974232294,"#FCB17B"],[0.40128204251081601,"#FCB17B"],[0.40166176158876937,"#FCB17B"],[0.40228571428571425,"#FCB07A"],[0.40254352164971491,"#FCB07A"],[0.40366483704638306,"#FCB07A"],[0.40571428571428564,"#FCAF79"],[0.40618772045192264,"#FCAF79"],[0.40685714285714286,"#FCAF79"],[0.4077777878069937,"#FCAE78"],[0.40820621843971899,"#FCAE78"],[0.40896328731034054,"#FCAE78"],[0.40957446808510639,"#FCAE78"],[0.41015362940866879,"#FCAD77"],[0.4102811346496017,"#FCAD77"],[0.41089592958170174,"#FCAD77"],[0.4122725487166719,"#FCAD77"],[0.41323792486583188,"#FCAD77"],[0.41435505213809909,"#FCAC76"],[0.41489361702127658,"#FCAC76"],[0.41567133573939935,"#FCAC76"],[0.41599999999999998,"#FCAC76"],[0.41646173770989114,"#FCAC76"],[0.41679935063406803,"#FCAB75"],[0.41714285714285709,"#FCAB75"],[0.41763237106522177,"#FCAB75"],[0.42285714285714276,"#FCA973"],[0.42553191489361708,"#FCA872"],[0.42651180099838937,"#FCA771"],[0.43058637002209599,"#FCA670"],[0.43161825920257862,"#FCA670"],[0.43195968270839646,"#FCA670"],[0.4329069540610736,"#FCA570"],[0.43291592128801437,"#FCA570"],[0.43424061342955927,"#FCA56F"],[0.43470483005366722,"#FCA46F"],[0.4349176842441807,"#FCA46F"],[0.43617021276595747,"#FCA46F"],[0.43637746190237908,"#FCA46E"],[0.43768107479246016,"#FCA36E"],[0.43900610772871046,"#FCA36D"],[0.43905289842739859,"#FCA36D"],[0.43999999999999995,"#FCA36D"],[0.44037486224159611,"#FCA26D"],[0.44078947096821225,"#FCA26D"],[0.44186046511627908,"#FCA26C"],[0.4427405740489555,"#FCA16C"],[0.44313103368961682,"#FCA16C"],[0.44322344322344337,"#FCA16C"],[0.44342857142857139,"#FCA16C"],[0.44603922330048956,"#FCA06B"],[0.44680851063829796,"#FCA06B"],[0.44700787420326643,"#FCA06B"],[0.44772183629407081,"#FCA06B"],[0.44815476436490959,"#FCA06A"],[0.45249442797989187,"#FC9E69"],[0.45463101116239635,"#FC9D68"],[0.45514561996933017,"#FC9D68"],[0.45617173524150267,"#FC9D68"],[0.45666300844751678,"#FC9D68"],[0.45733169146163627,"#FC9C67"],[0.45787545787545803,"#FC9C67"],[0.45894730448473348,"#FC9C67"],[0.46048719946029076,"#FC9B66"],[0.46057142857142847,"#FC9B66"],[0.4611040662046364,"#FC9B66"],[0.46276595744680854,"#FC9A65"],[0.46385256470833475,"#FC9A65"],[0.46413037030083981,"#FC9A65"],[0.46520146520146538,"#FC9964"],[0.46621156136973946,"#FC9964"],[0.46755757733415848,"#FC9964"],[0.46808510638297873,"#FC9864"],[0.4701362520123914,"#FC9763"],[0.47076683499317762,"#FC9763"],[0.47143027570835805,"#FC9763"],[0.47172241276208238,"#FC9762"],[0.47213350952206734,"#FC9762"],[0.47252747252747268,"#FC9762"],[0.47340425531914904,"#FC9662"],[0.47508582958946433,"#FC9661"],[0.47539605618889363,"#FC9661"],[0.47872340425531923,"#FC9460"],[0.47997292231507799,"#FC9460"],[0.48041525320577755,"#FC935F"],[0.48046451063201734,"#FC935F"],[0.48047767511272393,"#FC935F"],[0.48342857142857132,"#FC935E"],[0.4835164835164833,"#FC935E"],[0.48571428571428565,"#FC925D"],[0.48699634905495409,"#FC925D"],[0.48717948717948739,"#FC925D"],[0.48760847138888275,"#FC915D"],[0.4891428571428571,"#FC915C"],[0.48929595226758893,"#FC905C"],[0.48936170212765961,"#FC905C"],[0.49084249084249104,"#FC905C"],[0.49094478216818649,"#FC905C"],[0.49236806066387157,"#FC8F5B"],[0.49267399267399264,"#FC8F5B"],[0.49542861788889259,"#FC8E5A"],[0.49575719619256481,"#FC8E5A"],[0.49738787816558,"#FC8D59"],[0.4981684981684984,"#FC8D59"],[0.49828571428571422,"#FC8D59"],[0.4989015850429146,"#FC8D59"],[0.49951964516531649,"#FC8D59"],[0.50000000000000011,"#FB8C58"],[0.5012724888932385,"#FB8C58"],[0.50183150183150205,"#FB8C58"],[0.5026833631484795,"#FB8C58"],[0.50275766005772671,"#FB8C58"],[0.50302214661232469,"#FB8C58"],[0.50392935321812093,"#FB8B58"],[0.50406002833641539,"#FB8B58"],[0.50498654301834633,"#FB8B58"],[0.50528296694583197,"#FB8B58"],[0.5060869166442642,"#FB8B58"],[0.50827659440043982,"#FA8A57"],[0.5089024428962563,"#FA8957"],[0.50894716078884572,"#FA8957"],[0.5106382978723405,"#FA8957"],[0.51093652149068258,"#FA8957"],[0.51317778438954531,"#FA8857"],[0.51341681574239717,"#FA8857"],[0.51401739854979833,"#FA8857"],[0.51595744680851063,"#FA8756"],[0.51622707335190043,"#FA8756"],[0.51673458720172794,"#FA8756"],[0.51718980266819337,"#FA8756"],[0.5185071227863518,"#FA8756"],[0.52014652014651996,"#F98656"],[0.52014652014652041,"#F98656"],[0.52127659574468088,"#F98656"],[0.52246501924270627,"#F98656"],[0.52415026833631484,"#F98555"],[0.5247175261159045,"#F98455"],[0.52480187231236619,"#F98455"],[0.5259391771019678,"#F98455"],[0.53088832933803076,"#F88355"],[0.53191489361702138,"#F88254"],[0.53257142857142858,"#F88254"],[0.53714285714285703,"#F88153"],[0.53723404255319152,"#F88153"],[0.53766398272298555,"#F88153"],[0.53846153846153866,"#F88053"],[0.54255319148936176,"#F77F53"],[0.54381629708579615,"#F77E52"],[0.54773242010458922,"#F67D52"],[0.5478723404255319,"#F67D52"],[0.54933242279252203,"#F67D52"],[0.54945054945054927,"#F67D52"],[0.55119592875411061,"#F67C51"],[0.55254427563332786,"#F67C51"],[0.55319148936170226,"#F67C51"],[0.553678508322621,"#F67C51"],[0.5585106382978724,"#F67A51"],[0.55868978854765039,"#F67A51"],[0.56228571428571428,"#F57950"],[0.56662177152328352,"#F57850"],[0.56776556776556808,"#F4774F"],[0.56830070312500536,"#F4774F"],[0.56887298747763859,"#F4774F"],[0.57106842045633766,"#F4764F"],[0.57398923047156902,"#F4754F"],[0.57400155807509279,"#F4754F"],[0.57446808510638303,"#F4754F"],[0.57446808510638314,"#F4754F"],[0.57472704615871784,"#F4744E"],[0.57509624892694,"#F4744E"],[0.57595555089993222,"#F4744E"],[0.5787545787545787,"#F3734E"],[0.58084127571078936,"#F3734E"],[0.58241758241758268,"#F3724D"],[0.58274047320186084,"#F3724D"],[0.58285714285714274,"#F3724D"],[0.58309569394042715,"#F3724D"],[0.58408252067706967,"#F3724D"],[0.58490939300619171,"#F3724D"],[0.58555699960094354,"#F3714D"],[0.58773352663887846,"#F2704D"],[0.58933812154699972,"#F2704D"],[0.58974358974359009,"#F2704D"],[0.59042553191489366,"#F26F4C"],[0.59245913667574446,"#F26F4C"],[0.59547777104033461,"#F26E4B"],[0.60106382978723405,"#F16C4B"],[0.60263395327412828,"#F16C4A"],[0.60325406849318286,"#F16B4A"],[0.60439560439560469,"#F16B4A"],[0.60544494206924537,"#F16B4A"],[0.60606044108939561,"#F06A4A"],[0.60799999999999998,"#F06A4A"],[0.61012816993188723,"#F06949"],[0.61164672402699272,"#F06949"],[0.6124422199290418,"#F06949"],[0.61284330709239809,"#F06849"],[0.61352117887155921,"#F06849"],[0.61702127659574479,"#EF6749"],[0.61751475064449568,"#EF6749"],[0.61952415836843289,"#EF6648"],[0.62057142857142844,"#EF6648"],[0.62108116642367672,"#EF6648"],[0.62207823440161081,"#EF6548"],[0.62488500794795232,"#EF6448"],[0.62606229096158805,"#EE6447"],[0.6263736263736267,"#EE6447"],[0.62765957446808518,"#EE6347"],[0.63003663003663002,"#ED6246"],[0.64468864468864462,"#EB5C41"],[0.64630908192500613,"#EA5B40"],[0.64835164835164871,"#EA5A40"],[0.64893617021276606,"#EA5A40"],[0.649016584505829,"#EA5A40"],[0.65201465201465203,"#EA593F"],[0.65618946563205138,"#E9573D"],[0.65957446808510645,"#E8563C"],[0.66096294355490515,"#E7553B"],[0.66300366300366298,"#E7543B"],[0.66462166520280852,"#E7543B"],[0.66489361702127658,"#E7533A"],[0.67021276595744694,"#E65139"],[0.67304108478307556,"#E55038"],[0.67399267399267404,"#E55037"],[0.68498168498168499,"#E34B34"],[0.68603858066213264,"#E34B33"],[0.68864468864468864,"#E24A32"],[0.69121604979256945,"#E24832"],[0.69148936170212771,"#E24832"],[0.6916075802180961,"#E24832"],[0.69445638828782041,"#E14731"],[0.69450640121234331,"#E14731"],[0.69528926894533227,"#E14731"],[0.69579311396922972,"#E14731"],[0.69597069597069605,"#E14731"],[0.69680851063829796,"#E04630"],[0.70744680851063835,"#DF422D"],[0.7142857142857143,"#DD3F2A"],[0.71687207474470283,"#DD3D29"],[0.71755696886016473,"#DD3D29"],[0.71794871794871806,"#DD3D29"],[0.71881526232525406,"#DD3D29"],[0.72075953384784042,"#DC3C28"],[0.72161172161172171,"#DC3C28"],[0.72597827932822312,"#DB3A27"],[0.73005803173851502,"#DA3825"],[0.73115965141043593,"#DA3825"],[0.73142353624895173,"#DA3724"],[0.73354731102044102,"#DA3724"],[0.733624026047483,"#DA3724"],[0.73626373626373631,"#D93623"],[0.73763885508941252,"#D93523"],[0.73992673992673996,"#D83422"],[0.74557749524143502,"#D73220"],[0.75091575091575102,"#D72F1F"],[0.75824175824175832,"#D42C1D"],[0.76190476190476197,"#D32B1C"],[0.76532330661229175,"#D22A1B"],[0.76556776556776573,"#D22A1B"],[0.76907604766610116,"#D1281A"],[0.77041317327228276,"#D1281A"],[0.77655677655677668,"#CF2518"],[0.78021978021978033,"#CE2417"],[0.78260918354728481,"#CD2316"],[0.78388278388278398,"#CD2216"],[0.78754578754578775,"#CB2115"],[0.78907727985407028,"#CB2115"],[0.7912087912087914,"#CA1F14"],[0.79248658318425758,"#CA1F14"],[0.79255319148936187,"#CA1F14"],[0.79727173386613215,"#C91D13"],[0.7978723404255319,"#C91D13"],[0.7985347985347987,"#C81D12"],[0.80168953346099314,"#C81C12"],[0.80219780219780235,"#C71B11"],[0.80319148936170226,"#C71B11"],[0.81382978723404265,"#C4170E"],[0.81523596492860806,"#C4160E"],[0.82417582417582436,"#C1130C"],[0.8266098785513798,"#C0120B"],[0.8342857142857143,"#BE0F09"],[0.8372682407692571,"#BD0E08"],[0.83882783882783907,"#BD0D08"],[0.84249084249084272,"#BC0C07"],[0.85122989064927868,"#B90905"],[0.85317867907676714,"#B80804"],[0.86446886446886473,"#B60403"],[0.86702127659574468,"#B50302"],[0.86813186813186838,"#B50202"],[0.86829141098936991,"#B50202"],[0.87179487179487203,"#B40101"],[0.87234042553191493,"#B40101"],[0.88019350862064416,"#B00000"],[0.88566870379938956,"#AE0000"],[0.89299387788644891,"#AB0000"],[0.89377289377289404,"#AB0000"],[0.89639064021952564,"#AA0000"],[0.90651993209477832,"#A60000"],[0.91350218880394374,"#A20000"],[0.91575091575091605,"#A10000"],[0.92078352211033243,"#9F0000"],[0.92673992673992711,"#9D0000"],[0.93297010491514876,"#9A0000"],[0.93300547845739901,"#9A0000"],[0.93780810589254171,"#990000"],[0.94399431885772145,"#960000"],[0.94882300796034347,"#940000"],[0.95238095238095277,"#920000"],[0.95683286840586879,"#900000"],[0.97027962876114837,"#8B0000"],[0.97435897435897478,"#890000"],[0.99847406588198928,"#7F0000"],[0.99926437467876328,"#7F0000"],[1,"#7F0000"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"604f4e42ba59829011d8398328bc49a2","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FFF7EC"],[0.0033444816053511705,"#FEF6EA"],[0.006688963210702341,"#FEF6E9"],[0.010033444816053512,"#FEF5E8"],[0.013377926421404682,"#FEF5E8"],[0.016722408026755852,"#FEF5E7"],[0.020066889632107024,"#FEF4E6"],[0.023411371237458192,"#FEF4E5"],[0.026755852842809364,"#FEF3E4"],[0.030100334448160536,"#FEF3E3"],[0.033444816053511704,"#FEF2E1"],[0.036789297658862873,"#FEF2E1"],[0.040133779264214048,"#FEF2E0"],[0.043478260869565216,"#FEF1DF"],[0.046822742474916385,"#FEF1DE"],[0.05016722408026756,"#FEF0DD"],[0.053511705685618728,"#FEF0DC"],[0.056856187290969896,"#FEF0DC"],[0.060200668896321072,"#FEEFDA"],[0.06354515050167224,"#FEEFD9"],[0.066889632107023408,"#FEEFD8"],[0.070234113712374577,"#FEEED7"],[0.073578595317725745,"#FEEED6"],[0.076923076923076927,"#FEEDD5"],[0.080267558528428096,"#FEEDD5"],[0.083612040133779264,"#FEEDD4"],[0.086956521739130432,"#FEECD3"],[0.090301003344481601,"#FEECD2"],[0.093645484949832769,"#FEEBD0"],[0.096989966555183951,"#FEEBCF"],[0.10033444816053512,"#FEEACE"],[0.10367892976588629,"#FEEACE"],[0.10702341137123746,"#FEEACD"],[0.11036789297658862,"#FEE9CC"],[0.11371237458193979,"#FEE9CB"],[0.11705685618729096,"#FEE8CA"],[0.12040133779264214,"#FEE8C9"],[0.12374581939799331,"#FDE7C7"],[0.12709030100334448,"#FDE7C7"],[0.13043478260869565,"#FDE7C6"],[0.13377926421404682,"#FDE6C5"],[0.13712374581939799,"#FDE6C3"],[0.14046822742474915,"#FDE5C2"],[0.14381270903010032,"#FDE4C1"],[0.14715719063545149,"#FDE4C0"],[0.15050167224080269,"#FDE4BF"],[0.15384615384615385,"#FDE3BE"],[0.15719063545150502,"#FDE2BD"],[0.16053511705685619,"#FDE2BB"],[0.16387959866220736,"#FDE1BA"],[0.16722408026755853,"#FDE1B9"],[0.1705685618729097,"#FDE1B9"],[0.17391304347826086,"#FDE0B7"],[0.17725752508361203,"#FDDFB6"],[0.1806020066889632,"#FDDFB5"],[0.18394648829431437,"#FDDEB4"],[0.18729096989966554,"#FDDDB2"],[0.19063545150501671,"#FDDDB1"],[0.1939799331103679,"#FDDDB1"],[0.19732441471571907,"#FDDCAF"],[0.20066889632107024,"#FDDCAE"],[0.20401337792642141,"#FDDBAD"],[0.20735785953177258,"#FDDAAC"],[0.21070234113712374,"#FDDAAB"],[0.21404682274247491,"#FDD9A9"],[0.21739130434782608,"#FDD9A9"],[0.22073578595317725,"#FDD8A7"],[0.22408026755852842,"#FDD8A6"],[0.22742474916387959,"#FDD7A5"],[0.23076923076923075,"#FDD6A4"],[0.23411371237458192,"#FDD6A3"],[0.23745819397993312,"#FDD5A1"],[0.24080267558528429,"#FDD5A1"],[0.24414715719063546,"#FDD59F"],[0.24749163879598662,"#FDD49E"],[0.25083612040133779,"#FDD39D"],[0.25418060200668896,"#FDD39C"],[0.25752508361204013,"#FDD29C"],[0.2608695652173913,"#FDD19B"],[0.26421404682274247,"#FDD19B"],[0.26755852842809363,"#FDD09A"],[0.2709030100334448,"#FDCF99"],[0.27424749163879597,"#FDCF98"],[0.27759197324414714,"#FDCE98"],[0.28093645484949831,"#FDCD97"],[0.28428093645484948,"#FDCD97"],[0.28762541806020064,"#FDCC96"],[0.29096989966555181,"#FDCB95"],[0.29431438127090298,"#FDCB94"],[0.29765886287625415,"#FDCA94"],[0.30100334448160537,"#FDC993"],[0.30434782608695654,"#FDC892"],[0.30769230769230771,"#FDC892"],[0.31103678929765888,"#FDC891"],[0.31438127090301005,"#FDC790"],[0.31772575250836121,"#FDC68F"],[0.32107023411371238,"#FDC58F"],[0.32441471571906355,"#FDC48E"],[0.32775919732441472,"#FDC48D"],[0.33110367892976589,"#FDC48D"],[0.33444816053511706,"#FDC38C"],[0.33779264214046822,"#FDC28B"],[0.34113712374581939,"#FDC18B"],[0.34448160535117056,"#FDC08A"],[0.34782608695652173,"#FDC089"],[0.3511705685618729,"#FDBF88"],[0.35451505016722407,"#FDBF88"],[0.35785953177257523,"#FDBE87"],[0.3612040133779264,"#FDBD86"],[0.36454849498327757,"#FDBD86"],[0.36789297658862874,"#FDBC85"],[0.37123745819397991,"#FDBB84"],[0.37458193979933108,"#FCBA83"],[0.37792642140468224,"#FCBA83"],[0.38127090301003341,"#FCB982"],[0.38461538461538458,"#FCB780"],[0.38795986622073581,"#FCB67F"],[0.39130434782608697,"#FCB47E"],[0.39464882943143814,"#FCB37D"],[0.39799331103678931,"#FCB27C"],[0.40133779264214048,"#FCB17B"],[0.40468227424749165,"#FCB07A"],[0.40802675585284282,"#FCAE78"],[0.41137123745819398,"#FCAD77"],[0.41471571906354515,"#FCAC76"],[0.41806020066889632,"#FCAB75"],[0.42140468227424749,"#FCAA74"],[0.42474916387959866,"#FCA872"],[0.42809364548494983,"#FCA771"],[0.43143812709030099,"#FCA670"],[0.43478260869565216,"#FCA46F"],[0.43812709030100333,"#FCA36E"],[0.4414715719063545,"#FCA26C"],[0.44481605351170567,"#FCA16C"],[0.44816053511705684,"#FCA06A"],[0.451505016722408,"#FC9F69"],[0.45484949832775917,"#FC9D68"],[0.45819397993311034,"#FC9C67"],[0.46153846153846151,"#FC9B66"],[0.46488294314381268,"#FC9964"],[0.46822742474916385,"#FC9864"],[0.47157190635451507,"#FC9762"],[0.47491638795986624,"#FC9661"],[0.47826086956521741,"#FC9460"],[0.48160535117056857,"#FC935F"],[0.48494983277591974,"#FC925E"],[0.48829431438127091,"#FC915C"],[0.49163879598662208,"#FC905C"],[0.49498327759197325,"#FC8F5B"],[0.49832775919732442,"#FC8D59"],[0.50167224080267558,"#FB8C58"],[0.50501672240802675,"#FB8B58"],[0.50836120401337792,"#FA8A57"],[0.51170568561872909,"#FA8957"],[0.51505016722408026,"#FA8857"],[0.51839464882943143,"#FA8756"],[0.52173913043478259,"#F98656"],[0.52508361204013376,"#F98455"],[0.52842809364548493,"#F88355"],[0.5317725752508361,"#F88254"],[0.53511705685618727,"#F88254"],[0.53846153846153844,"#F88053"],[0.5418060200668896,"#F77F53"],[0.54515050167224077,"#F77E52"],[0.54849498327759194,"#F67D52"],[0.55183946488294311,"#F67C51"],[0.55518394648829428,"#F67B51"],[0.55852842809364545,"#F67A51"],[0.56187290969899661,"#F57950"],[0.56521739130434778,"#F57850"],[0.56856187290969895,"#F4774F"],[0.57190635451505012,"#F4754F"],[0.57525083612040129,"#F4744E"],[0.57859531772575246,"#F3734E"],[0.58193979933110362,"#F3734E"],[0.58528428093645479,"#F3724D"],[0.58862876254180596,"#F2704D"],[0.59197324414715713,"#F26F4C"],[0.5953177257525083,"#F26E4B"],[0.59866220735785947,"#F16D4B"],[0.60200668896321075,"#F16C4A"],[0.60535117056856191,"#F16B4A"],[0.60869565217391308,"#F06A4A"],[0.61204013377926425,"#F06949"],[0.61538461538461542,"#EF6749"],[0.61872909698996659,"#EF6648"],[0.62207357859531776,"#EF6548"],[0.62541806020066892,"#EF6448"],[0.62876254180602009,"#EE6346"],[0.63210702341137126,"#ED6245"],[0.63545150501672243,"#ED6044"],[0.6387959866220736,"#EC5E43"],[0.64214046822742477,"#EB5D42"],[0.64548494983277593,"#EA5C41"],[0.6488294314381271,"#EA5A40"],[0.65217391304347827,"#EA593F"],[0.65551839464882944,"#E9583E"],[0.65886287625418061,"#E8563C"],[0.66220735785953178,"#E7543B"],[0.66555183946488294,"#E7533A"],[0.66889632107023411,"#E65239"],[0.67224080267558528,"#E65138"],[0.67558528428093645,"#E54F37"],[0.67892976588628762,"#E44E36"],[0.68227424749163879,"#E34C35"],[0.68561872909698995,"#E34B33"],[0.68896321070234112,"#E24A32"],[0.69230769230769229,"#E14831"],[0.69565217391304346,"#E14731"],[0.69899665551839463,"#E04630"],[0.7023411371237458,"#E0442E"],[0.70568561872909696,"#DF422D"],[0.70903010033444813,"#DE412C"],[0.7123745819397993,"#DD402B"],[0.71571906354515047,"#DD3E29"],[0.71906354515050164,"#DD3D29"],[0.72240802675585281,"#DC3C28"],[0.72575250836120397,"#DB3A27"],[0.72909698996655514,"#DA3825"],[0.73244147157190631,"#DA3724"],[0.73578595317725748,"#D93623"],[0.73913043478260865,"#D93422"],[0.74247491638795982,"#D83321"],[0.74581939799331098,"#D73220"],[0.74916387959866215,"#D7301F"],[0.75250836120401332,"#D62E1E"],[0.75585284280936449,"#D52D1D"],[0.75919732441471566,"#D42C1C"],[0.76254180602006683,"#D32B1C"],[0.76588628762541799,"#D2291B"],[0.76923076923076916,"#D1281A"],[0.77257525083612044,"#D02719"],[0.77591973244147161,"#CF2518"],[0.77926421404682278,"#CE2417"],[0.78260869565217395,"#CD2316"],[0.78595317725752512,"#CC2216"],[0.78929765886287628,"#CB2015"],[0.79264214046822745,"#CA1F14"],[0.79598662207357862,"#C91E13"],[0.79933110367892979,"#C81C12"],[0.80267558528428096,"#C71B11"],[0.80602006688963213,"#C61A10"],[0.80936454849498329,"#C61910"],[0.81270903010033446,"#C5180F"],[0.81605351170568563,"#C4160E"],[0.8193979933110368,"#C2150D"],[0.82274247491638797,"#C1130C"],[0.82608695652173914,"#C0120B"],[0.8294314381270903,"#BF110A"],[0.83277591973244147,"#BF100A"],[0.83612040133779264,"#BE0F09"],[0.83946488294314381,"#BD0D08"],[0.84280936454849498,"#BC0C07"],[0.84615384615384615,"#BB0A06"],[0.84949832775919731,"#BA0905"],[0.85284280936454848,"#B90805"],[0.85618729096989965,"#B80704"],[0.85953177257525082,"#B70604"],[0.86287625418060199,"#B60403"],[0.86622073578595316,"#B50302"],[0.86956521739130432,"#B40201"],[0.87290969899665549,"#B30000"],[0.87625418060200666,"#B20000"],[0.87959866220735783,"#B00000"],[0.882943143812709,"#AF0000"],[0.88628762541806017,"#AE0000"],[0.88963210702341133,"#AC0000"],[0.8929765886287625,"#AB0000"],[0.89632107023411367,"#AA0000"],[0.89966555183946484,"#A80000"],[0.90301003344481601,"#A70000"],[0.90635451505016718,"#A60000"],[0.90969899665551834,"#A40000"],[0.91304347826086951,"#A20000"],[0.91638795986622068,"#A10000"],[0.91973244147157185,"#A00000"],[0.92307692307692302,"#9E0000"],[0.92642140468227419,"#9D0000"],[0.92976588628762535,"#9C0000"],[0.93311036789297652,"#9A0000"],[0.93645484949832769,"#990000"],[0.93979933110367886,"#980000"],[0.94314381270903014,"#960000"],[0.94648829431438131,"#950000"],[0.94983277591973247,"#940000"],[0.95317725752508364,"#920000"],[0.95652173913043481,"#900000"],[0.95986622073578598,"#8F0000"],[0.96321070234113715,"#8E0000"],[0.96655518394648832,"#8D0000"],[0.96989966555183948,"#8B0000"],[0.97324414715719065,"#8A0000"],[0.97658862876254182,"#880000"],[0.97993311036789299,"#870000"],[0.98327759197324416,"#860000"],[0.98662207357859533,"#840000"],[0.98996655518394649,"#830000"],[0.99331103678929766,"#810000"],[0.99665551839464883,"#800000"],[1,"#7F0000"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0.0016666666666666668,0.2508333333333333,0.49999999999999994,0.74916666666666665,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.2181822160277491,1.2181822160277491,null,1.2181822160277491,1.0342536452765183,null,1.0342536452765183,1.0342536452765183,null,1.0342536452765183,0.69377291826413456,null,0.69377291826413456,0.69377291826413456,null,0.69377291826413456,0.64607336259032067,null,0.64607336259032067,0.64607336259032067,null,0.64607336259032067,0.35392444092115849,null,0.35392444092115849,0.35392444092115849,null,0.35392444092115849,0.31773513414092658,null,0.31773513414092658,0.31773513414092658,null,0.31773513414092658,0,null,0.31773513414092658,0.31773513414092658,null,0.31773513414092658,0,null,0.35392444092115849,0.35392444092115849,null,0.35392444092115849,0,null,0.64607336259032067,0.64607336259032067,null,0.64607336259032067,0,null,0.69377291826413456,0.69377291826413456,null,0.69377291826413456,0,null,1.0342536452765183,1.0342536452765183,null,1.0342536452765183,0.93103446975374038,null,0.93103446975374038,0.93103446975374038,null,0.93103446975374038,0.83374050998552174,null,0.83374050998552174,0.83374050998552174,null,0.83374050998552174,0.67573252208718881,null,0.67573252208718881,0.67573252208718881,null,0.67573252208718881,0.60692148535945556,null,0.60692148535945556,0.60692148535945556,null,0.60692148535945556,0.43076882868284561,null,0.43076882868284561,0.43076882868284561,null,0.43076882868284561,0.31466301223402532,null,0.31466301223402532,0.31466301223402532,null,0.31466301223402532,0,null,0.31466301223402532,0.31466301223402532,null,0.31466301223402532,0,null,0.43076882868284561,0.43076882868284561,null,0.43076882868284561,0,null,0.60692148535945556,0.60692148535945556,null,0.60692148535945556,0.44539036769812956,null,0.44539036769812956,0.44539036769812956,null,0.44539036769812956,0,null,0.44539036769812956,0.44539036769812956,null,0.44539036769812956,0.28075670215634863,null,0.28075670215634863,0.28075670215634863,null,0.28075670215634863,0,null,0.28075670215634863,0.28075670215634863,null,0.28075670215634863,0,null,0.67573252208718881,0.67573252208718881,null,0.67573252208718881,0.50294223981655961,null,0.50294223981655961,0.50294223981655961,null,0.50294223981655961,0,null,0.50294223981655961,0.50294223981655961,null,0.50294223981655961,0.41529493793175243,null,0.41529493793175243,0.41529493793175243,null,0.41529493793175243,0,null,0.41529493793175243,0.41529493793175243,null,0.41529493793175243,0,null,0.83374050998552174,0.83374050998552174,null,0.83374050998552174,0.53706834231962908,null,0.53706834231962908,0.53706834231962908,null,0.53706834231962908,0,null,0.53706834231962908,0.53706834231962908,null,0.53706834231962908,0.50904676656653491,null,0.50904676656653491,0.50904676656653491,null,0.50904676656653491,0,null,0.50904676656653491,0.50904676656653491,null,0.50904676656653491,0,null,0.93103446975374038,0.93103446975374038,null,0.93103446975374038,0.75195749769927989,null,0.75195749769927989,0.75195749769927989,null,0.75195749769927989,0.37147059459628434,null,0.37147059459628434,0.37147059459628434,null,0.37147059459628434,0,null,0.37147059459628434,0.37147059459628434,null,0.37147059459628434,0.28215983168854164,null,0.28215983168854164,0.28215983168854164,null,0.28215983168854164,0,null,0.28215983168854164,0.28215983168854164,null,0.28215983168854164,0,null,0.75195749769927989,0.75195749769927989,null,0.75195749769927989,0.54569744758485605,null,0.54569744758485605,0.54569744758485605,null,0.54569744758485605,0,null,0.54569744758485605,0.54569744758485605,null,0.54569744758485605,0.34801056870633662,null,0.34801056870633662,0.34801056870633662,null,0.34801056870633662,0,null,0.34801056870633662,0.34801056870633662,null,0.34801056870633662,0],"y":[43.75,54.390625,null,54.390625,54.390625,null,54.390625,48.0625,null,48.0625,48.0625,null,48.0625,47.125,null,47.125,47.125,null,47.125,46.25,null,46.25,46.25,null,46.25,45.5,null,45.5,45.5,null,45.5,45,null,45,45,null,45.5,46,null,46,46,null,46.25,47,null,47,47,null,47.125,48,null,48,48,null,48.0625,49,null,49,49,null,54.390625,60.71875,null,60.71875,60.71875,null,60.71875,57.1875,null,57.1875,57.1875,null,57.1875,54.625,null,54.625,54.625,null,54.625,52.5,null,52.5,52.5,null,52.5,51.25,null,51.25,51.25,null,51.25,50.5,null,50.5,50.5,null,50.5,50,null,50,50,null,50.5,51,null,51,51,null,51.25,52,null,52,52,null,52.5,53.75,null,53.75,53.75,null,53.75,53,null,53,53,null,53.75,54.5,null,54.5,54.5,null,54.5,54,null,54,54,null,54.5,55,null,55,55,null,54.625,56.75,null,56.75,56.75,null,56.75,56,null,56,56,null,56.75,57.5,null,57.5,57.5,null,57.5,57,null,57,57,null,57.5,58,null,58,58,null,57.1875,59.75,null,59.75,59.75,null,59.75,59,null,59,59,null,59.75,60.5,null,60.5,60.5,null,60.5,60,null,60,60,null,60.5,61,null,61,61,null,60.71875,64.25,null,64.25,64.25,null,64.25,62.75,null,62.75,62.75,null,62.75,62,null,62,62,null,62.75,63.5,null,63.5,63.5,null,63.5,63,null,63,63,null,63.5,64,null,64,64,null,64.25,65.75,null,65.75,65.75,null,65.75,65,null,65,65,null,65.75,66.5,null,66.5,66.5,null,66.5,66,null,66,66,null,66.5,67,null,67,67],"text":["y: 1.2181822","y: 1.2181822",null,"y: 1.2181822","y: 1.2181822",null,"y: 1.0342536","y: 1.0342536",null,"y: 1.0342536","y: 1.0342536",null,"y: 0.6937729","y: 0.6937729",null,"y: 0.6937729","y: 0.6937729",null,"y: 0.6460734","y: 0.6460734",null,"y: 0.6460734","y: 0.6460734",null,"y: 0.3539244","y: 0.3539244",null,"y: 0.3539244","y: 0.3539244",null,"y: 0.3177351","y: 0.3177351",null,"y: 0.3177351","y: 0.3177351",null,"y: 0.3177351","y: 0.3177351",null,"y: 0.3177351","y: 0.3177351",null,"y: 0.3539244","y: 0.3539244",null,"y: 0.3539244","y: 0.3539244",null,"y: 0.6460734","y: 0.6460734",null,"y: 0.6460734","y: 0.6460734",null,"y: 0.6937729","y: 0.6937729",null,"y: 0.6937729","y: 0.6937729",null,"y: 1.0342536","y: 1.0342536",null,"y: 1.0342536","y: 1.0342536",null,"y: 0.9310345","y: 0.9310345",null,"y: 0.9310345","y: 0.9310345",null,"y: 0.8337405","y: 0.8337405",null,"y: 0.8337405","y: 0.8337405",null,"y: 0.6757325","y: 0.6757325",null,"y: 0.6757325","y: 0.6757325",null,"y: 0.6069215","y: 0.6069215",null,"y: 0.6069215","y: 0.6069215",null,"y: 0.4307688","y: 0.4307688",null,"y: 0.4307688","y: 0.4307688",null,"y: 0.3146630","y: 0.3146630",null,"y: 0.3146630","y: 0.3146630",null,"y: 0.3146630","y: 0.3146630",null,"y: 0.3146630","y: 0.3146630",null,"y: 0.4307688","y: 0.4307688",null,"y: 0.4307688","y: 0.4307688",null,"y: 0.6069215","y: 0.6069215",null,"y: 0.6069215","y: 0.6069215",null,"y: 0.4453904","y: 0.4453904",null,"y: 0.4453904","y: 0.4453904",null,"y: 0.4453904","y: 0.4453904",null,"y: 0.4453904","y: 0.4453904",null,"y: 0.2807567","y: 0.2807567",null,"y: 0.2807567","y: 0.2807567",null,"y: 0.2807567","y: 0.2807567",null,"y: 0.2807567","y: 0.2807567",null,"y: 0.6757325","y: 0.6757325",null,"y: 0.6757325","y: 0.6757325",null,"y: 0.5029422","y: 0.5029422",null,"y: 0.5029422","y: 0.5029422",null,"y: 0.5029422","y: 0.5029422",null,"y: 0.5029422","y: 0.5029422",null,"y: 0.4152949","y: 0.4152949",null,"y: 0.4152949","y: 0.4152949",null,"y: 0.4152949","y: 0.4152949",null,"y: 0.4152949","y: 0.4152949",null,"y: 0.8337405","y: 0.8337405",null,"y: 0.8337405","y: 0.8337405",null,"y: 0.5370683","y: 0.5370683",null,"y: 0.5370683","y: 0.5370683",null,"y: 0.5370683","y: 0.5370683",null,"y: 0.5370683","y: 0.5370683",null,"y: 0.5090468","y: 0.5090468",null,"y: 0.5090468","y: 0.5090468",null,"y: 0.5090468","y: 0.5090468",null,"y: 0.5090468","y: 0.5090468",null,"y: 0.9310345","y: 0.9310345",null,"y: 0.9310345","y: 0.9310345",null,"y: 0.7519575","y: 0.7519575",null,"y: 0.7519575","y: 0.7519575",null,"y: 0.3714706","y: 0.3714706",null,"y: 0.3714706","y: 0.3714706",null,"y: 0.3714706","y: 0.3714706",null,"y: 0.3714706","y: 0.3714706",null,"y: 0.2821598","y: 0.2821598",null,"y: 0.2821598","y: 0.2821598",null,"y: 0.2821598","y: 0.2821598",null,"y: 0.2821598","y: 0.2821598",null,"y: 0.7519575","y: 0.7519575",null,"y: 0.7519575","y: 0.7519575",null,"y: 0.5456974","y: 0.5456974",null,"y: 0.5456974","y: 0.5456974",null,"y: 0.5456974","y: 0.5456974",null,"y: 0.5456974","y: 0.5456974",null,"y: 0.3480106","y: 0.3480106",null,"y: 0.3480106","y: 0.3480106",null,"y: 0.3480106","y: 0.3480106",null,"y: 0.3480106","y: 0.3480106"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(70,186,200,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.2181822160277491,1.2181822160277491,null,1.2181822160277491,1.0692437094954963,null,1.0692437094954963,1.0692437094954963,null,1.0692437094954963,0.85857792908413277,null,0.85857792908413277,0.85857792908413277,null,0.85857792908413277,0.66645806276407071,null,0.66645806276407071,0.66645806276407071,null,0.66645806276407071,0.46360976669903875,null,0.46360976669903875,0.46360976669903875,null,0.46360976669903875,0,null,0.46360976669903875,0.46360976669903875,null,0.46360976669903875,0.35907437305296136,null,0.35907437305296136,0.35907437305296136,null,0.35907437305296136,0,null,0.35907437305296136,0.35907437305296136,null,0.35907437305296136,0.29955523625655506,null,0.29955523625655506,0.29955523625655506,null,0.29955523625655506,0,null,0.29955523625655506,0.29955523625655506,null,0.29955523625655506,0,null,0.66645806276407071,0.66645806276407071,null,0.66645806276407071,0.41961205819693509,null,0.41961205819693509,0.41961205819693509,null,0.41961205819693509,0,null,0.41961205819693509,0.41961205819693509,null,0.41961205819693509,0,null,0.85857792908413277,0.85857792908413277,null,0.85857792908413277,0.65828503153797502,null,0.65828503153797502,0.65828503153797502,null,0.65828503153797502,0.50817977609077769,null,0.50817977609077769,0.50817977609077769,null,0.50817977609077769,0,null,0.50817977609077769,0.50817977609077769,null,0.50817977609077769,0.36712285006492618,null,0.36712285006492618,0.36712285006492618,null,0.36712285006492618,0,null,0.36712285006492618,0.36712285006492618,null,0.36712285006492618,0,null,0.65828503153797502,0.65828503153797502,null,0.65828503153797502,0.46032622666783141,null,0.46032622666783141,0.46032622666783141,null,0.46032622666783141,0.32204186116137401,null,0.32204186116137401,0.32204186116137401,null,0.32204186116137401,0,null,0.32204186116137401,0.32204186116137401,null,0.32204186116137401,0,null,0.46032622666783141,0.46032622666783141,null,0.46032622666783141,0,null,1.0692437094954963,1.0692437094954963,null,1.0692437094954963,0.90421124802606112,null,0.90421124802606112,0.90421124802606112,null,0.90421124802606112,0.48438332155393149,null,0.48438332155393149,0.48438332155393149,null,0.48438332155393149,0,null,0.48438332155393149,0.48438332155393149,null,0.48438332155393149,0,null,0.90421124802606112,0.90421124802606112,null,0.90421124802606112,0.81717943665589121,null,0.81717943665589121,0.81717943665589121,null,0.81717943665589121,0.47799368802188946,null,0.47799368802188946,0.47799368802188946,null,0.47799368802188946,0,null,0.47799368802188946,0.47799368802188946,null,0.47799368802188946,0,null,0.81717943665589121,0.81717943665589121,null,0.81717943665589121,0.72883174853760979,null,0.72883174853760979,0.72883174853760979,null,0.72883174853760979,0.57928111817730399,null,0.57928111817730399,0.57928111817730399,null,0.57928111817730399,0.38979448762054858,null,0.38979448762054858,0.38979448762054858,null,0.38979448762054858,0,null,0.38979448762054858,0.38979448762054858,null,0.38979448762054858,0,null,0.57928111817730399,0.57928111817730399,null,0.57928111817730399,0.44643303327110112,null,0.44643303327110112,0.44643303327110112,null,0.44643303327110112,0,null,0.44643303327110112,0.44643303327110112,null,0.44643303327110112,0,null,0.72883174853760979,0.72883174853760979,null,0.72883174853760979,0.46846095320031206,null,0.46846095320031206,0.46846095320031206,null,0.46846095320031206,0,null,0.46846095320031206,0.46846095320031206,null,0.46846095320031206,0],"y":[43.75,33.109375,null,33.109375,33.109375,null,33.109375,28.59375,null,28.59375,28.59375,null,28.59375,25.6875,null,25.6875,25.6875,null,25.6875,23.875,null,23.875,23.875,null,23.875,23,null,23,23,null,23.875,24.75,null,24.75,24.75,null,24.75,24,null,24,24,null,24.75,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,25.6875,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,28.59375,31.5,null,31.5,31.5,null,31.5,29.75,null,29.75,29.75,null,29.75,29,null,29,29,null,29.75,30.5,null,30.5,30.5,null,30.5,30,null,30,30,null,30.5,31,null,31,31,null,31.5,33.25,null,33.25,33.25,null,33.25,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33,null,33.25,34,null,34,34,null,33.109375,37.625,null,37.625,37.625,null,37.625,35.5,null,35.5,35.5,null,35.5,35,null,35,35,null,35.5,36,null,36,36,null,37.625,39.75,null,39.75,39.75,null,39.75,37.5,null,37.5,37.5,null,37.5,37,null,37,37,null,37.5,38,null,38,38,null,39.75,42,null,42,42,null,42,40.5,null,40.5,40.5,null,40.5,39.5,null,39.5,39.5,null,39.5,39,null,39,39,null,39.5,40,null,40,40,null,40.5,41.5,null,41.5,41.5,null,41.5,41,null,41,41,null,41.5,42,null,42,42,null,42,43.5,null,43.5,43.5,null,43.5,43,null,43,43,null,43.5,44,null,44,44],"text":["y: 1.2181822","y: 1.2181822",null,"y: 1.2181822","y: 1.2181822",null,"y: 1.0692437","y: 1.0692437",null,"y: 1.0692437","y: 1.0692437",null,"y: 0.8585779","y: 0.8585779",null,"y: 0.8585779","y: 0.8585779",null,"y: 0.6664581","y: 0.6664581",null,"y: 0.6664581","y: 0.6664581",null,"y: 0.4636098","y: 0.4636098",null,"y: 0.4636098","y: 0.4636098",null,"y: 0.4636098","y: 0.4636098",null,"y: 0.4636098","y: 0.4636098",null,"y: 0.3590744","y: 0.3590744",null,"y: 0.3590744","y: 0.3590744",null,"y: 0.3590744","y: 0.3590744",null,"y: 0.3590744","y: 0.3590744",null,"y: 0.2995552","y: 0.2995552",null,"y: 0.2995552","y: 0.2995552",null,"y: 0.2995552","y: 0.2995552",null,"y: 0.2995552","y: 0.2995552",null,"y: 0.6664581","y: 0.6664581",null,"y: 0.6664581","y: 0.6664581",null,"y: 0.4196121","y: 0.4196121",null,"y: 0.4196121","y: 0.4196121",null,"y: 0.4196121","y: 0.4196121",null,"y: 0.4196121","y: 0.4196121",null,"y: 0.8585779","y: 0.8585779",null,"y: 0.8585779","y: 0.8585779",null,"y: 0.6582850","y: 0.6582850",null,"y: 0.6582850","y: 0.6582850",null,"y: 0.5081798","y: 0.5081798",null,"y: 0.5081798","y: 0.5081798",null,"y: 0.5081798","y: 0.5081798",null,"y: 0.5081798","y: 0.5081798",null,"y: 0.3671229","y: 0.3671229",null,"y: 0.3671229","y: 0.3671229",null,"y: 0.3671229","y: 0.3671229",null,"y: 0.3671229","y: 0.3671229",null,"y: 0.6582850","y: 0.6582850",null,"y: 0.6582850","y: 0.6582850",null,"y: 0.4603262","y: 0.4603262",null,"y: 0.4603262","y: 0.4603262",null,"y: 0.3220419","y: 0.3220419",null,"y: 0.3220419","y: 0.3220419",null,"y: 0.3220419","y: 0.3220419",null,"y: 0.3220419","y: 0.3220419",null,"y: 0.4603262","y: 0.4603262",null,"y: 0.4603262","y: 0.4603262",null,"y: 1.0692437","y: 1.0692437",null,"y: 1.0692437","y: 1.0692437",null,"y: 0.9042112","y: 0.9042112",null,"y: 0.9042112","y: 0.9042112",null,"y: 0.4843833","y: 0.4843833",null,"y: 0.4843833","y: 0.4843833",null,"y: 0.4843833","y: 0.4843833",null,"y: 0.4843833","y: 0.4843833",null,"y: 0.9042112","y: 0.9042112",null,"y: 0.9042112","y: 0.9042112",null,"y: 0.8171794","y: 0.8171794",null,"y: 0.8171794","y: 0.8171794",null,"y: 0.4779937","y: 0.4779937",null,"y: 0.4779937","y: 0.4779937",null,"y: 0.4779937","y: 0.4779937",null,"y: 0.4779937","y: 0.4779937",null,"y: 0.8171794","y: 0.8171794",null,"y: 0.8171794","y: 0.8171794",null,"y: 0.7288317","y: 0.7288317",null,"y: 0.7288317","y: 0.7288317",null,"y: 0.5792811","y: 0.5792811",null,"y: 0.5792811","y: 0.5792811",null,"y: 0.3897945","y: 0.3897945",null,"y: 0.3897945","y: 0.3897945",null,"y: 0.3897945","y: 0.3897945",null,"y: 0.3897945","y: 0.3897945",null,"y: 0.5792811","y: 0.5792811",null,"y: 0.5792811","y: 0.5792811",null,"y: 0.4464330","y: 0.4464330",null,"y: 0.4464330","y: 0.4464330",null,"y: 0.4464330","y: 0.4464330",null,"y: 0.4464330","y: 0.4464330",null,"y: 0.7288317","y: 0.7288317",null,"y: 0.7288317","y: 0.7288317",null,"y: 0.4684610","y: 0.4684610",null,"y: 0.4684610","y: 0.4684610",null,"y: 0.4684610","y: 0.4684610",null,"y: 0.4684610","y: 0.4684610"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(86,189,150,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.4658462937094578,1.4658462937094578,null,1.4658462937094578,1.166842545824422,null,1.166842545824422,1.166842545824422,null,1.166842545824422,0.97685975441202988,null,0.97685975441202988,0.97685975441202988,null,0.97685975441202988,0.69002563924894444,null,0.69002563924894444,0.69002563924894444,null,0.69002563924894444,0.64427120279712036,null,0.64427120279712036,0.64427120279712036,null,0.64427120279712036,0.50011581189689869,null,0.50011581189689869,0.50011581189689869,null,0.50011581189689869,0,null,0.50011581189689869,0.50011581189689869,null,0.50011581189689869,0.31930022539587999,null,0.31930022539587999,0.31930022539587999,null,0.31930022539587999,0,null,0.31930022539587999,0.31930022539587999,null,0.31930022539587999,0,null,0.64427120279712036,0.64427120279712036,null,0.64427120279712036,0.3502673866640712,null,0.3502673866640712,0.3502673866640712,null,0.3502673866640712,0,null,0.3502673866640712,0.3502673866640712,null,0.3502673866640712,0,null,0.69002563924894444,0.69002563924894444,null,0.69002563924894444,0.42468025117255775,null,0.42468025117255775,0.42468025117255775,null,0.42468025117255775,0,null,0.42468025117255775,0.42468025117255775,null,0.42468025117255775,0,null,0.97685975441202988,0.97685975441202988,null,0.97685975441202988,0.69236736964806456,null,0.69236736964806456,0.69236736964806456,null,0.69236736964806456,0,null,0.69236736964806456,0.69236736964806456,null,0.69236736964806456,0.44259741493650945,null,0.44259741493650945,0.44259741493650945,null,0.44259741493650945,0,null,0.44259741493650945,0.44259741493650945,null,0.44259741493650945,0,null,1.166842545824422,1.166842545824422,null,1.166842545824422,0.96304783499477431,null,0.96304783499477431,0.96304783499477431,null,0.96304783499477431,0.8126399140588173,null,0.8126399140588173,0.8126399140588173,null,0.8126399140588173,0.62195954372430262,null,0.62195954372430262,0.62195954372430262,null,0.62195954372430262,0.34801892477056973,null,0.34801892477056973,0.34801892477056973,null,0.34801892477056973,0,null,0.34801892477056973,0.34801892477056973,null,0.34801892477056973,0,null,0.62195954372430262,0.62195954372430262,null,0.62195954372430262,0.42854870170228021,null,0.42854870170228021,0.42854870170228021,null,0.42854870170228021,0.34866323019772577,null,0.34866323019772577,0.34866323019772577,null,0.34866323019772577,0,null,0.34866323019772577,0.34866323019772577,null,0.34866323019772577,0,null,0.42854870170228021,0.42854870170228021,null,0.42854870170228021,0,null,0.8126399140588173,0.8126399140588173,null,0.8126399140588173,0.65193088749246486,null,0.65193088749246486,0.65193088749246486,null,0.65193088749246486,0,null,0.65193088749246486,0.65193088749246486,null,0.65193088749246486,0,null,0.96304783499477431,0.96304783499477431,null,0.96304783499477431,0],"y":[61.15625,78.5625,null,78.5625,78.5625,null,78.5625,73.78125,null,73.78125,73.78125,null,73.78125,71.8125,null,71.8125,71.8125,null,71.8125,70.125,null,70.125,70.125,null,70.125,68.75,null,68.75,68.75,null,68.75,68,null,68,68,null,68.75,69.5,null,69.5,69.5,null,69.5,69,null,69,69,null,69.5,70,null,70,70,null,70.125,71.5,null,71.5,71.5,null,71.5,71,null,71,71,null,71.5,72,null,72,72,null,71.8125,73.5,null,73.5,73.5,null,73.5,73,null,73,73,null,73.5,74,null,74,74,null,73.78125,75.75,null,75.75,75.75,null,75.75,75,null,75,75,null,75.75,76.5,null,76.5,76.5,null,76.5,76,null,76,76,null,76.5,77,null,77,77,null,78.5625,83.34375,null,83.34375,83.34375,null,83.34375,81.6875,null,81.6875,81.6875,null,81.6875,79.875,null,79.875,79.875,null,79.875,78.5,null,78.5,78.5,null,78.5,78,null,78,78,null,78.5,79,null,79,79,null,79.875,81.25,null,81.25,81.25,null,81.25,80.5,null,80.5,80.5,null,80.5,80,null,80,80,null,80.5,81,null,81,81,null,81.25,82,null,82,82,null,81.6875,83.5,null,83.5,83.5,null,83.5,83,null,83,83,null,83.5,84,null,84,84,null,83.34375,85,null,85,85],"text":["y: 1.4658463","y: 1.4658463",null,"y: 1.4658463","y: 1.4658463",null,"y: 1.1668425","y: 1.1668425",null,"y: 1.1668425","y: 1.1668425",null,"y: 0.9768598","y: 0.9768598",null,"y: 0.9768598","y: 0.9768598",null,"y: 0.6900256","y: 0.6900256",null,"y: 0.6900256","y: 0.6900256",null,"y: 0.6442712","y: 0.6442712",null,"y: 0.6442712","y: 0.6442712",null,"y: 0.5001158","y: 0.5001158",null,"y: 0.5001158","y: 0.5001158",null,"y: 0.5001158","y: 0.5001158",null,"y: 0.5001158","y: 0.5001158",null,"y: 0.3193002","y: 0.3193002",null,"y: 0.3193002","y: 0.3193002",null,"y: 0.3193002","y: 0.3193002",null,"y: 0.3193002","y: 0.3193002",null,"y: 0.6442712","y: 0.6442712",null,"y: 0.6442712","y: 0.6442712",null,"y: 0.3502674","y: 0.3502674",null,"y: 0.3502674","y: 0.3502674",null,"y: 0.3502674","y: 0.3502674",null,"y: 0.3502674","y: 0.3502674",null,"y: 0.6900256","y: 0.6900256",null,"y: 0.6900256","y: 0.6900256",null,"y: 0.4246803","y: 0.4246803",null,"y: 0.4246803","y: 0.4246803",null,"y: 0.4246803","y: 0.4246803",null,"y: 0.4246803","y: 0.4246803",null,"y: 0.9768598","y: 0.9768598",null,"y: 0.9768598","y: 0.9768598",null,"y: 0.6923674","y: 0.6923674",null,"y: 0.6923674","y: 0.6923674",null,"y: 0.6923674","y: 0.6923674",null,"y: 0.6923674","y: 0.6923674",null,"y: 0.4425974","y: 0.4425974",null,"y: 0.4425974","y: 0.4425974",null,"y: 0.4425974","y: 0.4425974",null,"y: 0.4425974","y: 0.4425974",null,"y: 1.1668425","y: 1.1668425",null,"y: 1.1668425","y: 1.1668425",null,"y: 0.9630478","y: 0.9630478",null,"y: 0.9630478","y: 0.9630478",null,"y: 0.8126399","y: 0.8126399",null,"y: 0.8126399","y: 0.8126399",null,"y: 0.6219595","y: 0.6219595",null,"y: 0.6219595","y: 0.6219595",null,"y: 0.3480189","y: 0.3480189",null,"y: 0.3480189","y: 0.3480189",null,"y: 0.3480189","y: 0.3480189",null,"y: 0.3480189","y: 0.3480189",null,"y: 0.6219595","y: 0.6219595",null,"y: 0.6219595","y: 0.6219595",null,"y: 0.4285487","y: 0.4285487",null,"y: 0.4285487","y: 0.4285487",null,"y: 0.3486632","y: 0.3486632",null,"y: 0.3486632","y: 0.3486632",null,"y: 0.3486632","y: 0.3486632",null,"y: 0.3486632","y: 0.3486632",null,"y: 0.4285487","y: 0.4285487",null,"y: 0.4285487","y: 0.4285487",null,"y: 0.8126399","y: 0.8126399",null,"y: 0.8126399","y: 0.8126399",null,"y: 0.6519309","y: 0.6519309",null,"y: 0.6519309","y: 0.6519309",null,"y: 0.6519309","y: 0.6519309",null,"y: 0.6519309","y: 0.6519309",null,"y: 0.9630478","y: 0.9630478",null,"y: 0.9630478","y: 0.9630478"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(153,169,226,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.4903783674406423,1.4903783674406423,null,1.4903783674406423,1.1589104575324796,null,1.1589104575324796,1.1589104575324796,null,1.1589104575324796,1.0308413614512433,null,1.0308413614512433,1.0308413614512433,null,1.0308413614512433,0.87640453744968172,null,0.87640453744968172,0.87640453744968172,null,0.87640453744968172,0.70503189148157508,null,0.70503189148157508,0.70503189148157508,null,0.70503189148157508,0,null,0.70503189148157508,0.70503189148157508,null,0.70503189148157508,0.62722983246509711,null,0.62722983246509711,0.62722983246509711,null,0.62722983246509711,0,null,0.62722983246509711,0.62722983246509711,null,0.62722983246509711,0.50305272283837854,null,0.50305272283837854,0.50305272283837854,null,0.50305272283837854,0,null,0.50305272283837854,0.50305272283837854,null,0.50305272283837854,0.3804343762249463,null,0.3804343762249463,0.3804343762249463,null,0.3804343762249463,0,null,0.3804343762249463,0.3804343762249463,null,0.3804343762249463,0,null,0.87640453744968172,0.87640453744968172,null,0.87640453744968172,0.4988860150377275,null,0.4988860150377275,0.4988860150377275,null,0.4988860150377275,0,null,0.4988860150377275,0.4988860150377275,null,0.4988860150377275,0.42186267883800965,null,0.42186267883800965,0.42186267883800965,null,0.42186267883800965,0,null,0.42186267883800965,0.42186267883800965,null,0.42186267883800965,0,null,1.0308413614512433,1.0308413614512433,null,1.0308413614512433,0.69523308006964846,null,0.69523308006964846,0.69523308006964846,null,0.69523308006964846,0.67840485901414704,null,0.67840485901414704,0.67840485901414704,null,0.67840485901414704,0,null,0.67840485901414704,0.67840485901414704,null,0.67840485901414704,0,null,0.69523308006964846,0.69523308006964846,null,0.69523308006964846,0.54894512091035397,null,0.54894512091035397,0.54894512091035397,null,0.54894512091035397,0,null,0.54894512091035397,0.54894512091035397,null,0.54894512091035397,0,null,1.1589104575324796,1.1589104575324796,null,1.1589104575324796,0.8918628372159958,null,0.8918628372159958,0.8918628372159958,null,0.8918628372159958,0.56276964881328784,null,0.56276964881328784,0.56276964881328784,null,0.56276964881328784,0.39601313093386442,null,0.39601313093386442,0.39601313093386442,null,0.39601313093386442,0,null,0.39601313093386442,0.39601313093386442,null,0.39601313093386442,0,null,0.56276964881328784,0.56276964881328784,null,0.56276964881328784,0,null,0.8918628372159958,0.8918628372159958,null,0.8918628372159958,0],"y":[10.44921875,17.2734375,null,17.2734375,17.2734375,null,17.2734375,13.421875,null,13.421875,13.421875,null,13.421875,10.34375,null,10.34375,10.34375,null,10.34375,7.9375,null,7.9375,7.9375,null,7.9375,7,null,7,7,null,7.9375,8.875,null,8.875,8.875,null,8.875,8,null,8,8,null,8.875,9.75,null,9.75,9.75,null,9.75,9,null,9,9,null,9.75,10.5,null,10.5,10.5,null,10.5,10,null,10,10,null,10.5,11,null,11,11,null,10.34375,12.75,null,12.75,12.75,null,12.75,12,null,12,12,null,12.75,13.5,null,13.5,13.5,null,13.5,13,null,13,13,null,13.5,14,null,14,14,null,13.421875,16.5,null,16.5,16.5,null,16.5,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.5,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,17.2734375,21.125,null,21.125,21.125,null,21.125,20.25,null,20.25,20.25,null,20.25,19.5,null,19.5,19.5,null,19.5,19,null,19,19,null,19.5,20,null,20,20,null,20.25,21,null,21,21,null,21.125,22,null,22,22],"text":["y: 1.4903784","y: 1.4903784",null,"y: 1.4903784","y: 1.4903784",null,"y: 1.1589105","y: 1.1589105",null,"y: 1.1589105","y: 1.1589105",null,"y: 1.0308414","y: 1.0308414",null,"y: 1.0308414","y: 1.0308414",null,"y: 0.8764045","y: 0.8764045",null,"y: 0.8764045","y: 0.8764045",null,"y: 0.7050319","y: 0.7050319",null,"y: 0.7050319","y: 0.7050319",null,"y: 0.7050319","y: 0.7050319",null,"y: 0.7050319","y: 0.7050319",null,"y: 0.6272298","y: 0.6272298",null,"y: 0.6272298","y: 0.6272298",null,"y: 0.6272298","y: 0.6272298",null,"y: 0.6272298","y: 0.6272298",null,"y: 0.5030527","y: 0.5030527",null,"y: 0.5030527","y: 0.5030527",null,"y: 0.5030527","y: 0.5030527",null,"y: 0.5030527","y: 0.5030527",null,"y: 0.3804344","y: 0.3804344",null,"y: 0.3804344","y: 0.3804344",null,"y: 0.3804344","y: 0.3804344",null,"y: 0.3804344","y: 0.3804344",null,"y: 0.8764045","y: 0.8764045",null,"y: 0.8764045","y: 0.8764045",null,"y: 0.4988860","y: 0.4988860",null,"y: 0.4988860","y: 0.4988860",null,"y: 0.4988860","y: 0.4988860",null,"y: 0.4988860","y: 0.4988860",null,"y: 0.4218627","y: 0.4218627",null,"y: 0.4218627","y: 0.4218627",null,"y: 0.4218627","y: 0.4218627",null,"y: 0.4218627","y: 0.4218627",null,"y: 1.0308414","y: 1.0308414",null,"y: 1.0308414","y: 1.0308414",null,"y: 0.6952331","y: 0.6952331",null,"y: 0.6952331","y: 0.6952331",null,"y: 0.6784049","y: 0.6784049",null,"y: 0.6784049","y: 0.6784049",null,"y: 0.6784049","y: 0.6784049",null,"y: 0.6784049","y: 0.6784049",null,"y: 0.6952331","y: 0.6952331",null,"y: 0.6952331","y: 0.6952331",null,"y: 0.5489451","y: 0.5489451",null,"y: 0.5489451","y: 0.5489451",null,"y: 0.5489451","y: 0.5489451",null,"y: 0.5489451","y: 0.5489451",null,"y: 1.1589105","y: 1.1589105",null,"y: 1.1589105","y: 1.1589105",null,"y: 0.8918628","y: 0.8918628",null,"y: 0.8918628","y: 0.8918628",null,"y: 0.5627696","y: 0.5627696",null,"y: 0.5627696","y: 0.5627696",null,"y: 0.3960131","y: 0.3960131",null,"y: 0.3960131","y: 0.3960131",null,"y: 0.3960131","y: 0.3960131",null,"y: 0.3960131","y: 0.3960131",null,"y: 0.5627696","y: 0.5627696",null,"y: 0.5627696","y: 0.5627696",null,"y: 0.8918628","y: 0.8918628",null,"y: 0.8918628","y: 0.8918628"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(156,180,105,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.4903783674406423,1.4903783674406423,null,1.4903783674406423,1.1665415430638404,null,1.1665415430638404,1.1665415430638404,null,1.1665415430638404,0.62561767211680597,null,0.62561767211680597,0.62561767211680597,null,0.62561767211680597,0,null,0.62561767211680597,0.62561767211680597,null,0.62561767211680597,0,null,1.1665415430638404,1.1665415430638404,null,1.1665415430638404,0.79432305257321023,null,0.79432305257321023,0.79432305257321023,null,0.79432305257321023,0,null,0.79432305257321023,0.79432305257321023,null,0.79432305257321023,0.60289147577596069,null,0.60289147577596069,0.60289147577596069,null,0.60289147577596069,0,null,0.60289147577596069,0.60289147577596069,null,0.60289147577596069,0],"y":[10.44921875,3.625,null,3.625,3.625,null,3.625,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.625,4.75,null,4.75,4.75,null,4.75,4,null,4,4,null,4.75,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6],"text":["y: 1.4903784","y: 1.4903784",null,"y: 1.4903784","y: 1.4903784",null,"y: 1.1665415","y: 1.1665415",null,"y: 1.1665415","y: 1.1665415",null,"y: 0.6256177","y: 0.6256177",null,"y: 0.6256177","y: 0.6256177",null,"y: 0.6256177","y: 0.6256177",null,"y: 0.6256177","y: 0.6256177",null,"y: 1.1665415","y: 1.1665415",null,"y: 1.1665415","y: 1.1665415",null,"y: 0.7943231","y: 0.7943231",null,"y: 0.7943231","y: 0.7943231",null,"y: 0.7943231","y: 0.7943231",null,"y: 0.7943231","y: 0.7943231",null,"y: 0.6028915","y: 0.6028915",null,"y: 0.6028915","y: 0.6028915",null,"y: 0.6028915","y: 0.6028915",null,"y: 0.6028915","y: 0.6028915"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(206,164,114,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.722429013555516,1.722429013555516,null,1.722429013555516,1.1655766798610891,null,1.1655766798610891,1.1655766798610891,null,1.1655766798610891,0,null,1.1655766798610891,1.1655766798610891,null,1.1655766798610891,0],"y":[73.828125,86.5,null,86.5,86.5,null,86.5,86,null,86,86,null,86.5,87,null,87,87],"text":["y: 1.7224290","y: 1.7224290",null,"y: 1.7224290","y: 1.7224290",null,"y: 1.1655767","y: 1.1655767",null,"y: 1.1655767","y: 1.1655767",null,"y: 1.1655767","y: 1.1655767",null,"y: 1.1655767","y: 1.1655767"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(212,151,211,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.6589786411094363,1.6589786411094363,null,1.6589786411094363,0],"y":[5.724609375,1,null,1,1],"text":"y: 1.6589786","type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.0296470253407302,2.0296470253407302,null,2.0296470253407302,1.6589786411094363,null,1.6589786411094363,1.6589786411094363,null,1.6589786411094363,1.4903783674406423,null,2.0296470253407302,2.0296470253407302,null,2.0296470253407302,1.722429013555516,null,1.722429013555516,1.722429013555516,null,1.722429013555516,1.4658462937094578,null,1.4658462937094578,1.4658462937094578,null,1.4658462937094578,1.2181822160277491],"y":[39.7763671875,5.724609375,null,5.724609375,5.724609375,null,5.724609375,10.44921875,null,10.44921875,10.44921875,null,39.7763671875,73.828125,null,73.828125,73.828125,null,73.828125,61.15625,null,61.15625,61.15625,null,61.15625,43.75,null,43.75,43.75],"text":["y: 2.0296470","y: 2.0296470",null,"y: 2.0296470","y: 2.0296470",null,"y: 1.6589786","y: 1.6589786",null,"y: 1.6589786","y: 1.6589786",null,"y: 2.0296470","y: 2.0296470",null,"y: 2.0296470","y: 2.0296470",null,"y: 1.7224290","y: 1.7224290",null,"y: 1.7224290","y: 1.7224290",null,"y: 1.4658463","y: 1.4658463",null,"y: 1.4658463","y: 1.4658463"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.0296470253407302,1.6589786411094363,0,1.4903783674406423,1.1665415430638404,0.62561767211680597,0,0,0.79432305257321023,0,0.60289147577596069,0,0,1.1589104575324796,1.0308413614512433,0.87640453744968172,0.70503189148157508,0,0.62722983246509711,0,0.50305272283837854,0,0.3804343762249463,0,0,0.4988860150377275,0,0.42186267883800965,0,0,0.69523308006964846,0.67840485901414704,0,0,0.54894512091035397,0,0,0.8918628372159958,0.56276964881328784,0.39601313093386442,0,0,0,0,1.722429013555516,1.4658462937094578,1.2181822160277491,1.0692437094954963,0.85857792908413277,0.66645806276407071,0.46360976669903875,0,0.35907437305296136,0,0.29955523625655506,0,0,0.41961205819693509,0,0,0.65828503153797502,0.50817977609077769,0,0.36712285006492618,0,0,0.46032622666783141,0.32204186116137401,0,0,0,0.90421124802606112,0.48438332155393149,0,0,0.81717943665589121,0.47799368802188946,0,0,0.72883174853760979,0.57928111817730399,0.38979448762054858,0,0,0.44643303327110112,0,0,0.46846095320031206,0,0,1.0342536452765183,0.69377291826413456,0.64607336259032067,0.35392444092115849,0.31773513414092658,0,0,0,0,0,0.93103446975374038,0.83374050998552174,0.67573252208718881,0.60692148535945556,0.43076882868284561,0.31466301223402532,0,0,0,0.44539036769812956,0,0.28075670215634863,0,0,0.50294223981655961,0,0.41529493793175243,0,0,0.53706834231962908,0,0.50904676656653491,0,0,0.75195749769927989,0.37147059459628434,0,0.28215983168854164,0,0,0.54569744758485605,0,0.34801056870633662,0,0,1.166842545824422,0.97685975441202988,0.69002563924894444,0.64427120279712036,0.50011581189689869,0,0.31930022539587999,0,0,0.3502673866640712,0,0,0.42468025117255775,0,0,0.69236736964806456,0,0.44259741493650945,0,0,0.96304783499477431,0.8126399140588173,0.62195954372430262,0.34801892477056973,0,0,0.42854870170228021,0.34866323019772577,0,0,0,0.65193088749246486,0,0,0,1.1655766798610891,0,0],"y":[39.7763671875,5.724609375,1,10.44921875,3.625,2.5,2,3,4.75,4,5.5,5,6,17.2734375,13.421875,10.34375,7.9375,7,8.875,8,9.75,9,10.5,10,11,12.75,12,13.5,13,14,16.5,15.5,15,16,17.5,17,18,21.125,20.25,19.5,19,20,21,22,73.828125,61.15625,43.75,33.109375,28.59375,25.6875,23.875,23,24.75,24,25.5,25,26,27.5,27,28,31.5,29.75,29,30.5,30,31,33.25,32.5,32,33,34,37.625,35.5,35,36,39.75,37.5,37,38,42,40.5,39.5,39,40,41.5,41,42,43.5,43,44,54.390625,48.0625,47.125,46.25,45.5,45,46,47,48,49,60.71875,57.1875,54.625,52.5,51.25,50.5,50,51,52,53.75,53,54.5,54,55,56.75,56,57.5,57,58,59.75,59,60.5,60,61,64.25,62.75,62,63.5,63,64,65.75,65,66.5,66,67,78.5625,73.78125,71.8125,70.125,68.75,68,69.5,69,70,71.5,71,72,73.5,73,74,75.75,75,76.5,76,77,83.34375,81.6875,79.875,78.5,78,79,81.25,80.5,80,81,82,83.5,83,84,85,86.5,86,87],"text":["y: 2.0296470","y: 1.6589786","y: 0.0000000","y: 1.4903784","y: 1.1665415","y: 0.6256177","y: 0.0000000","y: 0.0000000","y: 0.7943231","y: 0.0000000","y: 0.6028915","y: 0.0000000","y: 0.0000000","y: 1.1589105","y: 1.0308414","y: 0.8764045","y: 0.7050319","y: 0.0000000","y: 0.6272298","y: 0.0000000","y: 0.5030527","y: 0.0000000","y: 0.3804344","y: 0.0000000","y: 0.0000000","y: 0.4988860","y: 0.0000000","y: 0.4218627","y: 0.0000000","y: 0.0000000","y: 0.6952331","y: 0.6784049","y: 0.0000000","y: 0.0000000","y: 0.5489451","y: 0.0000000","y: 0.0000000","y: 0.8918628","y: 0.5627696","y: 0.3960131","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 1.7224290","y: 1.4658463","y: 1.2181822","y: 1.0692437","y: 0.8585779","y: 0.6664581","y: 0.4636098","y: 0.0000000","y: 0.3590744","y: 0.0000000","y: 0.2995552","y: 0.0000000","y: 0.0000000","y: 0.4196121","y: 0.0000000","y: 0.0000000","y: 0.6582850","y: 0.5081798","y: 0.0000000","y: 0.3671229","y: 0.0000000","y: 0.0000000","y: 0.4603262","y: 0.3220419","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.9042112","y: 0.4843833","y: 0.0000000","y: 0.0000000","y: 0.8171794","y: 0.4779937","y: 0.0000000","y: 0.0000000","y: 0.7288317","y: 0.5792811","y: 0.3897945","y: 0.0000000","y: 0.0000000","y: 0.4464330","y: 0.0000000","y: 0.0000000","y: 0.4684610","y: 0.0000000","y: 0.0000000","y: 1.0342536","y: 0.6937729","y: 0.6460734","y: 0.3539244","y: 0.3177351","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.9310345","y: 0.8337405","y: 0.6757325","y: 0.6069215","y: 0.4307688","y: 0.3146630","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.4453904","y: 0.0000000","y: 0.2807567","y: 0.0000000","y: 0.0000000","y: 0.5029422","y: 0.0000000","y: 0.4152949","y: 0.0000000","y: 0.0000000","y: 0.5370683","y: 0.0000000","y: 0.5090468","y: 0.0000000","y: 0.0000000","y: 0.7519575","y: 0.3714706","y: 0.0000000","y: 0.2821598","y: 0.0000000","y: 0.0000000","y: 0.5456974","y: 0.0000000","y: 0.3480106","y: 0.0000000","y: 0.0000000","y: 1.1668425","y: 0.9768598","y: 0.6900256","y: 0.6442712","y: 0.5001158","y: 0.0000000","y: 0.3193002","y: 0.0000000","y: 0.0000000","y: 0.3502674","y: 0.0000000","y: 0.0000000","y: 0.4246803","y: 0.0000000","y: 0.0000000","y: 0.6923674","y: 0.0000000","y: 0.4425974","y: 0.0000000","y: 0.0000000","y: 0.9630478","y: 0.8126399","y: 0.6219595","y: 0.3480189","y: 0.0000000","y: 0.0000000","y: 0.4285487","y: 0.3486632","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.6519309","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 1.1655767","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.8897637795275593,"color":"transparent"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.80000000000000004],"automargin":true,"type":"linear","autorange":false,"range":[0.5,12.5],"tickmode":"array","ticktext":["causing_injury","murder","rape","break_in","theft_other","robbery","vehicle_theft","poverty_absolute","poverty_relative","gini","unemployment_rate","employment_ratio"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["causing_injury","murder","rape","break_in","theft_other","robbery","vehicle_theft","poverty_absolute","poverty_relative","gini","unemployment_rate","employment_ratio"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664176026},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Crime and Demographic Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.80000000000000004,1],"automargin":true,"type":"linear","autorange":false,"range":[0,2.0296470253407302],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5","2.0"],"tickvals":[0,0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,87.5],"tickmode":"array","ticktext":["Kedah-Langkawi","Kedah-Kota Setar","Kedah-Kuala Muda","Kuala Lumpur-Wp. Kuala Lumpur","Selangor-Gombak","Pulau Pinang-S.p. Tengah","Melaka-Melaka Tengah","Pulau Pinang-Timur Laut","Negeri Sembilan-Port Dickson","Negeri Sembilan-Seremban","Pulau Pinang-S.p. Utara","Johor-Johor Bahru","Selangor-Petaling","Selangor-Klang","Pulau Pinang-S.p.selatan","Selangor-Ulu Selangor","Selangor-Kuala Langat","Selangor-Sepang","Perlis-Perlis","Negeri Sembilan-Rembau","Negeri Sembilan-Kuala Pilah","Selangor-Sabak Bernam","Selangor-Kuala Selangor","Johor-Kluang","Johor-Segamat","Johor-Kota Tinggi","Kedah-Baling","Kedah-Kulim","Melaka-Jasin","Pulau Pinang-Barat Daya","Melaka-Alor Gajah","Johor-Muar","Johor-Ledang","Johor-Batu Pahat","Selangor-Ulu Langat","Johor-Kulaijaya","Kedah-Sik","Kedah-Yan","Perak-Ulu Perak","Perak-Batang Padang","Negeri Sembilan-Jelebu","Johor-Pontian","Kuala Lumpur-W.p. Putrajaya","Terengganu-Kemaman","Terengganu-Dungun","Terengganu-Kuala Terengganu","Terengganu-Marang","Terengganu-Hulu Terengganu","Terengganu-Besut","Kedah-Pendang","Kedah-Pokok Sena","Kedah-Kubang Pasu","Pahang-Kuantan","Pahang-Maran","Pahang-Pekan","Pahang-Jerantut","Kedah-Bandar Baharu","Terengganu-Setiu","Pahang-Lipis","Pahang-Raub","Pahang-Bera","Pahang-Rompin","Kedah-Padang Terap","Pahang-Temerloh","Perak-Larut Dan Matang","Perak-Kerian","Perak-Kampar","Negeri Sembilan-Tampin","Perak-Kinta","Perak-Manjung (Dinding)","Perak-Perak Tengah","Perak-Kuala Kangsar","Kelantan-Machang","Kelantan-Kota Bharu","Kelantan-Pasir Puteh","Perak-Hilir Perak","Negeri Sembilan-Jempol","Kelantan-Bachok","Kelantan-Pasir Mas","Kelantan-Tumpat","Kelantan-Tanah Merah","Kelantan-Jeli","Kelantan-Kuala Krai","Johor-Mersing","Kelantan-Gua Musang","Pahang-Bentong","Pahang-Cameron Highlands"],"tickvals":[1,2,3,4,5,6.0000000000000009,7.0000000000000009,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,25.999999999999996,27,28,29,29.999999999999996,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,46.999999999999993,48.000000000000007,49,50,51,52,53,54,54.999999999999993,56.000000000000007,57,58,59,60,61,62,62.999999999999993,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87],"categoryorder":"array","categoryarray":["Kedah-Langkawi","Kedah-Kota Setar","Kedah-Kuala Muda","Kuala Lumpur-Wp. Kuala Lumpur","Selangor-Gombak","Pulau Pinang-S.p. Tengah","Melaka-Melaka Tengah","Pulau Pinang-Timur Laut","Negeri Sembilan-Port Dickson","Negeri Sembilan-Seremban","Pulau Pinang-S.p. Utara","Johor-Johor Bahru","Selangor-Petaling","Selangor-Klang","Pulau Pinang-S.p.selatan","Selangor-Ulu Selangor","Selangor-Kuala Langat","Selangor-Sepang","Perlis-Perlis","Negeri Sembilan-Rembau","Negeri Sembilan-Kuala Pilah","Selangor-Sabak Bernam","Selangor-Kuala Selangor","Johor-Kluang","Johor-Segamat","Johor-Kota Tinggi","Kedah-Baling","Kedah-Kulim","Melaka-Jasin","Pulau Pinang-Barat Daya","Melaka-Alor Gajah","Johor-Muar","Johor-Ledang","Johor-Batu Pahat","Selangor-Ulu Langat","Johor-Kulaijaya","Kedah-Sik","Kedah-Yan","Perak-Ulu Perak","Perak-Batang Padang","Negeri Sembilan-Jelebu","Johor-Pontian","Kuala Lumpur-W.p. Putrajaya","Terengganu-Kemaman","Terengganu-Dungun","Terengganu-Kuala Terengganu","Terengganu-Marang","Terengganu-Hulu Terengganu","Terengganu-Besut","Kedah-Pendang","Kedah-Pokok Sena","Kedah-Kubang Pasu","Pahang-Kuantan","Pahang-Maran","Pahang-Pekan","Pahang-Jerantut","Kedah-Bandar Baharu","Terengganu-Setiu","Pahang-Lipis","Pahang-Raub","Pahang-Bera","Pahang-Rompin","Kedah-Padang Terap","Pahang-Temerloh","Perak-Larut Dan Matang","Perak-Kerian","Perak-Kampar","Negeri Sembilan-Tampin","Perak-Kinta","Perak-Manjung (Dinding)","Perak-Perak Tengah","Perak-Kuala Kangsar","Kelantan-Machang","Kelantan-Kota Bharu","Kelantan-Pasir Puteh","Perak-Hilir Perak","Negeri Sembilan-Jempol","Kelantan-Bachok","Kelantan-Pasir Mas","Kelantan-Tumpat","Kelantan-Tanah Merah","Kelantan-Jeli","Kelantan-Kuala Krai","Johor-Mersing","Kelantan-Gua Musang","Pahang-Bentong","Pahang-Cameron Highlands"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.3134080531340802},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Districts","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.80000000000000004,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.80000000000000004,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":50,"r":null,"b":54.196762141967618,"l":50},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of West Malaysia by Crime indicators"},"attrs":{"b9d656585d52":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"b9d657352e6":{"x":{},"y":{},"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"type":"scatter"},"b9d656477cd5":{"x":{},"y":{},"colour":{},"shape":{},"size":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span>n_clust))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>hclust_ward_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(piv_df_mys.all, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>hclust_ward_cluster.norm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(clust_vars, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix(groups)</span><span class="st">`</span>)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>hclust_ward_plot <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(hclust_ward_cluster) <span class="sc">+</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"CLUSTER"</span>, </span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Set3"</span>,</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Cluster"</span>) <span class="sc">+</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Hierarchical Clustering - K:"</span>, n_clust),</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>hclust_ward_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Out-of-the-Box Spatially Relations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The clusters in general seem somewhat related among it’s immediate neighbour which is actually a good sign, it shows there are some form of spatial relation between crime patterns and their geographic localion.</p>
</div>
</div>
</section>
</section>
<section id="compute-cluster-geo-constrained" class="level3">
<h3 class="anchored" data-anchor-id="compute-cluster-geo-constrained">3.3.3 Compute Cluster (Geo Constrained)</h3>
<section id="compute-distmat" class="level4">
<h4 class="anchored" data-anchor-id="compute-distmat">3.3.3.1 Compute distmat</h4>
<p>We will need to compute the distance matrix, a specific format required for spatial analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(piv_df_mys.all, piv_df_mys.all)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>distmat <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-choicalpha" class="level4">
<h4 class="anchored" data-anchor-id="compute-choicalpha">3.3.3.2 Compute Choicalpha</h4>
<p>Next we use <code>choicealpha</code> to determine the optimal threshold value (alpha) for defining neighbors based on distance. It considers various alpha values and selects the one that minimizes the number of isolated nodes and maximizes the number of clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">choicealpha</span>(proxmat, distmat, <span class="at">range.alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">K=</span>n_clust, <span class="at">graph =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-69-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="perform-clustering-1" class="level4">
<h4 class="anchored" data-anchor-id="perform-clustering-1">3.3.3.3 Perform Clustering</h4>
<p>The threshold seem to be crossed at 0.1, hence we will be using that for our geographically constrained clustering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>hclust_geo <span class="ot">&lt;-</span> <span class="fu">hclustgeo</span>(proxmat, distmat, <span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-cluster-1" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-cluster-1">3.3.3.4 Visualizing Cluster</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Dendogram</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Cluster</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_geo, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_geo, </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> n_clust, </span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_geo, <span class="at">k=</span>n_clust))</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>hclust_geo_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(piv_df_mys.all, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>hclust_geo_cluster.norm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(clust_vars, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix(groups)</span><span class="st">`</span>)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>hclust_geo_plot <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(hclust_geo_cluster) <span class="sc">+</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"CLUSTER"</span>, </span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Set3"</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Cluster"</span>) <span class="sc">+</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Hierarchical Clustering (Geo) - K:"</span>, n_clust),</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>hclust_geo_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparison" class="level4">
<h4 class="anchored" data-anchor-id="comparison">3.3.3.5 Comparison</h4>
<p>Lets put both cluster side-by-side. Both clustering results seems very similar, partly due to the low alpha value. But overall the clustering seems me coherenet as compared to the standard clusterin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(hclust_ward_plot, hclust_geo_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="skater-clustering" class="level2">
<h2 class="anchored" data-anchor-id="skater-clustering">3.4 Skater Clustering</h2>
<p>We will also be attempting cluster using the SKATER method with MST and see if we can incoporate it into our Shiny application.</p>
<section id="generating-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="generating-neighbours">3.4.1 Generating Neighbours</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(piv_df_mys.all)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 87 
Number of nonzero links: 402 
Percentage nonzero weights: 5.311138 
Average number of links: 4.62069 
1 region with no links:
17
3 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  8  9 
 1  4  3 13 26 13 15  5  4  3 
4 least connected regions:
33 66 67 71 with 1 link
3 most connected regions:
10 24 48 with 9 links</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(piv_df_mys.all)))</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(piv_df_mys.all), </span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>     coords, </span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note on disjoint
</div>
</div>
<div class="callout-body-container callout-body">
<p>3 Disjoint Subgraphs</p>
<ol type="1">
<li><p>MainLand</p></li>
<li><p>Langkawi (Region with no links)</p></li>
<li><p>Pulau Pinang</p></li>
</ol>
</div>
</div>
</section>
<section id="fixing-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="fixing-neighbours">3.4.2 Fixing Neighbours</h3>
<p>In order to create a complete MST we have to address the issue above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>components <span class="ot">&lt;-</span> <span class="fu">n.comp.nb</span>(nb)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(components<span class="sc">$</span>comp.id <span class="sc">==</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys.all<span class="sc">$</span>state_district[<span class="fu">which</span>(components<span class="sc">$</span>comp.id <span class="sc">==</span> <span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kedah-Langkawi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(components<span class="sc">$</span>comp.id <span class="sc">==</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67 71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys.all<span class="sc">$</span>state_district[<span class="fu">which</span>(components<span class="sc">$</span>comp.id <span class="sc">==</span> <span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pulau Pinang-Barat Daya" "Pulau Pinang-Timur Laut"</code></pre>
</div>
</div>
<section id="langkawi" class="level4">
<h4 class="anchored" data-anchor-id="langkawi">3.4.2.1 Langkawi</h4>
<p>Given that there are water routes to Langkawi from Kuala Perlis, Kuala Kedah and Penang we will add them into Langkawi neighbours</p>
<p><img src="assets/ferry_lanes.jpeg" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>indices_langkawi_boat <span class="ot">&lt;-</span> <span class="fu">which</span>(piv_df_mys.all<span class="sc">$</span>state_district <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Perlis-Perlis"</span>, <span class="st">"Kedah-Kota Setar"</span>, <span class="st">"Pulau Pinang-Timur Laut"</span>))</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>indices_langkawi_boat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13 66 71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys.all<span class="sc">$</span>state_district[indices_langkawi_boat]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Kedah-Kota Setar"        "Perlis-Perlis"          
[3] "Pulau Pinang-Timur Laut"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">17</span>]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">66</span>, <span class="dv">71</span>))</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">13</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">13</span>]], <span class="fu">as.integer</span>(<span class="dv">17</span>))</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">66</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">66</span>]], <span class="fu">as.integer</span>(<span class="dv">17</span>))</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">71</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">71</span>]], <span class="fu">as.integer</span>(<span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pulau-pinang" class="level4">
<h4 class="anchored" data-anchor-id="pulau-pinang">3.4.2.2 Pulau Pinang</h4>
<p>For Penang island we will be mapping by the 2 land links available</p>
<ol type="1">
<li><p>Timur Laut -&gt; S.P. Tengah</p></li>
<li><p>Barat Daya -&gt; S.P. Selatan</p></li>
</ol>
<p><img src="assets/penang_land_link.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mys_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ADM1_EN<span class="sc">==</span><span class="st">"PULAU PINANG"</span>)) <span class="sc">+</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">size =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>indices_pulau_pinang <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">startsWith</span>(piv_df_mys.all<span class="sc">$</span>state_district, <span class="st">"Pulau Pinang"</span>))</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>indices_pulau_pinang</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67 68 69 70 71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>piv_df_mys.all<span class="sc">$</span>state_district[indices_pulau_pinang]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pulau Pinang-Barat Daya"  "Pulau Pinang-S.p. Tengah"
[3] "Pulau Pinang-S.p. Utara"  "Pulau Pinang-S.p.selatan"
[5] "Pulau Pinang-Timur Laut" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BARAT DAYA</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">67</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">67</span>]], <span class="fu">as.integer</span>(<span class="dv">68</span>))</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">68</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">68</span>]], <span class="fu">as.integer</span>(<span class="dv">67</span>))</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co"># TIMUR LAUT</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">71</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">71</span>]], <span class="fu">as.integer</span>(<span class="dv">70</span>))</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>nb[[<span class="dv">70</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(nb[[<span class="dv">70</span>]], <span class="fu">as.integer</span>(<span class="dv">71</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-fix" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-fix">3.4.2.3 Visualizing Fix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(piv_df_mys.all)))</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(piv_df_mys.all), </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb,</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>     coords, </span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graph is now no longer disjoint and we can proceed with computing our MST.</p>
</section>
</section>
<section id="compute-mst" class="level3">
<h3 class="anchored" data-anchor-id="compute-mst">3.4.3 Compute MST</h3>
<section id="compute-nb-weights" class="level4">
<h4 class="anchored" data-anchor-id="compute-nb-weights">3.4.3.1 Compute <code>nb</code> Weights</h4>
<p>Next we create spatial weights matrix using the neighbor list <code>nb</code> and the edge costs <code>lcosts</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(nb, clust_vars)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>clust_vars.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, </span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>                   lcosts, </span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(clust_vars.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 87 
Number of nonzero links: 412 
Percentage nonzero weights: 5.443255 
Average number of links: 4.735632 
3 disjoint connected subgraphs
Link number distribution:

 1  2  3  4  5  6  7  8  9 
 1  5 14 25 15 15  5  4  3 
1 least connected region:
33 with 1 link
3 most connected regions:
10 24 48 with 9 links

Weights style: B 
Weights constants summary:
   n   nn       S0       S1       S2
B 87 7569 303.4572 503.8611 5265.124</code></pre>
</div>
</div>
</section>
<section id="generate-mst" class="level4">
<h4 class="anchored" data-anchor-id="generate-mst">3.4.3.2 Generate MST</h4>
<p>Constructs a minimum spanning tree (MST) using the spatial weights matrix <code>clust_vars.w</code> with the minimum edge weight</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>clust_vars.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(clust_vars.w)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(clust_vars.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]      [,3]
[1,]   32   29 0.5014292
[2,]   29   28 0.4930300
[3,]   28   26 0.4246803
[4,]   29   31 0.5418653
[5,]   31   25 0.3540978
[6,]   31   27 0.5235293</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(piv_df_mys.all), </span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(clust_vars.mst, </span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>         coords, </span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="compute-cluster-1" class="level3">
<h3 class="anchored" data-anchor-id="compute-cluster-1">3.4.4 Compute Cluster</h3>
<p>Next we perform spatial clustering on the data using the computed mst. The <code>skater</code> function divides the MST into clusters based on edge cuts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">skater</span>(<span class="at">edges =</span> clust_vars.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> clust_vars, </span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euclidean"</span>, </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncuts =</span> (n_clust <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 8
 $ groups      : num [1:87] 2 2 2 2 2 2 2 2 2 2 ...
 $ edges.groups:List of 7
  ..$ :List of 3
  .. ..$ node: num [1:22] 56 25 65 31 29 30 61 63 26 28 ...
  .. ..$ edge: num [1:21, 1:3] 25 65 31 61 29 25 63 63 30 26 ...
  .. ..$ ssw : num 11.4
  ..$ :List of 3
  .. ..$ node: num [1:26] 73 74 78 35 42 6 36 43 8 1 ...
  .. ..$ edge: num [1:25, 1:3] 35 6 42 75 36 78 74 8 42 43 ...
  .. ..$ ssw : num 14.1
  ..$ :List of 3
  .. ..$ node: num [1:3] 76 72 34
  .. ..$ edge: num [1:2, 1:3] 76 72 72 34 0.661 ...
  .. ..$ ssw : num 1.36
  ..$ :List of 3
  .. ..$ node: num [1:18] 83 84 49 86 82 55 52 51 54 46 ...
  .. ..$ edge: num [1:17, 1:3] 55 52 84 54 82 49 51 46 39 83 ...
  .. ..$ ssw : num 8.41
  ..$ :List of 3
  .. ..$ node: num [1:16] 13 69 19 14 16 20 70 71 15 68 ...
  .. ..$ edge: num [1:15, 1:3] 69 14 19 69 19 19 16 20 70 71 ...
  .. ..$ ssw : num 8.52
  ..$ :List of 3
  .. ..$ node: num 17
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
  ..$ :List of 3
  .. ..$ node: num 47
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
 $ not.prune   : NULL
 $ candidates  : int [1:7] 1 2 3 4 5 6 7
 $ ssto        : num 55.2
 $ ssw         : num [1:7] 55.2 52.6 50.4 48.6 46.6 ...
 $ crit        : num [1:2] 1 Inf
 $ vec.crit    : num [1:87] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "class")= chr "skater"</code></pre>
</div>
</div>
</section>
<section id="visualizing-clusters" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-clusters">3.4.5 Visualizing Clusters</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">MST</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Clusters</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(piv_df_mys.all), </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust, </span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>     coords, </span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span>.<span class="dv">5</span>,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clust<span class="sc">$</span>groups)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>skater_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(piv_df_mys.all, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>skater_cluster.norm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(clust_vars, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor(groups_mat)</span><span class="st">`</span>)</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>skater_plot <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(skater_cluster) <span class="sc">+</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"CLUSTER"</span>, </span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"Set3"</span>,</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Cluster"</span>) <span class="sc">+</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="fu">paste</span>(<span class="st">"Skater Clustering - K:"</span>, n_clust),</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true" tabindex="-1"></a>skater_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="intepreting-results" class="level2">
<h2 class="anchored" data-anchor-id="intepreting-results">3.5 Intepreting Results</h2>
<p>To better understand the crime patterns across West Malaysia, we will utilize a range of visualizations such as parallel coordinates, cluster profiling with barcharts and heatmaps</p>
<section id="comparing-clusters" class="level3">
<h3 class="anchored" data-anchor-id="comparing-clusters">3.5.1 Comparing Clusters</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(hclust_ward_plot, hclust_geo_plot, skater_plot, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Skater is a No-go
</div>
</div>
<div class="callout-body-container callout-body">
<p>The skater clustering technique, appears to be overly reliant on spatial proximity in this case. While it successfully groups geographically contiguous regions, it may not capture the crime patterns. This limitation could result in less insightful clusters that do not adequately differentiate between areas with similar crime characteristics but different spatial locations. Hence we will be ommitting the use of the skater technique for our R application.</p>
</div>
</div>
</section>
<section id="parallel-coordinates-crime" class="level3">
<h3 class="anchored" data-anchor-id="parallel-coordinates-crime">3.5.2 Parallel Coordinates (Crime)</h3>
<p>We will be using parallel coordinates to help intepret and highlight the characteristics of the cluster within the application.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">H-Cluster (Ward)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">H-Cluster (Geo)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Skater-Cluster</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> hclust_ward_cluster.norm, </span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of Crime type by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> hclust_geo_cluster.norm, </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of Crime type by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> skater_cluster.norm, </span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), </span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of Crime type by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="parral-coordinates-demographics" class="level3">
<h3 class="anchored" data-anchor-id="parral-coordinates-demographics">3.5.3 Parral Coordinates (Demographics)</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">H-Cluster (Ward)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">H-Cluster (Geo)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Skater Cluster</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> hclust_ward_cluster.norm, </span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">12</span>), </span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of Demographic by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> hclust_geo_cluster.norm,  </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">12</span>), </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of Demographic by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> skater_cluster.norm,  </span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">12</span>), </span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>,</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alphaLines =</span> <span class="fl">0.2</span>,</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">boxplot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Multiple Parallel Coordinates Plots of Demographic by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> CLUSTER) <span class="sc">+</span> </span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="cluster-profiling" class="level3">
<h3 class="anchored" data-anchor-id="cluster-profiling">3.5.4 Cluster Profiling</h3>
<p>We will also be profiling the different cluster with a comparison with barcharts of the different crime types (per 1000 capita) as well as interactive heatmap to see the bigger picture.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">H-Cluster (Ward)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">H-Cluster (Geo)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Skater Cluster</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>hclust_ward_prof <span class="ot">&lt;-</span> hclust_ward_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CLUSTER) <span class="sc">%&gt;%</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_causing_injury =</span> <span class="fu">mean</span>(causing_injury),</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_murder =</span> <span class="fu">mean</span>(murder),</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_rape =</span> <span class="fu">mean</span>(rape),</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_robbery =</span> <span class="fu">mean</span>(robbery),</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_break_in =</span> <span class="fu">mean</span>(break_in),</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_theft_other =</span> <span class="fu">mean</span>(theft_other),</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_vehicle_theft =</span> <span class="fu">mean</span>(vehicle_theft))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hclust_ward_prof <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>CLUSTER, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>), </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> CLUSTER, <span class="at">y =</span> value, <span class="at">fill =</span> CLUSTER)) <span class="sc">+</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span>  </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cluster Profile (Ward)"</span>) <span class="sc">+</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">as.matrix</span>(hclust_ward_prof[, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hclust_ward_prof)]), </span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">'none'</span>,</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">FALSE</span>, </span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> OrRd,</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> hclust_ward_prof<span class="sc">$</span>CLUSTER,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">50</span>,<span class="cn">NA</span>),</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">10</span>,</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">8</span>,</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Cluster Heatmap (H-Clust)"</span>,</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Crime Indicators"</span>,</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Clusters"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8cd8d7b3bdab34f96f03" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8cd8d7b3bdab34f96f03">{"x":{"data":[{"x":[1,2,3,4,5,6,7],"y":[1,2,3,4,5,6,7],"z":[[0.15229496017212482,0.0038862827057909899,0.038157116802538305,0.44586989250782816,0.46705728969719107,0.65182785327567005,1],[0.1473703780766063,0.011458870630877275,0.086789625830760372,0.075763993417391054,0.32591952342170316,0.70854430062292295,0.4015878923393767],[0.14080883687716808,0.00080254941539194572,0.04516152006749509,0.12701258833190557,0.40302884881328099,0.4674314244434204,0.4574327883837207],[0.082575610797758381,0.00045244965938580285,0.048906869210789218,0.039389774311111896,0.23784190127357938,0.33634767620138134,0.21505771975754406],[0.082436515783208208,0.0027568874536229599,0.033423426405035553,0.069273993774868342,0.21404963887032138,0.24895864511855761,0.28206162495773879],[0.10481170044911013,0.0046391680803307446,0.043533853960178531,0.20184589457951391,0.28149164682912942,0.37017430562313719,0.50354674143637301],[0.074881095930746294,0,0.036529175578487109,0.074347295379426415,0.21517047753744645,0.29401388702044096,0.34850955717188675]],"text":[["row: 7<br>column: mean_causing_injury<br>value: 0.201494","row: 7<br>column: mean_murder<br>value: 0.010000","row: 7<br>column: mean_rape<br>value: 0.054220","row: 7<br>column: mean_robbery<br>value: 0.580300","row: 7<br>column: mean_break_in<br>value: 0.607638","row: 7<br>column: mean_theft_other<br>value: 0.846051","row: 7<br>column: mean_vehicle_theft<br>value: 1.295304"],["row: 6<br>column: mean_causing_injury<br>value: 0.195140","row: 6<br>column: mean_murder<br>value: 0.019771","row: 6<br>column: mean_rape<br>value: 0.116972","row: 6<br>column: mean_robbery<br>value: 0.102745","row: 6<br>column: mean_break_in<br>value: 0.425525","row: 6<br>column: mean_theft_other<br>value: 0.919233","row: 6<br>column: mean_vehicle_theft<br>value: 0.523162"],["row: 5<br>column: mean_causing_injury<br>value: 0.186674","row: 5<br>column: mean_murder<br>value: 0.006021","row: 5<br>column: mean_rape<br>value: 0.063258","row: 5<br>column: mean_robbery<br>value: 0.168872","row: 5<br>column: mean_break_in<br>value: 0.525021","row: 5<br>column: mean_theft_other<br>value: 0.608121","row: 5<br>column: mean_vehicle_theft<br>value: 0.595220"],["row: 4<br>column: mean_causing_injury<br>value: 0.111534","row: 4<br>column: mean_murder<br>value: 0.005569","row: 4<br>column: mean_rape<br>value: 0.068091","row: 4<br>column: mean_robbery<br>value: 0.055811","row: 4<br>column: mean_break_in<br>value: 0.311877","row: 4<br>column: mean_theft_other<br>value: 0.438981","row: 4<br>column: mean_vehicle_theft<br>value: 0.282478"],["row: 3<br>column: mean_causing_injury<br>value: 0.111355","row: 3<br>column: mean_murder<br>value: 0.008543","row: 3<br>column: mean_rape<br>value: 0.048112","row: 3<br>column: mean_robbery<br>value: 0.094371","row: 3<br>column: mean_break_in<br>value: 0.281178","row: 3<br>column: mean_theft_other<br>value: 0.326221","row: 3<br>column: mean_vehicle_theft<br>value: 0.368935"],["row: 2<br>column: mean_causing_injury<br>value: 0.140226","row: 2<br>column: mean_murder<br>value: 0.010971","row: 2<br>column: mean_rape<br>value: 0.061158","row: 2<br>column: mean_robbery<br>value: 0.265431","row: 2<br>column: mean_break_in<br>value: 0.368199","row: 2<br>column: mean_theft_other<br>value: 0.482628","row: 2<br>column: mean_vehicle_theft<br>value: 0.654721"],["row: 1<br>column: mean_causing_injury<br>value: 0.101606","row: 1<br>column: mean_murder<br>value: 0.004985","row: 1<br>column: mean_rape<br>value: 0.052120","row: 1<br>column: mean_robbery<br>value: 0.100917","row: 1<br>column: mean_break_in<br>value: 0.282624","row: 1<br>column: mean_theft_other<br>value: 0.384357","row: 1<br>column: mean_vehicle_theft<br>value: 0.454674"]],"colorscale":[[0,"#FFF7EC"],[0.00045244965938580285,"#FFF7EC"],[0.00080254941539194572,"#FFF7EC"],[0.0027568874536229599,"#FEF6EB"],[0.0038862827057909899,"#FEF6EA"],[0.0046391680803307446,"#FEF6EA"],[0.011458870630877275,"#FEF5E8"],[0.033423426405035553,"#FEF2E1"],[0.036529175578487109,"#FEF2E1"],[0.038157116802538305,"#FEF2E0"],[0.039389774311111896,"#FEF2E0"],[0.043533853960178531,"#FEF1DF"],[0.04516152006749509,"#FEF1DE"],[0.048906869210789218,"#FEF1DE"],[0.069273993774868342,"#FEEED7"],[0.074347295379426415,"#FEEED6"],[0.074881095930746294,"#FEEED6"],[0.075763993417391054,"#FEEED6"],[0.082436515783208208,"#FEEDD4"],[0.082575610797758381,"#FEEDD4"],[0.086789625830760372,"#FEECD3"],[0.10481170044911013,"#FEEACD"],[0.12701258833190557,"#FDE7C7"],[0.14080883687716808,"#FDE5C2"],[0.1473703780766063,"#FDE4C0"],[0.15229496017212482,"#FDE3BE"],[0.20184589457951391,"#FDDCAE"],[0.21404963887032138,"#FDD9A9"],[0.21505771975754406,"#FDD9A9"],[0.21517047753744645,"#FDD9A9"],[0.23784190127357938,"#FDD5A1"],[0.24895864511855761,"#FDD49E"],[0.28149164682912942,"#FDCD97"],[0.28206162495773879,"#FDCD97"],[0.29401388702044096,"#FDCB94"],[0.32591952342170316,"#FDC48E"],[0.33634767620138134,"#FDC28B"],[0.34850955717188675,"#FDC089"],[0.37017430562313719,"#FDBC85"],[0.4015878923393767,"#FCB17B"],[0.40302884881328099,"#FCB07A"],[0.44586989250782816,"#FCA06B"],[0.4574327883837207,"#FC9C67"],[0.46705728969719107,"#FC9964"],[0.4674314244434204,"#FC9964"],[0.50354674143637301,"#FB8C58"],[0.65182785327567005,"#EA593F"],[0.70854430062292295,"#DE412C"],[1,"#7F0000"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"a2d5a863571491dd3e753fcaeadd105f","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FFF7EC"],[0.0033444816053511709,"#FEF6EA"],[0.006688963210702341,"#FEF6E9"],[0.01003344481605351,"#FEF5E8"],[0.013377926421404682,"#FEF5E8"],[0.016722408026755852,"#FEF5E7"],[0.02006688963210702,"#FEF4E6"],[0.023411371237458192,"#FEF4E5"],[0.026755852842809364,"#FEF3E4"],[0.030100334448160532,"#FEF3E3"],[0.033444816053511704,"#FEF2E1"],[0.036789297658862873,"#FEF2E1"],[0.040133779264214041,"#FEF2E0"],[0.043478260869565209,"#FEF1DF"],[0.046822742474916385,"#FEF1DE"],[0.050167224080267553,"#FEF0DD"],[0.053511705685618728,"#FEF0DC"],[0.056856187290969896,"#FEF0DC"],[0.060200668896321065,"#FEEFDA"],[0.06354515050167224,"#FEEFD9"],[0.066889632107023408,"#FEEFD8"],[0.070234113712374577,"#FEEED7"],[0.073578595317725745,"#FEEED6"],[0.076923076923076927,"#FEEDD5"],[0.080267558528428082,"#FEEDD5"],[0.08361204013377925,"#FEEDD4"],[0.086956521739130418,"#FEECD3"],[0.090301003344481601,"#FEECD2"],[0.093645484949832755,"#FEEBD0"],[0.096989966555183924,"#FEEBCF"],[0.10033444816053511,"#FEEACE"],[0.10367892976588629,"#FEEACE"],[0.10702341137123743,"#FEEACD"],[0.11036789297658861,"#FEE9CC"],[0.11371237458193979,"#FEE9CB"],[0.11705685618729093,"#FEE8CA"],[0.12040133779264212,"#FEE8C9"],[0.1237458193979933,"#FDE7C7"],[0.12709030100334448,"#FDE7C7"],[0.13043478260869562,"#FDE7C6"],[0.13377926421404679,"#FDE6C5"],[0.13712374581939799,"#FDE6C3"],[0.14046822742474915,"#FDE5C2"],[0.14381270903010029,"#FDE4C1"],[0.14715719063545149,"#FDE4C0"],[0.15050167224080266,"#FDE4BF"],[0.15384615384615385,"#FDE3BE"],[0.157190635451505,"#FDE2BD"],[0.16053511705685616,"#FDE2BB"],[0.16387959866220736,"#FDE1BA"],[0.1672240802675585,"#FDE1B9"],[0.17056856187290967,"#FDE1B9"],[0.17391304347826084,"#FDE0B7"],[0.17725752508361203,"#FDDFB6"],[0.18060200668896317,"#FDDFB5"],[0.18394648829431434,"#FDDEB4"],[0.18729096989966554,"#FDDDB2"],[0.19063545150501671,"#FDDDB1"],[0.1939799331103679,"#FDDDB1"],[0.19732441471571904,"#FDDCAF"],[0.20066889632107021,"#FDDCAE"],[0.20401337792642141,"#FDDBAD"],[0.20735785953177258,"#FDDAAC"],[0.21070234113712372,"#FDDAAB"],[0.21404682274247491,"#FDD9A9"],[0.21739130434782608,"#FDD9A9"],[0.22073578595317722,"#FDD8A7"],[0.22408026755852842,"#FDD8A6"],[0.22742474916387959,"#FDD7A5"],[0.23076923076923078,"#FDD6A4"],[0.23411371237458189,"#FDD6A3"],[0.23745819397993309,"#FDD5A1"],[0.24080267558528426,"#FDD5A1"],[0.24414715719063546,"#FDD59F"],[0.2474916387959866,"#FDD49E"],[0.25083612040133779,"#FDD39D"],[0.25418060200668896,"#FDD39C"],[0.25752508361204013,"#FDD29C"],[0.2608695652173913,"#FDD19B"],[0.26421404682274247,"#FDD19B"],[0.26755852842809363,"#FDD09A"],[0.2709030100334448,"#FDCF99"],[0.27424749163879597,"#FDCF98"],[0.27759197324414714,"#FDCE98"],[0.28093645484949831,"#FDCD97"],[0.28428093645484948,"#FDCD97"],[0.28762541806020064,"#FDCC96"],[0.29096989966555181,"#FDCB95"],[0.29431438127090298,"#FDCB94"],[0.29765886287625415,"#FDCA94"],[0.30100334448160532,"#FDC993"],[0.30434782608695649,"#FDC892"],[0.30769230769230771,"#FDC892"],[0.31103678929765882,"#FDC891"],[0.31438127090300999,"#FDC790"],[0.31772575250836121,"#FDC68F"],[0.32107023411371233,"#FDC58F"],[0.3244147157190635,"#FDC48E"],[0.32775919732441472,"#FDC48D"],[0.33110367892976589,"#FDC48D"],[0.334448160535117,"#FDC38C"],[0.33779264214046822,"#FDC28B"],[0.34113712374581939,"#FDC18B"],[0.34448160535117056,"#FDC08A"],[0.34782608695652167,"#FDC089"],[0.3511705685618729,"#FDBF88"],[0.35451505016722407,"#FDBF88"],[0.35785953177257523,"#FDBE87"],[0.3612040133779264,"#FDBD86"],[0.36454849498327757,"#FDBD86"],[0.36789297658862874,"#FDBC85"],[0.37123745819397991,"#FDBB84"],[0.37458193979933108,"#FCBA83"],[0.37792642140468224,"#FCBA83"],[0.38127090301003341,"#FCB982"],[0.38461538461538458,"#FCB780"],[0.38795986622073581,"#FCB67F"],[0.39130434782608692,"#FCB47E"],[0.39464882943143809,"#FCB37D"],[0.39799331103678925,"#FCB27C"],[0.40133779264214042,"#FCB17B"],[0.40468227424749165,"#FCB07A"],[0.40802675585284282,"#FCAE78"],[0.41137123745819398,"#FCAD77"],[0.41471571906354515,"#FCAC76"],[0.41806020066889626,"#FCAB75"],[0.42140468227424743,"#FCAA74"],[0.4247491638795986,"#FCA872"],[0.42809364548494983,"#FCA771"],[0.43143812709030099,"#FCA670"],[0.43478260869565216,"#FCA46F"],[0.43812709030100333,"#FCA36E"],[0.44147157190635444,"#FCA26C"],[0.44481605351170561,"#FCA16C"],[0.44816053511705684,"#FCA06A"],[0.451505016722408,"#FC9F69"],[0.45484949832775917,"#FC9D68"],[0.45819397993311034,"#FC9C67"],[0.46153846153846156,"#FC9B66"],[0.46488294314381273,"#FC9964"],[0.46822742474916379,"#FC9864"],[0.47157190635451501,"#FC9762"],[0.47491638795986618,"#FC9661"],[0.47826086956521735,"#FC9460"],[0.48160535117056852,"#FC935F"],[0.48494983277591974,"#FC925E"],[0.48829431438127091,"#FC915C"],[0.49163879598662202,"#FC905C"],[0.49498327759197319,"#FC8F5B"],[0.49832775919732436,"#FC8D59"],[0.50167224080267558,"#FB8C58"],[0.50501672240802675,"#FB8B58"],[0.50836120401337792,"#FA8A57"],[0.51170568561872909,"#FA8957"],[0.51505016722408026,"#FA8857"],[0.51839464882943143,"#FA8756"],[0.52173913043478259,"#F98656"],[0.52508361204013376,"#F98455"],[0.52842809364548493,"#F88355"],[0.5317725752508361,"#F88254"],[0.53511705685618727,"#F88254"],[0.53846153846153844,"#F88053"],[0.5418060200668896,"#F77F53"],[0.54515050167224077,"#F77E52"],[0.54849498327759194,"#F67D52"],[0.55183946488294311,"#F67C51"],[0.55518394648829428,"#F67B51"],[0.55852842809364545,"#F67A51"],[0.56187290969899661,"#F57950"],[0.56521739130434778,"#F57850"],[0.56856187290969895,"#F4774F"],[0.57190635451505012,"#F4754F"],[0.57525083612040129,"#F4744E"],[0.57859531772575246,"#F3734E"],[0.58193979933110362,"#F3734E"],[0.58528428093645479,"#F3724D"],[0.58862876254180596,"#F2704D"],[0.59197324414715713,"#F26F4C"],[0.5953177257525083,"#F26E4B"],[0.59866220735785947,"#F16D4B"],[0.60200668896321063,"#F16C4A"],[0.6053511705685618,"#F16B4A"],[0.60869565217391297,"#F06A4A"],[0.61204013377926425,"#F06949"],[0.61538461538461542,"#EF6749"],[0.61872909698996648,"#EF6648"],[0.62207357859531764,"#EF6548"],[0.62541806020066881,"#EF6448"],[0.62876254180601998,"#EE6346"],[0.63210702341137126,"#ED6245"],[0.63545150501672243,"#ED6044"],[0.6387959866220736,"#EC5E43"],[0.64214046822742465,"#EB5D42"],[0.64548494983277582,"#EA5C41"],[0.64882943143812699,"#EA5A40"],[0.65217391304347816,"#EA593F"],[0.65551839464882944,"#E9583E"],[0.65886287625418061,"#E8563C"],[0.66220735785953178,"#E7543B"],[0.66555183946488294,"#E7533A"],[0.668896321070234,"#E65239"],[0.67224080267558517,"#E65138"],[0.67558528428093645,"#E54F37"],[0.67892976588628762,"#E44E36"],[0.68227424749163879,"#E34C35"],[0.68561872909698995,"#E34B33"],[0.68896321070234112,"#E24A32"],[0.69230769230769229,"#E14831"],[0.69565217391304335,"#E14731"],[0.69899665551839463,"#E04630"],[0.7023411371237458,"#E0442E"],[0.70568561872909696,"#DF422D"],[0.70903010033444813,"#DE412C"],[0.7123745819397993,"#DD402B"],[0.71571906354515047,"#DD3E29"],[0.71906354515050164,"#DD3D29"],[0.72240802675585281,"#DC3C28"],[0.72575250836120397,"#DB3A27"],[0.72909698996655514,"#DA3825"],[0.73244147157190631,"#DA3724"],[0.73578595317725748,"#D93623"],[0.73913043478260865,"#D93422"],[0.74247491638795982,"#D83321"],[0.74581939799331098,"#D73220"],[0.74916387959866215,"#D7301F"],[0.75250836120401332,"#D62E1E"],[0.75585284280936449,"#D52D1D"],[0.75919732441471566,"#D42C1C"],[0.76254180602006683,"#D32B1C"],[0.76588628762541799,"#D2291B"],[0.76923076923076916,"#D1281A"],[0.77257525083612033,"#D02719"],[0.77591973244147161,"#CF2518"],[0.77926421404682267,"#CE2417"],[0.78260869565217384,"#CD2316"],[0.785953177257525,"#CC2216"],[0.78929765886287617,"#CB2015"],[0.79264214046822745,"#CA1F14"],[0.79598662207357851,"#C91E13"],[0.79933110367892979,"#C81C12"],[0.80267558528428085,"#C71B11"],[0.80602006688963201,"#C61A10"],[0.80936454849498329,"#C61910"],[0.81270903010033435,"#C5180F"],[0.81605351170568563,"#C4160E"],[0.81939799331103669,"#C2150D"],[0.82274247491638797,"#C1130C"],[0.82608695652173902,"#C0120B"],[0.8294314381270903,"#BF110A"],[0.83277591973244147,"#BF100A"],[0.83612040133779253,"#BE0F09"],[0.83946488294314381,"#BD0D08"],[0.84280936454849487,"#BC0C07"],[0.84615384615384615,"#BB0A06"],[0.8494983277591972,"#BA0905"],[0.85284280936454848,"#B90805"],[0.85618729096989965,"#B80704"],[0.85953177257525071,"#B70604"],[0.86287625418060199,"#B60403"],[0.86622073578595304,"#B50302"],[0.86956521739130432,"#B40201"],[0.87290969899665538,"#B30000"],[0.87625418060200666,"#B20000"],[0.87959866220735783,"#B00000"],[0.88294314381270889,"#AF0000"],[0.88628762541806017,"#AE0000"],[0.88963210702341122,"#AC0000"],[0.8929765886287625,"#AB0000"],[0.89632107023411367,"#AA0000"],[0.89966555183946484,"#A80000"],[0.90301003344481601,"#A70000"],[0.90635451505016729,"#A60000"],[0.90969899665551834,"#A40000"],[0.9130434782608694,"#A20000"],[0.91638795986622068,"#A10000"],[0.91973244147157185,"#A00000"],[0.92307692307692313,"#9E0000"],[0.92642140468227419,"#9D0000"],[0.92976588628762546,"#9C0000"],[0.93311036789297652,"#9A0000"],[0.93645484949832758,"#990000"],[0.93979933110367886,"#980000"],[0.94314381270903003,"#960000"],[0.94648829431438131,"#950000"],[0.94983277591973236,"#940000"],[0.95317725752508364,"#920000"],[0.9565217391304347,"#900000"],[0.95986622073578587,"#8F0000"],[0.96321070234113704,"#8E0000"],[0.96655518394648821,"#8D0000"],[0.96989966555183948,"#8B0000"],[0.97324414715719054,"#8A0000"],[0.97658862876254182,"#880000"],[0.97993311036789288,"#870000"],[0.98327759197324405,"#860000"],[0.98662207357859533,"#840000"],[0.98996655518394638,"#830000"],[0.99331103678929766,"#810000"],[0.99665551839464872,"#800000"],[1,"#7F0000"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.25","0.50","0.75","1.00","1.25"],"tickvals":[0.1909206019509043,0.38402532939780998,0.57713005684471586,0.77023478429162162,0.96333951173852728],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,7.5],"tickmode":"array","ticktext":["mean_causing_injury","mean_murder","mean_rape","mean_robbery","mean_break_in","mean_theft_other","mean_vehicle_theft"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["mean_causing_injury","mean_murder","mean_rape","mean_robbery","mean_break_in","mean_theft_other","mean_vehicle_theft"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Crime Indicators","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,7.5],"tickmode":"array","ticktext":["7","6","5","4","3","2","1"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["7","6","5","4","3","2","1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.283520132835205},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Clusters","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":50,"r":null,"b":151.43212951432133,"l":100},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Cluster Heatmap (H-Clust)"},"attrs":{"b9d64122b4a6":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>hclust_geo_prof <span class="ot">&lt;-</span> hclust_geo_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CLUSTER) <span class="sc">%&gt;%</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_causing_injury =</span> <span class="fu">mean</span>(causing_injury),</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_murder =</span> <span class="fu">mean</span>(murder),</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_rape =</span> <span class="fu">mean</span>(rape),</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_robbery =</span> <span class="fu">mean</span>(robbery),</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_break_in =</span> <span class="fu">mean</span>(break_in),</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_theft_other =</span> <span class="fu">mean</span>(theft_other),</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_vehicle_theft =</span> <span class="fu">mean</span>(vehicle_theft))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hclust_geo_prof <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>CLUSTER, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>), </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> CLUSTER, <span class="at">y =</span> value, <span class="at">fill =</span> CLUSTER)) <span class="sc">+</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span>  </span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cluster Profile (Geo)"</span>) <span class="sc">+</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">as.matrix</span>(hclust_geo_prof[, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hclust_geo_prof)]), </span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">'none'</span>,</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">FALSE</span>, </span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> OrRd,</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> hclust_geo_prof<span class="sc">$</span>CLUSTER,</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">50</span>,<span class="cn">NA</span>),</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">10</span>,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">8</span>,</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Cluster Heatmap (H-Clust Geo)"</span>,</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Crime Indicators"</span>,</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Clusters"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-75a667d57fed03161764" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-75a667d57fed03161764">{"x":{"data":[{"x":[1,2,3,4,5,6,7],"y":[1,2,3,4,5,6,7],"z":[[0.15224644435320184,0.0038292731677272065,0.03810206865139952,0.44583817855699415,0.46702678834257527,0.6518079267021204,1],[0.17200765626804204,0.002256186734208355,0.17167540837856532,0.082093244405500532,0.5719863685315737,0.92649003308992062,0.58172081055767122],[0.08248104657124361,0,0.048678691042648201,0.043045587000270946,0.26532657332591403,0.35134154196622591,0.23337956152713152],[0.11752332450303708,0.0005728882121322018,0.043536006143244231,0.12531337594607289,0.35741634378321174,0.44053466919969753,0.48060650175083541],[0.089279351315028246,0.0020796230856911934,0.035952172286404092,0.068097441153376098,0.21606438646486981,0.25340547540069636,0.30137479660694383],[0.11080408215368145,0.0068608309777292526,0.043636958290325163,0.175944176559932,0.2657260666413736,0.41601989027635883,0.46510867491273888],[0.071891300917858558,0.00060711194498382949,0.030849614789111426,0.071209027041849352,0.18560347722666659,0.26627160665784022,0.2933400501592513]],"text":[["row: 7<br>column: mean_causing_injury<br>value: 0.201494","row: 7<br>column: mean_murder<br>value: 0.010000","row: 7<br>column: mean_rape<br>value: 0.054220","row: 7<br>column: mean_robbery<br>value: 0.580300","row: 7<br>column: mean_break_in<br>value: 0.607638","row: 7<br>column: mean_theft_other<br>value: 0.846051","row: 7<br>column: mean_vehicle_theft<br>value: 1.295304"],["row: 6<br>column: mean_causing_injury<br>value: 0.226991","row: 6<br>column: mean_murder<br>value: 0.007970","row: 6<br>column: mean_rape<br>value: 0.226563","row: 6<br>column: mean_robbery<br>value: 0.110980","row: 6<br>column: mean_break_in<br>value: 0.743062","row: 6<br>column: mean_theft_other<br>value: 1.200458","row: 6<br>column: mean_vehicle_theft<br>value: 0.755622"],["row: 5<br>column: mean_causing_injury<br>value: 0.111480","row: 5<br>column: mean_murder<br>value: 0.005059","row: 5<br>column: mean_rape<br>value: 0.067867","row: 5<br>column: mean_robbery<br>value: 0.060599","row: 5<br>column: mean_break_in<br>value: 0.347395","row: 5<br>column: mean_theft_other<br>value: 0.458376","row: 5<br>column: mean_vehicle_theft<br>value: 0.306176"],["row: 4<br>column: mean_causing_injury<br>value: 0.156693","row: 4<br>column: mean_murder<br>value: 0.005798","row: 4<br>column: mean_rape<br>value: 0.061231","row: 4<br>column: mean_robbery<br>value: 0.166744","row: 4<br>column: mean_break_in<br>value: 0.466214","row: 4<br>column: mean_theft_other<br>value: 0.573457","row: 4<br>column: mean_vehicle_theft<br>value: 0.625159"],["row: 3<br>column: mean_causing_injury<br>value: 0.120251","row: 3<br>column: mean_murder<br>value: 0.007742","row: 3<br>column: mean_rape<br>value: 0.051446","row: 3<br>column: mean_robbery<br>value: 0.092922","row: 3<br>column: mean_break_in<br>value: 0.283835","row: 3<br>column: mean_theft_other<br>value: 0.332014","row: 3<br>column: mean_vehicle_theft<br>value: 0.393907"],["row: 2<br>column: mean_causing_injury<br>value: 0.148024","row: 2<br>column: mean_murder<br>value: 0.013911","row: 2<br>column: mean_rape<br>value: 0.061362","row: 2<br>column: mean_robbery<br>value: 0.232070","row: 2<br>column: mean_break_in<br>value: 0.347911","row: 2<br>column: mean_theft_other<br>value: 0.541827","row: 2<br>column: mean_vehicle_theft<br>value: 0.605163"],["row: 1<br>column: mean_causing_injury<br>value: 0.097817","row: 1<br>column: mean_murder<br>value: 0.005843","row: 1<br>column: mean_rape<br>value: 0.044863","row: 1<br>column: mean_robbery<br>value: 0.096936","row: 1<br>column: mean_break_in<br>value: 0.244533","row: 1<br>column: mean_theft_other<br>value: 0.348615","row: 1<br>column: mean_vehicle_theft<br>value: 0.383540"]],"colorscale":[[0,"#FFF7EC"],[0.0005728882121322018,"#FFF7EC"],[0.00060711194498382949,"#FFF7EC"],[0.0020796230856911934,"#FEF6EB"],[0.002256186734208355,"#FEF6EB"],[0.0038292731677272065,"#FEF6EA"],[0.0068608309777292526,"#FEF6E9"],[0.030849614789111426,"#FEF3E2"],[0.035952172286404092,"#FEF2E1"],[0.03810206865139952,"#FEF2E0"],[0.043045587000270946,"#FEF1DF"],[0.043536006143244231,"#FEF1DF"],[0.043636958290325163,"#FEF1DF"],[0.048678691042648201,"#FEF1DE"],[0.068097441153376098,"#FEEFD8"],[0.071209027041849352,"#FEEED7"],[0.071891300917858558,"#FEEED7"],[0.082093244405500532,"#FEEDD4"],[0.08248104657124361,"#FEEDD4"],[0.089279351315028246,"#FEECD2"],[0.11080408215368145,"#FEE9CC"],[0.11752332450303708,"#FEE8CA"],[0.12531337594607289,"#FDE7C7"],[0.15224644435320184,"#FDE3BE"],[0.17167540837856532,"#FDE0B8"],[0.17200765626804204,"#FDE0B8"],[0.175944176559932,"#FDDFB6"],[0.18560347722666659,"#FDDEB3"],[0.21606438646486981,"#FDD9A9"],[0.23337956152713152,"#FDD6A3"],[0.25340547540069636,"#FDD39C"],[0.26532657332591403,"#FDD09A"],[0.2657260666413736,"#FDD09A"],[0.26627160665784022,"#FDD09A"],[0.2933400501592513,"#FDCB94"],[0.30137479660694383,"#FDC993"],[0.35134154196622591,"#FDBF88"],[0.35741634378321174,"#FDBE87"],[0.41601989027635883,"#FCAC76"],[0.44053466919969753,"#FCA26D"],[0.44583817855699415,"#FCA06B"],[0.46510867491273888,"#FC9964"],[0.46702678834257527,"#FC9964"],[0.48060650175083541,"#FC935F"],[0.5719863685315737,"#F4754F"],[0.58172081055767122,"#F3734E"],[0.6518079267021204,"#EA593F"],[0.92649003308992062,"#9D0000"],[1,"#7F0000"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"ff03498eb8a84a87418c5becb46c8538","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FFF7EC"],[0.0033444816053511709,"#FEF6EA"],[0.0066889632107023428,"#FEF6E9"],[0.010033444816053514,"#FEF5E8"],[0.013377926421404684,"#FEF5E8"],[0.016722408026755852,"#FEF5E7"],[0.020066889632107027,"#FEF4E6"],[0.023411371237458199,"#FEF4E5"],[0.026755852842809368,"#FEF3E4"],[0.030100334448160536,"#FEF3E3"],[0.033444816053511704,"#FEF2E1"],[0.03678929765886288,"#FEF2E1"],[0.040133779264214055,"#FEF2E0"],[0.043478260869565223,"#FEF1DF"],[0.046822742474916385,"#FEF1DE"],[0.050167224080267567,"#FEF0DD"],[0.053511705685618735,"#FEF0DC"],[0.056856187290969903,"#FEF0DC"],[0.060200668896321072,"#FEEFDA"],[0.06354515050167224,"#FEEFD9"],[0.066889632107023408,"#FEEFD8"],[0.070234113712374591,"#FEEED7"],[0.073578595317725759,"#FEEED6"],[0.076923076923076927,"#FEEDD5"],[0.08026755852842811,"#FEEDD5"],[0.083612040133779278,"#FEEDD4"],[0.086956521739130446,"#FEECD3"],[0.090301003344481615,"#FEECD2"],[0.093645484949832797,"#FEEBD0"],[0.096989966555183951,"#FEEBCF"],[0.10033444816053513,"#FEEACE"],[0.10367892976588629,"#FEEACE"],[0.10702341137123747,"#FEEACD"],[0.11036789297658865,"#FEE9CC"],[0.11371237458193981,"#FEE9CB"],[0.11705685618729099,"#FEE8CA"],[0.12040133779264214,"#FEE8C9"],[0.12374581939799333,"#FDE7C7"],[0.12709030100334448,"#FDE7C7"],[0.13043478260869568,"#FDE7C6"],[0.13377926421404682,"#FDE6C5"],[0.13712374581939801,"#FDE6C3"],[0.14046822742474918,"#FDE5C2"],[0.14381270903010035,"#FDE4C1"],[0.14715719063545152,"#FDE4C0"],[0.15050167224080269,"#FDE4BF"],[0.15384615384615385,"#FDE3BE"],[0.15719063545150502,"#FDE2BD"],[0.16053511705685622,"#FDE2BB"],[0.16387959866220736,"#FDE1BA"],[0.16722408026755856,"#FDE1B9"],[0.17056856187290972,"#FDE1B9"],[0.17391304347826089,"#FDE0B7"],[0.17725752508361206,"#FDDFB6"],[0.18060200668896323,"#FDDFB5"],[0.1839464882943144,"#FDDEB4"],[0.18729096989966557,"#FDDDB2"],[0.19063545150501671,"#FDDDB1"],[0.1939799331103679,"#FDDDB1"],[0.19732441471571907,"#FDDCAF"],[0.20066889632107027,"#FDDCAE"],[0.20401337792642144,"#FDDBAD"],[0.20735785953177258,"#FDDAAC"],[0.21070234113712374,"#FDDAAB"],[0.21404682274247494,"#FDD9A9"],[0.21739130434782611,"#FDD9A9"],[0.2207357859531773,"#FDD8A7"],[0.22408026755852845,"#FDD8A6"],[0.22742474916387961,"#FDD7A5"],[0.23076923076923078,"#FDD6A4"],[0.23411371237458198,"#FDD6A3"],[0.23745819397993312,"#FDD5A1"],[0.24080267558528429,"#FDD5A1"],[0.24414715719063548,"#FDD59F"],[0.24749163879598665,"#FDD49E"],[0.25083612040133779,"#FDD39D"],[0.25418060200668896,"#FDD39C"],[0.25752508361204018,"#FDD29C"],[0.26086956521739135,"#FDD19B"],[0.26421404682274247,"#FDD19B"],[0.26755852842809363,"#FDD09A"],[0.27090301003344486,"#FDCF99"],[0.27424749163879603,"#FDCF98"],[0.27759197324414719,"#FDCE98"],[0.28093645484949836,"#FDCD97"],[0.28428093645484953,"#FDCD97"],[0.2876254180602007,"#FDCC96"],[0.29096989966555187,"#FDCB95"],[0.29431438127090304,"#FDCB94"],[0.2976588628762542,"#FDCA94"],[0.30100334448160537,"#FDC993"],[0.30434782608695654,"#FDC892"],[0.30769230769230771,"#FDC892"],[0.31103678929765888,"#FDC891"],[0.31438127090301005,"#FDC790"],[0.31772575250836121,"#FDC68F"],[0.32107023411371244,"#FDC58F"],[0.32441471571906355,"#FDC48E"],[0.32775919732441472,"#FDC48D"],[0.33110367892976594,"#FDC48D"],[0.33444816053511711,"#FDC38C"],[0.33779264214046822,"#FDC28B"],[0.34113712374581945,"#FDC18B"],[0.34448160535117062,"#FDC08A"],[0.34782608695652178,"#FDC089"],[0.3511705685618729,"#FDBF88"],[0.35451505016722412,"#FDBF88"],[0.35785953177257529,"#FDBE87"],[0.36120401337792646,"#FDBD86"],[0.36454849498327763,"#FDBD86"],[0.3678929765886288,"#FDBC85"],[0.37123745819397996,"#FDBB84"],[0.37458193979933113,"#FCBA83"],[0.3779264214046823,"#FCBA83"],[0.38127090301003347,"#FCB982"],[0.38461538461538458,"#FCB780"],[0.38795986622073581,"#FCB67F"],[0.39130434782608697,"#FCB47E"],[0.39464882943143814,"#FCB37D"],[0.39799331103678931,"#FCB27C"],[0.40133779264214053,"#FCB17B"],[0.4046822742474917,"#FCB07A"],[0.40802675585284287,"#FCAE78"],[0.41137123745819404,"#FCAD77"],[0.41471571906354515,"#FCAC76"],[0.41806020066889632,"#FCAB75"],[0.42140468227424749,"#FCAA74"],[0.42474916387959871,"#FCA872"],[0.42809364548494988,"#FCA771"],[0.43143812709030105,"#FCA670"],[0.43478260869565222,"#FCA46F"],[0.43812709030100339,"#FCA36E"],[0.44147157190635461,"#FCA26C"],[0.44481605351170567,"#FCA16C"],[0.44816053511705689,"#FCA06A"],[0.45150501672240806,"#FC9F69"],[0.45484949832775923,"#FC9D68"],[0.4581939799331104,"#FC9C67"],[0.46153846153846156,"#FC9B66"],[0.46488294314381279,"#FC9964"],[0.46822742474916396,"#FC9864"],[0.47157190635451507,"#FC9762"],[0.47491638795986624,"#FC9661"],[0.47826086956521741,"#FC9460"],[0.48160535117056857,"#FC935F"],[0.4849498327759198,"#FC925E"],[0.48829431438127097,"#FC915C"],[0.49163879598662213,"#FC905C"],[0.4949832775919733,"#FC8F5B"],[0.49832775919732447,"#FC8D59"],[0.50167224080267558,"#FB8C58"],[0.50501672240802675,"#FB8B58"],[0.50836120401337792,"#FA8A57"],[0.51170568561872909,"#FA8957"],[0.51505016722408037,"#FA8857"],[0.51839464882943154,"#FA8756"],[0.52173913043478271,"#F98656"],[0.52508361204013387,"#F98455"],[0.52842809364548493,"#F88355"],[0.5317725752508361,"#F88254"],[0.53511705685618727,"#F88254"],[0.53846153846153855,"#F88053"],[0.54180602006688972,"#F77F53"],[0.54515050167224088,"#F77E52"],[0.54849498327759205,"#F67D52"],[0.55183946488294322,"#F67C51"],[0.55518394648829439,"#F67B51"],[0.55852842809364545,"#F67A51"],[0.56187290969899673,"#F57950"],[0.56521739130434789,"#F57850"],[0.56856187290969906,"#F4774F"],[0.57190635451505023,"#F4754F"],[0.5752508361204014,"#F4744E"],[0.57859531772575257,"#F3734E"],[0.58193979933110374,"#F3734E"],[0.5852842809364549,"#F3724D"],[0.58862876254180607,"#F2704D"],[0.59197324414715724,"#F26F4C"],[0.59531772575250841,"#F26E4B"],[0.59866220735785958,"#F16D4B"],[0.60200668896321075,"#F16C4A"],[0.60535117056856191,"#F16B4A"],[0.60869565217391308,"#F06A4A"],[0.61204013377926425,"#F06949"],[0.61538461538461542,"#EF6749"],[0.61872909698996659,"#EF6648"],[0.62207357859531776,"#EF6548"],[0.62541806020066892,"#EF6448"],[0.62876254180602009,"#EE6346"],[0.63210702341137126,"#ED6245"],[0.63545150501672243,"#ED6044"],[0.63879598662207371,"#EC5E43"],[0.64214046822742488,"#EB5D42"],[0.64548494983277593,"#EA5C41"],[0.6488294314381271,"#EA5A40"],[0.65217391304347827,"#EA593F"],[0.65551839464882944,"#E9583E"],[0.65886287625418072,"#E8563C"],[0.66220735785953189,"#E7543B"],[0.66555183946488305,"#E7533A"],[0.66889632107023422,"#E65239"],[0.67224080267558528,"#E65138"],[0.67558528428093645,"#E54F37"],[0.67892976588628762,"#E44E36"],[0.6822742474916389,"#E34C35"],[0.68561872909699006,"#E34B33"],[0.68896321070234123,"#E24A32"],[0.6923076923076924,"#E14831"],[0.69565217391304357,"#E14731"],[0.69899665551839474,"#E04630"],[0.7023411371237458,"#E0442E"],[0.70568561872909707,"#DF422D"],[0.70903010033444824,"#DE412C"],[0.71237458193979941,"#DD402B"],[0.71571906354515058,"#DD3E29"],[0.71906354515050175,"#DD3D29"],[0.72240802675585292,"#DC3C28"],[0.72575250836120409,"#DB3A27"],[0.72909698996655525,"#DA3825"],[0.73244147157190642,"#DA3724"],[0.73578595317725759,"#D93623"],[0.73913043478260876,"#D93422"],[0.74247491638795993,"#D83321"],[0.7458193979933111,"#D73220"],[0.74916387959866226,"#D7301F"],[0.75250836120401343,"#D62E1E"],[0.7558528428093646,"#D52D1D"],[0.75919732441471577,"#D42C1C"],[0.76254180602006694,"#D32B1C"],[0.76588628762541811,"#D2291B"],[0.76923076923076927,"#D1281A"],[0.77257525083612033,"#D02719"],[0.77591973244147161,"#CF2518"],[0.77926421404682278,"#CE2417"],[0.78260869565217395,"#CD2316"],[0.78595317725752512,"#CC2216"],[0.78929765886287628,"#CB2015"],[0.79264214046822745,"#CA1F14"],[0.79598662207357862,"#C91E13"],[0.79933110367892979,"#C81C12"],[0.80267558528428107,"#C71B11"],[0.80602006688963224,"#C61A10"],[0.8093645484949834,"#C61910"],[0.81270903010033457,"#C5180F"],[0.81605351170568574,"#C4160E"],[0.81939799331103691,"#C2150D"],[0.82274247491638808,"#C1130C"],[0.82608695652173925,"#C0120B"],[0.8294314381270903,"#BF110A"],[0.83277591973244147,"#BF100A"],[0.83612040133779264,"#BE0F09"],[0.83946488294314381,"#BD0D08"],[0.84280936454849498,"#BC0C07"],[0.84615384615384615,"#BB0A06"],[0.84949832775919742,"#BA0905"],[0.85284280936454859,"#B90805"],[0.85618729096989976,"#B80704"],[0.85953177257525093,"#B70604"],[0.8628762541806021,"#B60403"],[0.86622073578595327,"#B50302"],[0.86956521739130443,"#B40201"],[0.8729096989966556,"#B30000"],[0.87625418060200677,"#B20000"],[0.87959866220735805,"#B00000"],[0.88294314381270922,"#AF0000"],[0.88628762541806017,"#AE0000"],[0.88963210702341133,"#AC0000"],[0.8929765886287625,"#AB0000"],[0.89632107023411378,"#AA0000"],[0.89966555183946495,"#A80000"],[0.90301003344481612,"#A70000"],[0.90635451505016729,"#A60000"],[0.90969899665551845,"#A40000"],[0.91304347826086962,"#A20000"],[0.91638795986622079,"#A10000"],[0.91973244147157196,"#A00000"],[0.92307692307692313,"#9E0000"],[0.92642140468227441,"#9D0000"],[0.92976588628762558,"#9C0000"],[0.93311036789297674,"#9A0000"],[0.93645484949832791,"#990000"],[0.93979933110367908,"#980000"],[0.94314381270903014,"#960000"],[0.94648829431438131,"#950000"],[0.94983277591973247,"#940000"],[0.95317725752508364,"#920000"],[0.95652173913043481,"#900000"],[0.95986622073578598,"#8F0000"],[0.96321070234113715,"#8E0000"],[0.96655518394648832,"#8D0000"],[0.9698996655518396,"#8B0000"],[0.97324414715719076,"#8A0000"],[0.97658862876254193,"#880000"],[0.9799331103678931,"#870000"],[0.98327759197324427,"#860000"],[0.98662207357859544,"#840000"],[0.98996655518394661,"#830000"],[0.99331103678929777,"#810000"],[0.99665551839464894,"#800000"],[1,"#7F0000"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.25","0.50","0.75","1.00","1.25"],"tickvals":[0.19087439213967114,0.38399017134815638,0.57710595055664182,0.77022172976512704,0.96333750897361237],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,7.5],"tickmode":"array","ticktext":["mean_causing_injury","mean_murder","mean_rape","mean_robbery","mean_break_in","mean_theft_other","mean_vehicle_theft"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["mean_causing_injury","mean_murder","mean_rape","mean_robbery","mean_break_in","mean_theft_other","mean_vehicle_theft"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Crime Indicators","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,7.5],"tickmode":"array","ticktext":["7","6","5","4","3","2","1"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["7","6","5","4","3","2","1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.283520132835205},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Clusters","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":50,"r":null,"b":151.43212951432133,"l":100},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Cluster Heatmap (H-Clust Geo)"},"attrs":{"b9d623caf493":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>skater_prof <span class="ot">&lt;-</span> skater_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CLUSTER) <span class="sc">%&gt;%</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_causing_injury =</span> <span class="fu">mean</span>(causing_injury),</span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_murder =</span> <span class="fu">mean</span>(murder),</span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_rape =</span> <span class="fu">mean</span>(rape),</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_robbery =</span> <span class="fu">mean</span>(robbery),</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_break_in =</span> <span class="fu">mean</span>(break_in),</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_theft_other =</span> <span class="fu">mean</span>(theft_other),</span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_vehicle_theft =</span> <span class="fu">mean</span>(vehicle_theft))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(skater_prof <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>CLUSTER, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>), </span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> CLUSTER, <span class="at">y =</span> value, <span class="at">fill =</span> CLUSTER)) <span class="sc">+</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span>  </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cluster Profile (Skater)"</span>) <span class="sc">+</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="th_ex03_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">as.matrix</span>(skater_prof[, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(skater_prof)]), </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">'none'</span>,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">FALSE</span>, </span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> OrRd,</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> skater_prof<span class="sc">$</span>CLUSTER,</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">100</span>,<span class="dv">50</span>,<span class="cn">NA</span>),</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">10</span>,</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">8</span>,</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Cluster Heatmap (Skater)"</span>,</span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Crime Indicators"</span>,</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Clusters"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0d548f70c4e76a329150" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0d548f70c4e76a329150">{"x":{"data":[{"x":[1,2,3,4,5,6,7],"y":[1,2,3,4,5,6,7],"z":[[0.15049955451898006,0.021120227325611168,0.03665347386023754,0.026381449781527913,0.11371631157355665,0.18067168746993326,0.28355410555848115],[0.17750284202040667,0.0018155956490724596,0.17715897626787355,0.084444352025541347,0.59146779182442655,0.95836754724827888,0.60154262251203716],[0.1135743241091617,0.0006745220394498737,0.046023997992455032,0.12648398428541832,0.32219105617250504,0.37414037523271942,0.53337823980762034],[0.088932563767198367,0,0.049485968803626483,0.050842256459943308,0.26210478058677966,0.4006037101702235,0.23884475525797591],[0.13284042744731087,0.0035977981392635301,0.034481123348877402,0.44317793560155061,0.41561233675266096,0.67257929006675921,1],[0.092007150632684942,0.0011329944609066521,0.036259613111862668,0.11461301025275064,0.25599537884286944,0.3464553443413344,0.36619002112822785],[0.092365642959929578,0.0016647943751708144,0.037046175648522701,0.070901200175672377,0.24436273932229702,0.27953982360426316,0.29919961806435452]],"text":[["row: 7<br>column: mean_causing_injury<br>value: 0.193328","row: 7<br>column: mean_murder<br>value: 0.032036","row: 7<br>column: mean_rape<br>value: 0.051401","row: 7<br>column: mean_robbery<br>value: 0.038595","row: 7<br>column: mean_break_in<br>value: 0.147472","row: 7<br>column: mean_theft_other<br>value: 0.230942","row: 7<br>column: mean_vehicle_theft<br>value: 0.359200"],["row: 6<br>column: mean_causing_injury<br>value: 0.226991","row: 6<br>column: mean_murder<br>value: 0.007970","row: 6<br>column: mean_rape<br>value: 0.226563","row: 6<br>column: mean_robbery<br>value: 0.110980","row: 6<br>column: mean_break_in<br>value: 0.743062","row: 6<br>column: mean_theft_other<br>value: 1.200458","row: 6<br>column: mean_vehicle_theft<br>value: 0.755622"],["row: 5<br>column: mean_causing_injury<br>value: 0.147295","row: 5<br>column: mean_murder<br>value: 0.006548","row: 5<br>column: mean_rape<br>value: 0.063083","row: 5<br>column: mean_robbery<br>value: 0.163388","row: 5<br>column: mean_break_in<br>value: 0.407367","row: 5<br>column: mean_theft_other<br>value: 0.472130","row: 5<br>column: mean_vehicle_theft<br>value: 0.670644"],["row: 4<br>column: mean_causing_injury<br>value: 0.116575","row: 4<br>column: mean_murder<br>value: 0.005707","row: 4<br>column: mean_rape<br>value: 0.067399","row: 4<br>column: mean_robbery<br>value: 0.069089","row: 4<br>column: mean_break_in<br>value: 0.332460","row: 4<br>column: mean_theft_other<br>value: 0.505121","row: 4<br>column: mean_vehicle_theft<br>value: 0.303463"],["row: 3<br>column: mean_causing_injury<br>value: 0.171313","row: 3<br>column: mean_murder<br>value: 0.010192","row: 3<br>column: mean_rape<br>value: 0.048693","row: 3<br>column: mean_robbery<br>value: 0.558196","row: 3<br>column: mean_break_in<br>value: 0.523831","row: 3<br>column: mean_theft_other<br>value: 0.844180","row: 3<br>column: mean_vehicle_theft<br>value: 1.252360"],["row: 2<br>column: mean_causing_injury<br>value: 0.120408","row: 2<br>column: mean_murder<br>value: 0.007119","row: 2<br>column: mean_rape<br>value: 0.050910","row: 2<br>column: mean_robbery<br>value: 0.148589","row: 2<br>column: mean_break_in<br>value: 0.324844","row: 2<br>column: mean_theft_other<br>value: 0.437616","row: 2<br>column: mean_vehicle_theft<br>value: 0.462219"],["row: 1<br>column: mean_causing_injury<br>value: 0.120855","row: 1<br>column: mean_murder<br>value: 0.007782","row: 1<br>column: mean_rape<br>value: 0.051891","row: 1<br>column: mean_robbery<br>value: 0.094096","row: 1<br>column: mean_break_in<br>value: 0.310342","row: 1<br>column: mean_theft_other<br>value: 0.354196","row: 1<br>column: mean_vehicle_theft<br>value: 0.378705"]],"colorscale":[[0,"#FFF7EC"],[0.0006745220394498737,"#FFF7EC"],[0.0011329944609066521,"#FFF7EB"],[0.0016647943751708144,"#FFF7EB"],[0.0018155956490724596,"#FFF7EB"],[0.0035977981392635301,"#FEF6EA"],[0.021120227325611168,"#FEF4E6"],[0.026381449781527913,"#FEF3E4"],[0.034481123348877402,"#FEF2E1"],[0.036259613111862668,"#FEF2E1"],[0.03665347386023754,"#FEF2E1"],[0.037046175648522701,"#FEF2E1"],[0.046023997992455032,"#FEF1DE"],[0.049485968803626483,"#FEF0DD"],[0.050842256459943308,"#FEF0DD"],[0.070901200175672377,"#FEEED7"],[0.084444352025541347,"#FEECD3"],[0.088932563767198367,"#FEECD2"],[0.092007150632684942,"#FEECD1"],[0.092365642959929578,"#FEEBD1"],[0.1135743241091617,"#FEE9CB"],[0.11371631157355665,"#FEE9CB"],[0.11461301025275064,"#FEE9CB"],[0.12648398428541832,"#FDE7C7"],[0.13284042744731087,"#FDE6C5"],[0.15049955451898006,"#FDE4BF"],[0.17715897626787355,"#FDDFB6"],[0.17750284202040667,"#FDDFB6"],[0.18067168746993326,"#FDDFB5"],[0.23884475525797591,"#FDD5A1"],[0.24436273932229702,"#FDD59F"],[0.25599537884286944,"#FDD39C"],[0.26210478058677966,"#FDD19B"],[0.27953982360426316,"#FDCE98"],[0.28355410555848115,"#FDCD97"],[0.29919961806435452,"#FDCA94"],[0.32219105617250504,"#FDC58F"],[0.3464553443413344,"#FDC08A"],[0.36619002112822785,"#FDBD86"],[0.37414037523271942,"#FDBB84"],[0.4006037101702235,"#FCB17B"],[0.41561233675266096,"#FCAC76"],[0.44317793560155061,"#FCA16C"],[0.53337823980762034,"#F88254"],[0.59146779182442655,"#F26F4C"],[0.60154262251203716,"#F16C4B"],[0.67257929006675921,"#E55038"],[0.95836754724827888,"#900000"],[1,"#7F0000"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"807a350851fa57aa73e76bb4299a4bf9","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FFF7EC"],[0.0033444816053511696,"#FEF6EA"],[0.006688963210702341,"#FEF6E9"],[0.010033444816053512,"#FEF5E8"],[0.013377926421404682,"#FEF5E8"],[0.016722408026755852,"#FEF5E7"],[0.020066889632107024,"#FEF4E6"],[0.023411371237458196,"#FEF4E5"],[0.026755852842809364,"#FEF3E4"],[0.030100334448160536,"#FEF3E3"],[0.033444816053511704,"#FEF2E1"],[0.036789297658862873,"#FEF2E1"],[0.040133779264214048,"#FEF2E0"],[0.043478260869565216,"#FEF1DF"],[0.046822742474916385,"#FEF1DE"],[0.050167224080267574,"#FEF0DD"],[0.053511705685618735,"#FEF0DC"],[0.056856187290969903,"#FEF0DC"],[0.060200668896321072,"#FEEFDA"],[0.06354515050167224,"#FEEFD9"],[0.066889632107023408,"#FEEFD8"],[0.070234113712374591,"#FEEED7"],[0.073578595317725759,"#FEEED6"],[0.076923076923076927,"#FEEDD5"],[0.080267558528428096,"#FEEDD5"],[0.083612040133779264,"#FEEDD4"],[0.086956521739130432,"#FEECD3"],[0.090301003344481601,"#FEECD2"],[0.093645484949832783,"#FEEBD0"],[0.096989966555183951,"#FEEBCF"],[0.10033444816053512,"#FEEACE"],[0.10367892976588629,"#FEEACE"],[0.10702341137123746,"#FEEACD"],[0.11036789297658862,"#FEE9CC"],[0.11371237458193979,"#FEE9CB"],[0.11705685618729095,"#FEE8CA"],[0.12040133779264214,"#FEE8C9"],[0.12374581939799331,"#FDE7C7"],[0.12709030100334448,"#FDE7C7"],[0.13043478260869565,"#FDE7C6"],[0.13377926421404682,"#FDE6C5"],[0.13712374581939799,"#FDE6C3"],[0.14046822742474915,"#FDE5C2"],[0.14381270903010032,"#FDE4C1"],[0.14715719063545149,"#FDE4C0"],[0.15050167224080266,"#FDE4BF"],[0.15384615384615383,"#FDE3BE"],[0.157190635451505,"#FDE2BD"],[0.16053511705685619,"#FDE2BB"],[0.16387959866220736,"#FDE1BA"],[0.16722408026755853,"#FDE1B9"],[0.1705685618729097,"#FDE1B9"],[0.17391304347826086,"#FDE0B7"],[0.17725752508361203,"#FDDFB6"],[0.1806020066889632,"#FDDFB5"],[0.18394648829431437,"#FDDEB4"],[0.18729096989966554,"#FDDDB2"],[0.19063545150501671,"#FDDDB1"],[0.19397993311036787,"#FDDDB1"],[0.19732441471571904,"#FDDCAF"],[0.20066889632107024,"#FDDCAE"],[0.20401337792642138,"#FDDBAD"],[0.20735785953177258,"#FDDAAC"],[0.21070234113712372,"#FDDAAB"],[0.21404682274247491,"#FDD9A9"],[0.21739130434782608,"#FDD9A9"],[0.22073578595317725,"#FDD8A7"],[0.22408026755852842,"#FDD8A6"],[0.22742474916387959,"#FDD7A5"],[0.23076923076923075,"#FDD6A4"],[0.23411371237458189,"#FDD6A3"],[0.23745819397993309,"#FDD5A1"],[0.24080267558528429,"#FDD5A1"],[0.24414715719063543,"#FDD59F"],[0.24749163879598662,"#FDD49E"],[0.25083612040133774,"#FDD39D"],[0.25418060200668896,"#FDD39C"],[0.25752508361204013,"#FDD29C"],[0.2608695652173913,"#FDD19B"],[0.26421404682274247,"#FDD19B"],[0.26755852842809363,"#FDD09A"],[0.2709030100334448,"#FDCF99"],[0.27424749163879597,"#FDCF98"],[0.27759197324414714,"#FDCE98"],[0.28093645484949831,"#FDCD97"],[0.28428093645484948,"#FDCD97"],[0.28762541806020064,"#FDCC96"],[0.29096989966555181,"#FDCB95"],[0.29431438127090298,"#FDCB94"],[0.29765886287625415,"#FDCA94"],[0.30100334448160532,"#FDC993"],[0.30434782608695654,"#FDC892"],[0.30769230769230765,"#FDC892"],[0.31103678929765888,"#FDC891"],[0.31438127090300999,"#FDC790"],[0.31772575250836121,"#FDC68F"],[0.32107023411371238,"#FDC58F"],[0.32441471571906355,"#FDC48E"],[0.32775919732441472,"#FDC48D"],[0.33110367892976583,"#FDC48D"],[0.33444816053511706,"#FDC38C"],[0.33779264214046817,"#FDC28B"],[0.34113712374581939,"#FDC18B"],[0.34448160535117056,"#FDC08A"],[0.34782608695652173,"#FDC089"],[0.3511705685618729,"#FDBF88"],[0.35451505016722407,"#FDBF88"],[0.35785953177257523,"#FDBE87"],[0.3612040133779264,"#FDBD86"],[0.36454849498327757,"#FDBD86"],[0.36789297658862874,"#FDBC85"],[0.37123745819397991,"#FDBB84"],[0.37458193979933108,"#FCBA83"],[0.37792642140468224,"#FCBA83"],[0.38127090301003341,"#FCB982"],[0.38461538461538458,"#FCB780"],[0.38795986622073575,"#FCB67F"],[0.39130434782608697,"#FCB47E"],[0.39464882943143809,"#FCB37D"],[0.39799331103678931,"#FCB27C"],[0.40133779264214048,"#FCB17B"],[0.40468227424749165,"#FCB07A"],[0.40802675585284276,"#FCAE78"],[0.41137123745819398,"#FCAD77"],[0.41471571906354515,"#FCAC76"],[0.41806020066889626,"#FCAB75"],[0.42140468227424743,"#FCAA74"],[0.42474916387959866,"#FCA872"],[0.42809364548494983,"#FCA771"],[0.43143812709030094,"#FCA670"],[0.43478260869565216,"#FCA46F"],[0.43812709030100333,"#FCA36E"],[0.4414715719063545,"#FCA26C"],[0.44481605351170561,"#FCA16C"],[0.44816053511705684,"#FCA06A"],[0.451505016722408,"#FC9F69"],[0.45484949832775917,"#FC9D68"],[0.4581939799331104,"#FC9C67"],[0.46153846153846151,"#FC9B66"],[0.46488294314381268,"#FC9964"],[0.46822742474916379,"#FC9864"],[0.47157190635451507,"#FC9762"],[0.47491638795986618,"#FC9661"],[0.47826086956521735,"#FC9460"],[0.48160535117056857,"#FC935F"],[0.48494983277591974,"#FC925E"],[0.48829431438127086,"#FC915C"],[0.49163879598662202,"#FC905C"],[0.49498327759197325,"#FC8F5B"],[0.49832775919732436,"#FC8D59"],[0.50167224080267547,"#FB8C58"],[0.50501672240802675,"#FB8B58"],[0.50836120401337792,"#FA8A57"],[0.51170568561872909,"#FA8957"],[0.51505016722408026,"#FA8857"],[0.51839464882943143,"#FA8756"],[0.52173913043478259,"#F98656"],[0.52508361204013376,"#F98455"],[0.52842809364548493,"#F88355"],[0.5317725752508361,"#F88254"],[0.53511705685618727,"#F88254"],[0.53846153846153844,"#F88053"],[0.5418060200668896,"#F77F53"],[0.54515050167224077,"#F77E52"],[0.54849498327759194,"#F67D52"],[0.55183946488294311,"#F67C51"],[0.55518394648829428,"#F67B51"],[0.55852842809364545,"#F67A51"],[0.56187290969899661,"#F57950"],[0.56521739130434778,"#F57850"],[0.56856187290969895,"#F4774F"],[0.57190635451505012,"#F4754F"],[0.57525083612040129,"#F4744E"],[0.57859531772575246,"#F3734E"],[0.58193979933110362,"#F3734E"],[0.5852842809364549,"#F3724D"],[0.58862876254180596,"#F2704D"],[0.59197324414715713,"#F26F4C"],[0.5953177257525083,"#F26E4B"],[0.59866220735785958,"#F16D4B"],[0.60200668896321063,"#F16C4A"],[0.6053511705685618,"#F16B4A"],[0.60869565217391308,"#F06A4A"],[0.61204013377926414,"#F06949"],[0.61538461538461531,"#EF6749"],[0.61872909698996648,"#EF6648"],[0.62207357859531776,"#EF6548"],[0.62541806020066881,"#EF6448"],[0.62876254180601998,"#EE6346"],[0.63210702341137126,"#ED6245"],[0.63545150501672243,"#ED6044"],[0.63879598662207349,"#EC5E43"],[0.64214046822742477,"#EB5D42"],[0.64548494983277593,"#EA5C41"],[0.6488294314381271,"#EA5A40"],[0.65217391304347816,"#EA593F"],[0.65551839464882944,"#E9583E"],[0.65886287625418061,"#E8563C"],[0.66220735785953166,"#E7543B"],[0.66555183946488294,"#E7533A"],[0.66889632107023411,"#E65239"],[0.67224080267558528,"#E65138"],[0.67558528428093634,"#E54F37"],[0.67892976588628762,"#E44E36"],[0.68227424749163879,"#E34C35"],[0.68561872909698995,"#E34B33"],[0.68896321070234112,"#E24A32"],[0.69230769230769229,"#E14831"],[0.69565217391304346,"#E14731"],[0.69899665551839463,"#E04630"],[0.7023411371237458,"#E0442E"],[0.70568561872909696,"#DF422D"],[0.70903010033444813,"#DE412C"],[0.7123745819397993,"#DD402B"],[0.71571906354515047,"#DD3E29"],[0.71906354515050164,"#DD3D29"],[0.72240802675585281,"#DC3C28"],[0.72575250836120397,"#DB3A27"],[0.72909698996655514,"#DA3825"],[0.73244147157190631,"#DA3724"],[0.73578595317725748,"#D93623"],[0.73913043478260865,"#D93422"],[0.74247491638795982,"#D83321"],[0.74581939799331098,"#D73220"],[0.74916387959866215,"#D7301F"],[0.75250836120401332,"#D62E1E"],[0.75585284280936449,"#D52D1D"],[0.75919732441471577,"#D42C1C"],[0.76254180602006683,"#D32B1C"],[0.76588628762541799,"#D2291B"],[0.76923076923076916,"#D1281A"],[0.77257525083612033,"#D02719"],[0.7759197324414715,"#CF2518"],[0.77926421404682267,"#CE2417"],[0.78260869565217395,"#CD2316"],[0.785953177257525,"#CC2216"],[0.78929765886287617,"#CB2015"],[0.79264214046822745,"#CA1F14"],[0.79598662207357862,"#C91E13"],[0.79933110367892968,"#C81C12"],[0.80267558528428096,"#C71B11"],[0.80602006688963201,"#C61A10"],[0.80936454849498329,"#C61910"],[0.81270903010033446,"#C5180F"],[0.81605351170568552,"#C4160E"],[0.8193979933110368,"#C2150D"],[0.82274247491638797,"#C1130C"],[0.82608695652173902,"#C0120B"],[0.8294314381270903,"#BF110A"],[0.83277591973244136,"#BF100A"],[0.83612040133779253,"#BE0F09"],[0.83946488294314381,"#BD0D08"],[0.84280936454849487,"#BC0C07"],[0.84615384615384615,"#BB0A06"],[0.84949832775919731,"#BA0905"],[0.85284280936454837,"#B90805"],[0.85618729096989965,"#B80704"],[0.85953177257525082,"#B70604"],[0.86287625418060188,"#B60403"],[0.86622073578595316,"#B50302"],[0.86956521739130432,"#B40201"],[0.87290969899665538,"#B30000"],[0.87625418060200666,"#B20000"],[0.87959866220735794,"#B00000"],[0.882943143812709,"#AF0000"],[0.88628762541806017,"#AE0000"],[0.88963210702341122,"#AC0000"],[0.8929765886287625,"#AB0000"],[0.89632107023411367,"#AA0000"],[0.89966555183946473,"#A80000"],[0.90301003344481601,"#A70000"],[0.90635451505016729,"#A60000"],[0.90969899665551834,"#A40000"],[0.91304347826086951,"#A20000"],[0.91638795986622079,"#A10000"],[0.91973244147157185,"#A00000"],[0.92307692307692302,"#9E0000"],[0.9264214046822743,"#9D0000"],[0.92976588628762535,"#9C0000"],[0.93311036789297652,"#9A0000"],[0.93645484949832758,"#990000"],[0.93979933110367886,"#980000"],[0.94314381270903014,"#960000"],[0.9464882943143812,"#950000"],[0.94983277591973236,"#940000"],[0.95317725752508364,"#920000"],[0.9565217391304347,"#900000"],[0.95986622073578587,"#8F0000"],[0.96321070234113715,"#8E0000"],[0.96655518394648821,"#8D0000"],[0.96989966555183948,"#8B0000"],[0.97324414715719065,"#8A0000"],[0.97658862876254171,"#880000"],[0.97993311036789299,"#870000"],[0.98327759197324405,"#860000"],[0.98662207357859522,"#840000"],[0.98996655518394649,"#830000"],[0.99331103678929755,"#810000"],[0.99665551839464872,"#800000"],[1,"#7F0000"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.25","0.50","0.75","1.00","1.25"],"tickvals":[0.19697275214842647,0.39684129863680334,0.59670984512518033,0.79657839161355715,0.99644693810193419],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,7.5],"tickmode":"array","ticktext":["mean_causing_injury","mean_murder","mean_rape","mean_robbery","mean_break_in","mean_theft_other","mean_vehicle_theft"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["mean_causing_injury","mean_murder","mean_rape","mean_robbery","mean_break_in","mean_theft_other","mean_vehicle_theft"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Crime Indicators","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,7.5],"tickmode":"array","ticktext":["7","6","5","4","3","2","1"],"tickvals":[1,2,3,4,5,6,7],"categoryorder":"array","categoryarray":["7","6","5","4","3","2","1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.283520132835205},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Clusters","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":50,"r":null,"b":151.43212951432133,"l":100},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Cluster Heatmap (Skater)"},"attrs":{"b9d6175f75e":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="ui-storyboard" class="level1">
<h1>4. UI Storyboard</h1>
<section id="flow" class="level2">
<h2 class="anchored" data-anchor-id="flow">4.1 Flow</h2>
<p>For the presentation flow of my application it is structured it as such:</p>
<ol type="1">
<li><p>Variable Exploration: For this section the user can explore the distribution of the variables in different type of plots</p></li>
<li><p>Cluster Configuration: Next the user can use the NbClust tool provided to make informed decision on the no. of clusters to use</p></li>
<li><p>Cluster Results: Where the actual clustering happens, the cluster will be displayed for the user for their configuration with other chart aids</p></li>
<li><p>Further Analysis: Finally the user will be able to analyse and further extract insights from the clustering with parallel coords and cluster profiles</p></li>
</ol>
</section>
<section id="variable-exploration-1" class="level2">
<h2 class="anchored" data-anchor-id="variable-exploration-1">4.2 Variable Exploration</h2>
<p>In this section user can explore the different variables used for clustering and various plot types such Histogram, Density and Boxplot</p>
<p>Input Parameters:</p>
<ol type="1">
<li><p>Year: Year filter on the data</p></li>
<li><p>State: State filter on the data</p></li>
<li><p>District: District filter on the data</p></li>
<li><p>Plot type: Type of plot to use</p></li>
<li><p>Data Standardisation: Toggle data standardisation</p></li>
</ol>
<p>Output:</p>
<ol type="1">
<li>A facet plot of variables distribution</li>
</ol>
<section id="histogram" class="level3">
<h3 class="anchored" data-anchor-id="histogram">4.2.1 Histogram</h3>
<p><img src="assets/ve_1.png" class="img-fluid"></p>
</section>
<section id="density" class="level3">
<h3 class="anchored" data-anchor-id="density">4.2.2 Density</h3>
<p><img src="assets/ve_2.png" class="img-fluid"></p>
</section>
<section id="boxplot-w-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-w-standardisation">4.2.3 Boxplot w/ Standardisation</h3>
<p><img src="assets/ve_3.png" class="img-fluid"></p>
</section>
</section>
<section id="cluster-configuration" class="level2">
<h2 class="anchored" data-anchor-id="cluster-configuration">4.3 Cluster Configuration</h2>
<p>In this section user can experiment and decide how they would like to configure their cluster subsequently.</p>
<p>Input Parameters:</p>
<ol type="1">
<li><p>Year: Year filter on the data</p></li>
<li><p>Style: NbClust or Fviz chart to plot</p></li>
<li><p>Method: Method used for specifc style</p></li>
<li><p>Min Cluster (Only NbClust): Minimum no. of cluster</p></li>
</ol>
<p>Output:</p>
<ol type="1">
<li>Charts/Results from the cluster analysis methods</li>
</ol>
<section id="nbclust" class="level3">
<h3 class="anchored" data-anchor-id="nbclust">4.3.1 NbClust</h3>
<p><img src="assets/cc_1.png" class="img-fluid"></p>
</section>
<section id="fiviz-gap-stats" class="level3">
<h3 class="anchored" data-anchor-id="fiviz-gap-stats">4.3.2 Fiviz (Gap Stats)</h3>
<p><img src="assets/cc_2.png" class="img-fluid"></p>
</section>
</section>
<section id="cluster-results" class="level2">
<h2 class="anchored" data-anchor-id="cluster-results">4.4 Cluster Results</h2>
<p>In this section user can compute the cluster base on the configuration they have entered.</p>
<p>Input Parameters:</p>
<ol type="1">
<li><p>Year: Year filter on the data</p></li>
<li><p>No.&nbsp;of Cluster: Indicate the no. of cluster to compute</p></li>
<li><p>Clustering Method: Hierarchical and Geographically-Constrained Hierarchical (GeoClust) clustering available as well as comparison</p></li>
<li><p>Method (Only Hierarchical): Clustering method</p></li>
<li><p>Style (Only Hierarchical): Clustering on Map or Heatmap option</p></li>
<li><p>Choice Alpha: Configure alpha threshold for Geographically-Constrained clustering</p></li>
</ol>
<p>Output:</p>
<ol type="1">
<li><p>Clusters plotted on the map of West Malaysia</p></li>
<li><p>Dendogram/Choicealpha Chart</p></li>
</ol>
<section id="hierarchical-clustering-1" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-clustering-1">4.4.1 Hierarchical Clustering</h3>
<p><img src="assets/cr_2.png" class="img-fluid"></p>
</section>
<section id="geographically-constrained-clustering" class="level3">
<h3 class="anchored" data-anchor-id="geographically-constrained-clustering">4.4.2 Geographically Constrained Clustering</h3>
<p><img src="assets/cr_1.png" class="img-fluid"></p>
</section>
<section id="hierarchical-clustering-heatmaply" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-clustering-heatmaply">4.4.3 Hierarchical Clustering (Heatmaply)</h3>
<p><img src="assets/cr_3.png" class="img-fluid"></p>
</section>
<section id="cluster-comparison" class="level3">
<h3 class="anchored" data-anchor-id="cluster-comparison">4.4.4 Cluster Comparison</h3>
<p><img src="assets/cr_4.png" class="img-fluid"></p>
</section>
</section>
<section id="further-analysis" class="level2">
<h2 class="anchored" data-anchor-id="further-analysis">4.5 Further Analysis</h2>
<p>In this section user will be able to further intepret the results of the clustering with the aid of individual cluster profiles and the parallel coordinates.</p>
<p>Input Parameters:</p>
<ol type="1">
<li><p>Cluster Result: Clustering result to analyse</p></li>
<li><p>Style: Indicate style of main plot; Cluster profile (Barcharts) or Heatmap</p></li>
<li><p>Parallel Coordinates: Crime or Demographic option</p></li>
<li><p>Boxplot (For Par Coords): Include or omit boxplot</p></li>
<li><p>Standardised (For Par Coords): Indicate if plotted data should be standardised (min-max)</p></li>
</ol>
<p>Output:</p>
<ol type="1">
<li><p>Cluster profile in either Barchart or Heatmap</p></li>
<li><p>Parallel Coordinates of Crime/Demographic by Cluster</p></li>
</ol>
<section id="cluster-profile-para-coord" class="level3">
<h3 class="anchored" data-anchor-id="cluster-profile-para-coord">4.5.1 Cluster Profile &amp; Para Coord</h3>
<p><img src="assets/fa_1.png" class="img-fluid"></p>
</section>
<section id="heatmap-para-coord" class="level3">
<h3 class="anchored" data-anchor-id="heatmap-para-coord">4.5.2 Heatmap &amp; Para Coord</h3>
<p><img src="assets/fa_2.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="reflection" class="level1">
<h1>5. Reflection</h1>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">5.1 Data Wrangling</h2>
<p>Eyeing the data from the site, we presume wrangling would be straightforward however, data cleaning and preparation process proved to be more tedious than anticipated due to inconsistencies in district names and the raw nature of the crime data. Normalizing the crime data by incorporating population data was essential to obtain meaningful insights.</p>
</section>
<section id="skater-clustering-1" class="level2">
<h2 class="anchored" data-anchor-id="skater-clustering-1">5.2 Skater Clustering</h2>
<p>While spatial clustering techniques like Skater can be effective in certain cases, it can vary depending on the specific data. In our case, the Skater clustering results were somewhat limited, primarily identifying geographically contiguous clusters. This highlights the importance of exploring multiple clustering techniques and evaluating their outputs to determine the best technique for our usecase.</p>
<p>Skater (Left) vs H-Clust, K:13 <img src="assets/vs_skater.png" class="img-fluid"></p>
</section>
<section id="storyboarding" class="level2">
<h2 class="anchored" data-anchor-id="storyboarding">5.3 Storyboarding</h2>
<p>The process of developing a compelling story board took up quite a bit of time, as there was quite fair bit that could be done with clustering. However the scope and flow is arguably more important, coming up with a flow that delivers impactful findings and value to user is more crucial than the amount of charts visualized.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>