{
  "hash": "5c8eaa80dc9249539e53dd598f6ff1e6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Jeffery Lau\"\ndate: 09-07-2024\ndate-modified: \"last-modified\"\ndescription: |\n  In this exercise, We will be analyzing armed conflict data in Myanmar, using spatial point pattern analysis to understand the distribution and relationships between conflict events. We'll also create maps to visualize the results and interpret the spatial patterns.\ncategories:\n  - Take-home\nformat:\n  html:\n    toc: true\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n# 1. Introduction\n\n## 1.1 Context\n\nIn 2024 armed conflict continues to be a devastating global issue, with millions of people affected each year. Recent years have seen a surge in conflicts, driven by factors such as political instability, regional tensions, and resource scarcity. Myanmar, in particular, has experienced significant armed conflict in recent years, including the 2021 military coup and subsequent violence.\n\nTODO: Lit review\n\n## 1.2 Objectives\n\n1.  Analyze the spatial distribution of armed conflict events in Myanmar.\n2.  Identify patterns and trends in the temporal distribution of conflict events.\n3.  Identify potential hotspots of conflict activity.\n4.  Provide insights for policymakers and humanitarian organizations working to address the conflict in Myanmar.\n\n# 2. Setup\n\n## 2.1 Loading Packages\n\nIn this project we will be using the following packages:\n\n-   **`tmap`:** A package for creating thematic maps in R. It provides a simple and flexible interface for customizing maps and exporting them in various formats.\n\n-   **`sf`:** A package for simple feature data, which is a modern standard for representing geographic features. It provides efficient data structures and functions for spatial operations.\n\n-   **`raster`:** A package for working with raster data, such as images and digital elevation models. It offers tools for reading, writing, manipulating, and analyzing raster data.\n\n-   **`spatstat`:** A package for spatial point pattern analysis. It provides functions for analyzing the distribution and relationships between points in a study area.\n\n-   **`maptools`:** A package for reading and writing various spatial data formats, including shapefiles and KML. It also provides tools for converting between different spatial data structures.\n\n-   **`sp`:** A package for spatial data in R. It provides classes and functions for representing and manipulating spatial data, such as points, lines, and polygons.\n\n-   **`tidyverse`:** A collection of R packages designed for data manipulation, visualization, and analysis. It includes packages like dplyr, ggplot2, and tidyr, which are commonly used in data science workflows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tmap, sf, raster, spatstat, sparr, maptools, sp, tidyverse, DT, gridExtra, animation)\n```\n:::\n\n\n## 2.2 Loading Data\n\nThe dataset used in this analysis is sourced from the Armed Conflict Location & Event Data (ACLED) database. It contains information on various types of armed conflict events, including Battles, Explosion/Remote violence, Strategic developments, Protest, Riots, and Violence against civilians. The data covers the period from January 2021 to June 2024 and provides specific details such as event date, location coordinates, actor information, and more.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read CSV files\nacled_2021_23 <- read_csv(\"data/aspatial/2021-2023-Myanmar.csv\")\nacled_2024 <- read_csv(\"data/aspatial/2024-Myanmar.csv\")\n```\n:::\n\n\nNext we load [Myanmar District and State Boundary](https://www.themimu.info/) from Myanmar Information Management Unit (MIMU) and projected onto the correct CRS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read Myanmar Boundary\nmym_sf <- st_read(dsn = \"data/geospatial\", \n                      layer = \"mmr_polbnda_adm2_250k_mimu\") %>%\n              st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda_adm2_250k_mimu' from data source \n  `/Users/jeffery/Projects/Y4S1/IS415/S0methingSimple/IS415-GAA/take-home_ex/ex01/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 80 features and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nmym_st_sf <- st_read(dsn = \"data/geospatial\", \n                      layer = \"mmr_polbnda_adm1_250k_mimu_1\") %>%\n              st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `/Users/jeffery/Projects/Y4S1/IS415/S0methingSimple/IS415-GAA/take-home_ex/ex01/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n# 3. Data Wrangling and Exploration\n\n## 3.1 CRS Projection & Formatting\n\nThe initial step involved reading the ACLED data into R and converting it into a sf data frame, specifying the longitude and latitude columns as coordinates and the WGS84 coordinate reference system (CRS). To ensure consistency with the administrative boundary data, the CRS was projected to EPSG:32647.\n\nAdditional data cleaning and preparation steps were performed, including handling missing values and formatting dates.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine data frames\nacled_combined <- bind_rows(acled_2021_23, acled_2024)\n\nacled_full_sf <- acled_combined %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %>%\n  st_transform(crs = 32647) %>%\n  mutate(event_date = dmy(event_date))\n```\n:::\n\n\n## 3.2 Data Cleaning\n\nWe conducted a preliminary data quality check on our key spatial features to ensure data integrity. While no missing values were found in the columns, we did identify duplicate geometries. This is not unexpected, as the data represents a time series, and multiple events may occur in the same location over time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check for null values in key columns\nna_count <- acled_full_sf %>%\n  summarise(na_geometry = sum(is.na(geometry)),\n            na_event_date = sum(is.na(event_date)))\n\n# Check for null values in key columns\nduplicate_count <- acled_full_sf %>%\n  summarise(duplicate_event_id = sum(duplicated(event_id_cnty)),\n            duplicate_geometry = sum(duplicated(geometry)))\n\nprint(na_count)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -208804.4 ymin: 1103500 xmax: 640934.5 ymax: 3042960\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 1 × 3\n  na_geometry na_event_date                                             geometry\n        <int>         <int>                                     <MULTIPOINT [m]>\n1           0             0 ((-208804.4 2357274), (-207135 2358896), (-206931.7…\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(duplicate_count)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 2 fields\nGeometry type: MULTIPOINT\nDimension:     XY\nBounding box:  xmin: -208804.4 ymin: 1103500 xmax: 640934.5 ymax: 3042960\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 1 × 3\n  duplicate_event_id duplicate_geometry                                 geometry\n               <int>              <int>                         <MULTIPOINT [m]>\n1                  0              44101 ((-208804.4 2357274), (-207135 2358896)…\n```\n\n\n:::\n:::\n\n\n## 3.3 Data Wrangling\n\nTo prepare our dataframe for subsequent geoprocessing, we performed necessary data joining and processing steps. We then saved the processed state of the dataframe for future reference and analysis.\n\n### 3.3.1 Joining with District Data\n\nWe will start by adding the district and state into our `acled_sf` dataframe using a spatial join\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- st_join(acled_full_sf, mym_sf) %>%\n  dplyr::select(event_date, event_type, fatalities, ST, DT, admin1, geometry) %>%\n  rename(state = ST, district = DT)\n```\n:::\n\n\n### 3.3.2 Missing Fields (State)\n\nUpon joining the dataframes, we observed that a small number of points were located outside the boundary dataframe. However, this is not a significant concern for our subsequent analysis, as we will be focusing on other states.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatatable(acled_sf %>% \n        filter(is.na(state)) %>%\n        dplyr::select(event_date, event_type, admin1)\n      )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8c013258561750cd1cd6\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8c013258561750cd1cd6\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"],[\"2023-09-21\",\"2023-08-31\",\"2023-05-13\",\"2023-05-12\",\"2023-05-11\",\"2022-07-23\",\"2021-03-22\"],[\"Violence against civilians\",\"Violence against civilians\",\"Battles\",\"Battles\",\"Battles\",\"Strategic developments\",\"Violence against civilians\"],[\"Rakhine\",\"Tanintharyi\",\"Kayin\",\"Kayin\",\"Kayin\",\"Ayeyarwady\",\"Rakhine\"],[{\"type\":\"Point\",\"coordinates\":[-169820.8584943655,2310506.951708449]},{\"type\":\"Point\",\"coordinates\":[479880.3428390799,1306490.492467028]},{\"type\":\"Point\",\"coordinates\":[464878.667450522,1805057.742023089]},{\"type\":\"Point\",\"coordinates\":[464878.667450522,1805057.742023089]},{\"type\":\"Point\",\"coordinates\":[464878.667450522,1805057.742023089]},{\"type\":\"Point\",\"coordinates\":[15981.32365229138,1894240.838619072]},{\"type\":\"Point\",\"coordinates\":[-169820.8584943655,2310506.951708449]}]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>event_date<\\/th>\\n      <th>event_type<\\/th>\\n      <th>admin1<\\/th>\\n      <th>geometry<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"event_date\",\"targets\":1},{\"name\":\"event_type\",\"targets\":2},{\"name\":\"admin1\",\"targets\":3},{\"name\":\"geometry\",\"targets\":4}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### 3.3.3 Adding Quarter and Saving RDS\n\nWe will also be extracting out the quarters and years for our subsequent analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate(quarter = quarter(event_date, with_year = TRUE)) %>%\n  mutate(year = year(event_date)) %>%\n  dplyr::select(-admin1)\n\nacled_sf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 51553 features and 7 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -208804.4 ymin: 1103500 xmax: 640934.5 ymax: 3042960\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 51,553 × 8\n   event_date event_type     fatalities state district            geometry\n   <date>     <chr>               <dbl> <chr> <chr>            <POINT [m]>\n 1 2023-12-31 Explosions/Re…          0 Mon   Mawlamy…  (393190.2 1690159)\n 2 2023-12-31 Explosions/Re…          0 Rakh… Maungdaw (-183852.6 2305258)\n 3 2023-12-31 Battles                 4 Bago… Thayarw…    (165427 2062239)\n 4 2023-12-31 Strategic dev…          0 Bago… Thayarw…    (165427 2062239)\n 5 2023-12-31 Explosions/Re…          1 Saga… Katha     (202852.5 2640880)\n 6 2023-12-31 Battles                 0 Shan… Muse      (391530.9 2594611)\n 7 2023-12-31 Explosions/Re…          0 Mon   Mawlamy…  (391095.1 1692216)\n 8 2023-12-31 Battles                 1 Saga… Monywa    (115044.9 2432742)\n 9 2023-12-31 Violence agai…          1 Saga… Kanbalu   (153264.2 2542964)\n10 2023-12-31 Violence agai…          1 Mon   Thaton    (335571.8 1837874)\n# ℹ 51,543 more rows\n# ℹ 2 more variables: quarter <dbl>, year <dbl>\n```\n\n\n:::\n:::\n\n\n### 3.3.4 Saving `sf` Dataframe\n\nNext we store the processed `sf` dataframe as rds for subsequent usage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(acled_sf, \"data/rds/acled_sf.rds\")\nwrite_rds(mym_sf, \"data/rds/mym_sf.rds\")\nwrite_rds(mym_st_sf, \"data/rds/mym_st_sf.rds\")\n```\n:::\n\n\n# 4. Exploratory Data Analysis\n\nTo gain a deeper understanding of our data and inform subsequent analysis decisions, we conducted an in-depth exploration of the relationships between various variables and their spatial distribution.\n\nBefore we begin our EDA, let's load the rds back into our R environment\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_rds(\"data/rds/acled_sf.rds\")\nmym_sf <- read_rds(\"data/rds/mym_sf.rds\")\nmym_st_sf <- read_rds(\"data/rds/mym_st_sf.rds\")\n```\n:::\n\n\n## 4.1 Selecting Area of Study\n\nTo identify suitable areas for in-depth analysis, we examined the overall distribution of conflict events across Myanmar. This initial exploration helped us select regions of particular interest for further investigation.\n\n### 4.1.1 Overall Distribution (Points)\n\nOur initial visualization of conflict events on the map of Myanmar revealed distinct clusters around the central regions of Sagaing, Mandalay, and Magway. This observation suggests that these areas may have experienced higher concentrations of conflict activity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_m <- tm_shape(mym_st_sf) +\n  tm_polygons() +\n  tm_text(\"ST\", size = 0.5) +\n  tm_layout(title = \"State\")\n\ndistribution_m <- tm_shape(mym_st_sf) +\n  tm_polygons() +\n  tm_shape(acled_sf) +\n  tm_dots(col = \"red\", alpha = 0.03, size = 0.01) +\n  tm_layout(title = \"Distribution\")\n\ntmap_arrange(state_m, distribution_m, asp = 1, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### 4.1.2 Overall Distribution (Districts)\n\nTo further validate our previous observations, we created a choropleth map to visualize the spatial distribution of conflict events. This map confirmed the concentration of conflict activity in the central states.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_by_district <- acled_sf %>%\n  group_by(district) %>%\n  summarize(event_count = n())\n\n# Join the event count data with the region polygon data\njoined_data <- st_join(mym_sf, acled_by_district)\n\nchoropleth_m <- tm_shape(joined_data) +\n  tm_polygons(col = \"event_count\", style = \"jenks\", palette = \"YlOrRd\") +\n  tm_layout(title = \"Event Count\")\n\ntmap_arrange(state_m, choropleth_m, asp = 1, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### 4.1.3 Event Count by State\n\nThe following datatables shows that over the four-year period, Sagaing, Mandalay, and Magway experienced the highest number of conflict events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_table <- acled_sf %>%\n  st_drop_geometry() %>% # Remove geometry for faster processing\n  group_by(state) %>%\n  tally(name = \"event_count\") %>%\n  arrange(desc(event_count))\n\ndatatable(summary_table)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-5552547b9e49377e6bf1\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5552547b9e49377e6bf1\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\"],[\"Sagaing\",\"Mandalay\",\"Magway\",\"Yangon\",\"Shan (North)\",\"Kachin\",\"Tanintharyi\",\"Rakhine\",\"Kayin\",\"Mon\",\"Chin\",\"Shan (South)\",\"Bago (East)\",\"Kayah\",\"Ayeyarwady\",\"Bago (West)\",\"Nay Pyi Taw\",\"Shan (East)\",null],[14043,5047,4585,3893,3435,3198,2849,2341,1979,1878,1742,1534,1410,1398,1061,718,340,95,7]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>state<\\/th>\\n      <th>event_count<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"state\",\"targets\":1},{\"name\":\"event_count\",\"targets\":2}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n::: callout-note\n##### Selected State\n\nWhile Sagaing and Mandalay have received significant attention due to their higher levels of conflict and population density, we have chosen to focus our analysis on Magway. This state offers a unique perspective due to its diverse ethnic composition, including Chin, Rakhine, Shan, and Karen populations. By examining Magway, we can gain valuable insights into the potential spillover effects from neighboring conflict zones and conduct a more in-depth analysis of the state's internal dynamics.\n:::\n\n## 4.2 Viewing the timeline\n\nTo understand the temporal dynamics of conflict and its spatial distribution, we will analyze the data for the selected states. Before proceeding, we will partition the conflict and boundary dataframes into three groups: the three states of interest and Magway alone. This separation will allow us to focus on specific regions and analyze their unique characteristics.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for Magway Surrounding Neigbours\nacled_msm_sf <- acled_sf %>%\n  filter(state %in% c(\"Magway\", \"Sagaing\", \"Mandalay\"))\n\nmsm_sf <- mym_st_sf %>%\n  filter(ST %in% c(\"Magway\", \"Sagaing\", \"Mandalay\"))\n\n# Filter for \"Magway\" in both data frames\nacled_sf <- acled_sf %>%\n  filter(state == \"Magway\")\n\nmagway_sf <- mym_sf %>%\n  filter(ST == \"Magway\")\n```\n:::\n\n\n### 4.2.1 Histogram of Events (Magway)\n\nFrom the histogram of event types reveals that the events were initially dominated by protests, the frequency of battles has steadily increased, while protests have declined. Although the overall number of conflict events has shown a general downward trend since its peak in 2022, battles currently constitute the majority of incidents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(acled_sf, aes(x = event_date, fill = event_type)) +\n  geom_histogram(binwidth = 15, position = \"stack\") +\n  scale_fill_brewer(palette = \"Spectral\") +\n  labs(title = \"Stacked Histogram of Event Dates by Event Type\",\n       x = \"Event Date\",\n       y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### 4.2.2 Distribution of Events (Magway)\n\nOur pie charts further validates the observation that protests were more prevalent at the beginning of the time period, while battles have become more frequent in recent months. This shift in the composition of conflict events highlights the evolving dynamics of the conflict.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data by year\nyear_acled_sf <- list()\nfor (yr in 2021:2024) {\n  year_acled_sf[[yr - 2020]] <- acled_sf %>% filter(year == yr)\n}\n\n# Create pie charts for each year\netc_plot <- list()\nyr<-0\nfor (year_acled in year_acled_sf) {\n  yr<-yr+1\n  etc_plot[[yr]] <- ggplot(year_acled  %>% count(event_type), aes(x = \"\", y = n, fill = event_type)) +\n  geom_bar(stat = \"identity\", color = \"white\") +\n  geom_text(aes(label = n), position = position_stack(vjust = 0.5)) +\n  coord_polar(theta = \"y\") +\n  scale_fill_brewer(palette = \"Spectral\") +\n  labs(title = as.character(yr+2020)) +\n  theme_void()\n}\n\n# Arrange the charts in a 2x2 grid\ngrid.arrange(etc_plot[[1]], etc_plot[[2]], etc_plot[[3]], etc_plot[[4]], ncol = 2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nWe can also see in following majoritiy of the events occur on the northern border with Sagaing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmagway_plot <- list()\n\nyr<-0\nfor (year_acled in year_acled_sf) {\n  yr <- yr + 1\n  magway_plot[[yr]] <- tm_shape(magway_sf) +\n  tm_polygons() +\n  tm_shape(year_acled) +\n  tm_dots(col = \"event_type\", alpha = 0.5, size = 0.1, palette = \"Spectral\") +\n  tm_layout(title = paste(\"Events \", as.character(yr + 2020)))\n}\n\ntmap_arrange(magway_plot, asp = 2, nrow = 2, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## 4.3 Event/Fatalities Insights\n\nOur boxplot also suggests that battles are associated with the highest number of fatalities, while protests generally have lower fatality counts. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(acled_sf, aes(x = event_type, y = fatalities)) +\n  geom_boxplot(color = \"darkorange\") +\n  labs(title = \"Relationship Between Fatalities and Event Type\",\n       x = \"Event Type\",\n       y = \"Fatalities\") +\n  coord_flip() +\n  theme(axis.text.y = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n##### Selection of Event Type\n\nGiven the distinct patterns observed in fatalities and the development of event types, we will focus our subsequent analysis on Battles, Explosions, Violence against Civilians, and Protests. \n\n:::\n\n# 5. Spatial Point Pattern Analysis\n\nTo gain a deeper understanding of the conflict dynamics within Magway State, we will examine the spatial distribution and patterns of conflict events. This analysis will provide valuable insights into the concentration of incidents, potential hotspots, and the relationships between conflict and underlying factors.\n\n## 5.1 Preparation\n\nTo streamline our analysis, we have created reusable functions for common tasks. These functions facilitate the conversion of data to ppp format, confinement to specific regions, jittering for spatial randomness, rescaling, and the transformation of KDE results into raster format.\n\n### 5.1.1 Convert and Rescale\n\nIn this function we perform the following:\n1. Convert event `sf` to `ppp`\n2. Convert boundary `sf` to `ppp`\n3. Jitter any duplicates (If any)\n4. Rescale from m to km \n\n\n::: {.cell}\n\n```{.r .cell-code}\nrescale_ppp_km <- function(ppp_sf, owin_sf) {\n  # Converting sf to ppp\n  ppp <- as.ppp(ppp_sf)\n  \n  # Converting sf to owin\n  owin <- as.owin(owin_sf %>% st_union())\n  \n  # Apply jitter duplicate exist\n  if (any(duplicated(ppp))) {\n    ppp <- rjitter(ppp,\n                   retry = TRUE,\n                   nsimm = 1,\n                   drop = TRUE)\n  }\n\n  # Confine and rescale ppp\n  return(rescale(ppp[owin], 1000, \"km\"))\n}\n```\n:::\n\n\n### 5.1.2 Convert KDE to Raster\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_to_raster <- function(kde) {\n  kde_raster <- raster(as.SpatialGridDataFrame.im(kde))\n  projection(kde_raster) <- CRS(\"+init=EPSG:32647\")\n  return(kde_raster)\n}\n```\n:::\n\n\n### 5.1.3 Prepping PPP\n\nNext lets prep the ppp objects for later use\n\n#### 5.1.3.1 Magway\n\n::: panel-tabset\n##### PPP\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_sf, magway_sf)\n\nplot(acled_ppp_km)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n##### Map Boundary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = magway_sf) +\n  geom_sf(fill = \"lightblue\") +\n  geom_sf_label(aes(label = DT), size = 3, repel = TRUE) +\n  labs(title = \"District Boundaries\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n:::\n\n#### 5.1.3.2 Magway, Sagaing & Mandalay\n\n::: panel-tabset\n##### PPP\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_msm_ppp_km <- rescale_ppp_km(acled_msm_sf, msm_sf)\n\nplot(acled_msm_ppp_km)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n##### Map Boundary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = msm_sf) +\n  geom_sf(fill = \"lightblue\") +\n  geom_sf_label(aes(label = ST), size = 3, repel = TRUE) +\n  labs(title = \"State Boundaries\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n:::\n\n## 5.2 First Order Analysis\n\nOur initial analysis focuses on visualizing the spatial distribution of conflict events on inter-state, state and district level, across the time and event types using the `density` from the Spatstat package to derive the kernel density of area of study\n\n### 5.2.1 Picking a Density BW\n\nWe will be starting with finding a suitable Bandwidth for our data. As the area of study is large, making point events sparse, the bandwidth needs to be carefully considered for the best representation.\n\n::: panel-tabset\n#### PPL\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_kde_ppl = density(acled_ppp_km, \n                        sigma = bw.ppl, \n                        edge = TRUE, \n                        kernel = \"gaussian\")\n\nplot(acled_ppp_kde_ppl, main = \"PPL bandwidth\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n#### Scott\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_kde_scott = density(acled_ppp_km, \n                        sigma = bw.scott,\n                        edge = TRUE, \n                        kernel = \"gaussian\")\n\nplot(acled_ppp_kde_scott, main = \"Scott bandwidth\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n#### Adaptive\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_kde_adaptive <- adaptive.density(acled_ppp_km, method=\"kernel\")\n\nplot(acled_ppp_kde_adaptive, main = \"Adaptive bandwidth\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n#### Manual (10km)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_kde_man = density(acled_ppp_km, \n                        sigma = 10,\n                        edge = TRUE, \n                        kernel = \"gaussian\")\n\nplot(acled_ppp_kde_man, main = \"Manual bandwidth (10km)\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n:::\n\nGiven the relatively sparse distribution of points within our study area, a manual bandwidth of 10km is deemed appropriate for the kernel density estimation. This bandwidth setting provides a suitable balance between capturing spatial patterns and avoiding excessive smoothing\n\n### 5.2.2 Inter-state Spatial Relations\n\nTo understand the potential influence of neighboring states on conflict dynamics within Magway, we will conduct a spatial analysis using a bandwidth of 15km, reflecting the larger geographical extent involved. This analysis will help us identify any spillover effects or sequential patterns of conflict across borders.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_results <- list()\nfor (yr in 2021:2024) {\n  acled_msm_ppp_km <- rescale_ppp_km(acled_msm_sf %>% filter(year == yr), msm_sf)\n  acled_msm_ppp_kde <- density(acled_msm_ppp_km, sigma = 15, edge = TRUE, kernel = \"gaussian\")\n  kde_results[[yr - 2020]] <- acled_msm_ppp_kde\n}\n\npar(mfrow=c(1,5), mar=c(1,1,1,1))\nyr <- 2020\nfor (res in kde_results) {\n  yr <- yr + 1\n  plot(res, main = as.character(yr))\n}\n\nplot(st_geometry(msm_sf), col = \"lightblue\", main = \"State\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n\n#### Observation\n\nNotice the initial clusters forming in Mandalay. Subsequently, the clusters within Sagaing expanded towards the border between with Magway, eventually spilling over into Magway. Suggesting a strong influence of neighboring regions on conflict dynamics within Magway.\n\n::: \n\n### 5.2.3 State Analysis (Magway)\n\nNext we will delve into the state level, by exploring spatial patterns within Magway's districts, we can identify areas of high concentration, potential hotspots, and the evolution of conflict over quarter\n\n#### 5.2.3.1 Quarterly KDE (Magway)\n\nAt a closer look we can observe the events tend to form hotspots closer to the border with Sagaing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_quarters <- unique(acled_sf$quarter) %>% sort()\n\n# Create an empty list to store KDE results\nquart_kde_results <- list()\n\n# Iterate through unique quarters\nq <- 0\nfor (quart in unique_quarters) {\n  q <- q + 1\n  acled_ppp_km <- rescale_ppp_km(acled_sf %>% filter(quarter == quart), magway_sf)\n  acled_ppp_kde <- density(acled_ppp_km, sigma = 15, edge = TRUE, kernel = \"gaussian\")\n  quart_kde_results[[q]] <- acled_ppp_kde\n}\n\n\npar(mfrow=c(4,4), mar=c(1,1,1,1))\n# Create a data frame for plotting\ni <- 0\nfor (res in quart_kde_results) {\n  i <- i + 1\n  r <- ifelse(i %% 4 == 0, 4, i %% 4)\n  plot(res, \n       override.par = F,\n       fix.range = T,\n       main = paste(as.character(2021+as.integer((i-1)/4)), \"Q\", r))\n}\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n#### 5.2.3.2 Summary by district\n\nThe following are the summary statistics of the districts in Magway by Year, Event type and Year-Event type. Of all districts the one worst affected is Pakokku\n\n::: panel-tabset\n##### Yearly\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group by district, year, and event_type, then count events\nacled_grouped <- acled_sf %>%\n  st_drop_geometry() %>% \n  group_by(district, year) %>%\n  summarize(count = n()) %>%\n  pivot_wider(names_from = year, values_from = count, values_fill = 0)\n\n# Create a data table\ndatatable(acled_grouped)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-86e6843344df792a7027\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-86e6843344df792a7027\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],[\"Gangaw\",\"Magway\",\"Minbu\",\"Pakokku\",\"Thayet\"],[246,329,107,519,73],[390,55,70,1047,58],[262,52,36,881,61],[60,30,24,257,28]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>district<\\/th>\\n      <th>2021<\\/th>\\n      <th>2022<\\/th>\\n      <th>2023<\\/th>\\n      <th>2024<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"district\",\"targets\":1},{\"name\":\"2021\",\"targets\":2},{\"name\":\"2022\",\"targets\":3},{\"name\":\"2023\",\"targets\":4},{\"name\":\"2024\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n##### Event Type\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group by district, year, and event_type, then count events\nacled_grouped <- acled_sf %>%\n  st_drop_geometry() %>% \n  group_by(district, event_type) %>%\n  summarize(count = n()) %>%\n  pivot_wider(names_from = event_type, values_from = count, values_fill = 0)\n\n# Create a data table\ndatatable(acled_grouped)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-3cffd77414d70d64f295\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3cffd77414d70d64f295\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],[\"Gangaw\",\"Magway\",\"Minbu\",\"Pakokku\",\"Thayet\"],[319,43,38,677,38],[204,84,63,731,60],[27,105,28,212,28],[303,130,73,769,63],[105,102,32,314,31],[0,2,3,1,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>district<\\/th>\\n      <th>Battles<\\/th>\\n      <th>Explosions/Remote violence<\\/th>\\n      <th>Protests<\\/th>\\n      <th>Strategic developments<\\/th>\\n      <th>Violence against civilians<\\/th>\\n      <th>Riots<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"district\",\"targets\":1},{\"name\":\"Battles\",\"targets\":2},{\"name\":\"Explosions/Remote violence\",\"targets\":3},{\"name\":\"Protests\",\"targets\":4},{\"name\":\"Strategic developments\",\"targets\":5},{\"name\":\"Violence against civilians\",\"targets\":6},{\"name\":\"Riots\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n##### Yearly by Event\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group by district, year, and event_type, then count events\nacled_grouped <- acled_sf %>%\n  st_drop_geometry() %>% \n  group_by(district, year, event_type) %>%\n  summarize(count = n()) %>%\n  pivot_wider(names_from = c(year, event_type), values_from = count, values_fill = 0)\n\n# Create a data table\ndatatable(acled_grouped)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8944835fdae943491c5b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8944835fdae943491c5b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],[\"Gangaw\",\"Magway\",\"Minbu\",\"Pakokku\",\"Thayet\"],[66,6,3,51,4],[53,51,19,155,6],[17,104,27,139,28],[81,102,40,111,27],[29,64,15,62,8],[143,9,12,240,8],[63,12,32,183,24],[6,0,1,44,0],[137,20,19,429,18],[41,14,6,151,8],[101,14,12,303,14],[63,19,11,293,26],[2,0,0,27,0],[70,7,8,177,13],[26,12,5,81,8],[9,14,11,83,12],[25,2,1,100,4],[2,1,0,2,0],[15,1,6,52,5],[9,12,6,20,7],[0,2,3,1,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>district<\\/th>\\n      <th>2021_Battles<\\/th>\\n      <th>2021_Explosions/Remote violence<\\/th>\\n      <th>2021_Protests<\\/th>\\n      <th>2021_Strategic developments<\\/th>\\n      <th>2021_Violence against civilians<\\/th>\\n      <th>2022_Battles<\\/th>\\n      <th>2022_Explosions/Remote violence<\\/th>\\n      <th>2022_Protests<\\/th>\\n      <th>2022_Strategic developments<\\/th>\\n      <th>2022_Violence against civilians<\\/th>\\n      <th>2023_Battles<\\/th>\\n      <th>2023_Explosions/Remote violence<\\/th>\\n      <th>2023_Protests<\\/th>\\n      <th>2023_Strategic developments<\\/th>\\n      <th>2023_Violence against civilians<\\/th>\\n      <th>2024_Battles<\\/th>\\n      <th>2024_Explosions/Remote violence<\\/th>\\n      <th>2024_Protests<\\/th>\\n      <th>2024_Strategic developments<\\/th>\\n      <th>2024_Violence against civilians<\\/th>\\n      <th>2021_Riots<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"district\",\"targets\":1},{\"name\":\"2021_Battles\",\"targets\":2},{\"name\":\"2021_Explosions/Remote violence\",\"targets\":3},{\"name\":\"2021_Protests\",\"targets\":4},{\"name\":\"2021_Strategic developments\",\"targets\":5},{\"name\":\"2021_Violence against civilians\",\"targets\":6},{\"name\":\"2022_Battles\",\"targets\":7},{\"name\":\"2022_Explosions/Remote violence\",\"targets\":8},{\"name\":\"2022_Protests\",\"targets\":9},{\"name\":\"2022_Strategic developments\",\"targets\":10},{\"name\":\"2022_Violence against civilians\",\"targets\":11},{\"name\":\"2023_Battles\",\"targets\":12},{\"name\":\"2023_Explosions/Remote violence\",\"targets\":13},{\"name\":\"2023_Protests\",\"targets\":14},{\"name\":\"2023_Strategic developments\",\"targets\":15},{\"name\":\"2023_Violence against civilians\",\"targets\":16},{\"name\":\"2024_Battles\",\"targets\":17},{\"name\":\"2024_Explosions/Remote violence\",\"targets\":18},{\"name\":\"2024_Protests\",\"targets\":19},{\"name\":\"2024_Strategic developments\",\"targets\":20},{\"name\":\"2024_Violence against civilians\",\"targets\":21},{\"name\":\"2021_Riots\",\"targets\":22}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n:::\n\n### 5.2.4 District Analysis (Pakokku)\n\nGiven the severe nature of conflict in Pakokku, we will focus our subsequent analysis on this district. By examining Pakokku in detail, we can gain valuable insights into the factors driving intense conflict.\n\n#### 5.2.4.1 Prepare Pakokku `sf`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for \"Pakokku\" in both data frames\nacled_pak_sf <- acled_sf %>%\n  filter(district == \"Pakokku\")\nmagway_pak_sf <- mym_sf %>%\n  filter(DT == \"Pakokku\")\n```\n:::\n\n\n#### 5.2.4.1 Quadrant Count\n\nSplitting Pakokku into 10x10, we can start by looking a the Quadrat count of where the events mostly occur, in this case we can obseve higher counts in the center as well as long the eastern boundary.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% dplyr::select(year, geometry), magway_pak_sf)\nquadrat_counts <- quadratcount(acled_ppp_km, nx=10, ny=10)\n\nplot(quadrat_counts, main = \"Quadrat Counts\")\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n#### 5.2.4.2 Yearly Event Type KDE (Pakokku)\n\nHere we compare the event types over the years in Pakokku, each row representing an event type:\n1. Protests\n2. Explosions/Remote violence\n3. Battles\n4. Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\net_kde_results <- list()\nevent_types <- list(\"Protests\", \"Explosions/Remote violence\", \"Battles\", \"Violence against civilians\")\nq <- 0\n\n# Iterate through the list\nfor (et in event_types) {\n  for (yr in 2021:2024) {\n    q <- q + 1\n    acled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == yr & event_type == et), magway_pak_sf)\n    acled_ppp_kde <- density(acled_ppp_km, sigma = 5, edge = TRUE, kernel = \"gaussian\")\n    et_kde_results[[q]] <- acled_ppp_kde\n  }\n}\n\n# TODO: same as above replot\npar(mfrow=c(4,4), mar=c(1,1,1,2))\n# Create a data frame for plotting\ni <- 0\nfor (res in et_kde_results) {\n  i <- i + 1\n  r <- ifelse(i %% 4 == 0, 4, i %% 4)\n  plot(res, main = as.character(2020 + r))\n}\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n\n##### Event Type Findings\n\n1. Protests tend to be concentrated in urban areas\n2. Explosions and battles frequently occur near the outskirts of the city and towns\n3. Violence against civilians, on the other hand, is primarily concentrated in rural areas outside the city boundaries.\n\n:::\n\n## 5.3 Second Order Analysis\n\nTo gain a deeper understanding of the spatial distribution of conflict events within Pakokku, we will conduct a second-order spatial analysis using the Clark-Evans test and Ripley's K function. Before delving into these analyses, let's examine the types of events that occurred in Pakokku across different quarters. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group by district, year, and event_type, then count events\nacled_pak_grouped <- acled_pak_sf %>%\n  st_drop_geometry() %>% \n  group_by(event_type, quarter) %>%\n  summarize(count = n()) %>%\n  pivot_wider(names_from = quarter, values_from = count, values_fill = 0, names_sort = TRUE)\n\n# Create a data table\ndatatable(acled_pak_grouped)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-1aa2118a29f9abc91b13\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1aa2118a29f9abc91b13\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\"],[\"Battles\",\"Explosions/Remote violence\",\"Protests\",\"Riots\",\"Strategic developments\",\"Violence against civilians\"],[0,0,51,1,2,1],[4,11,58,0,16,11],[14,41,28,0,32,19],[33,103,2,0,61,31],[40,44,30,0,91,33],[78,64,6,0,130,55],[62,32,2,0,127,26],[60,43,6,0,81,37],[98,77,14,0,72,26],[57,73,4,0,40,17],[79,59,8,0,27,17],[69,84,1,0,38,21],[41,52,0,0,27,9],[42,48,2,0,25,11]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>event_type<\\/th>\\n      <th>2021.1<\\/th>\\n      <th>2021.2<\\/th>\\n      <th>2021.3<\\/th>\\n      <th>2021.4<\\/th>\\n      <th>2022.1<\\/th>\\n      <th>2022.2<\\/th>\\n      <th>2022.3<\\/th>\\n      <th>2022.4<\\/th>\\n      <th>2023.1<\\/th>\\n      <th>2023.2<\\/th>\\n      <th>2023.3<\\/th>\\n      <th>2023.4<\\/th>\\n      <th>2024.1<\\/th>\\n      <th>2024.2<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"event_type\",\"targets\":1},{\"name\":\"2021.1\",\"targets\":2},{\"name\":\"2021.2\",\"targets\":3},{\"name\":\"2021.3\",\"targets\":4},{\"name\":\"2021.4\",\"targets\":5},{\"name\":\"2022.1\",\"targets\":6},{\"name\":\"2022.2\",\"targets\":7},{\"name\":\"2022.3\",\"targets\":8},{\"name\":\"2022.4\",\"targets\":9},{\"name\":\"2023.1\",\"targets\":10},{\"name\":\"2023.2\",\"targets\":11},{\"name\":\"2023.3\",\"targets\":12},{\"name\":\"2023.4\",\"targets\":13},{\"name\":\"2024.1\",\"targets\":14},{\"name\":\"2024.2\",\"targets\":15}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### 5.3.1 Clark Evan Test\n\nBy employing the Clark-Evans test, we can assess whether the spatial distribution of conflict events within Pakokku deviates from complete spatial randomness. This analysis will help us identify any clustering or dispersion patterns that may exist.\n- H0: The distribution of events in Pakokku are randomly distributed.\n- H1: The distribution of events in Pakokku are not randomly distributed.\n- The 95% confident interval will be used.\n\n::: panel-tabset\n#### Protests\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Iterate through the list\nclarkevans.test(rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Protests\"), magway_pak_sf),\n            correction = \"none\",\n            alternative = c(\"clustered\"),\n            nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tClark-Evans test\n\tNo edge correction\n\tZ-test\n\ndata:  rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Protests\"), \nR = 0.092082, p-value < 2.2e-16\nalternative hypothesis: clustered (R < 1)\n```\n\n\n:::\n:::\n\n\nProtests: R < 1 which suggest clustering. p-value < 0.05, H0 can be rejected.\n\n#### Explosions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Iterate through the list\nclarkevans.test(rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Explosions/Remote violence\"), magway_pak_sf),\n            correction = \"none\",\n            alternative = c(\"clustered\"),\n            nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tClark-Evans test\n\tNo edge correction\n\tZ-test\n\ndata:  rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Explosions/Remote violence\"), \nR = 0.36424, p-value < 2.2e-16\nalternative hypothesis: clustered (R < 1)\n```\n\n\n:::\n:::\n\n\nExplosions/Remote violence: R < 1 which suggest clustering. p-value < 0.05, H0 can be rejected.\n\n#### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Iterate through the list\nclarkevans.test(rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Battles\"), magway_pak_sf),\n            correction = \"none\",\n            alternative = c(\"clustered\"),\n            nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tClark-Evans test\n\tNo edge correction\n\tZ-test\n\ndata:  rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Battles\"), \nR = 0.34248, p-value < 2.2e-16\nalternative hypothesis: clustered (R < 1)\n```\n\n\n:::\n:::\n\n\nBattles: R < 1 which suggest clustering. p-value < 0.05, H0 can be rejected.\n\n#### Violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Iterate through the list\nclarkevans.test(rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Violence against civilians\"), magway_pak_sf),\n            correction = \"none\",\n            alternative = c(\"clustered\"),\n            nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tClark-Evans test\n\tNo edge correction\n\tZ-test\n\ndata:  rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Violence against civilians\"), \nR = 0.50772, p-value < 2.2e-16\nalternative hypothesis: clustered (R < 1)\n```\n\n\n:::\n:::\n\n\nViolence against civilians: R < 1 which suggest clustering. p-value < 0.05, H0 can be rejected.\n\n:::\n\n::: callout-note\n\n#### Understanding High Clustering\n\n1.  Increased Intensity: Clusters of conflict events often indicate areas of heightened intensity. Concentrated violence can lead to greater casualties, displacement, and destruction of infrastructure.\n2.  Strategic Considerations: Armed groups may strategically target specific areas for tactical advantages or to exert control over key resources.\n3.  Spillover Effects: High clustering in one area can increase the risk of conflict spreading to neighboring regions. This is especially true if the conflict involves armed groups with territorial ambitions.\n\nGiven the observed shift from protests to battles over time, I am particularly interested in exploring the relationship between these two types of events. We will be using this 2 events for our subsequent analysis.\n\n:::\n\n### 5.3.2 G Function Analysis\n\nTo better appreciate the clustering we can start by visualizing on G function help us identify any clustering or dispersion patterns that may exist, providing valuable insights into the underlying dynamics of conflict in the region. Subsequently we will also be using the other variants of the Ripley's K Function to determine spatial auto correlations, here are their uses:\n- G function: Measures the probability of finding a point within a given distance of another point.\n- K function: Measures the average number of points within a given distance of a randomly chosen point.\n- L function: A transformation of the K function that makes it easier to interpret.\n- F function: Measures the distribution of distances between pairs of points.\n\n::: panel-tabset\n#### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Battles\"), magway_pak_sf)\nG.csr <- envelope(acled_ppp_km, Gest, nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G.csr, xlab = \"Dist (km)\", ylab = \"G(r)\", main = \"G-Function (Battles)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nThese observations suggest that there is a strong tendency for points to cluster within a distance of 6km. The rapid increase in the G function at shorter distances indicates a high degree of clustering within the first 6km. However, the slower increase beyond 8km suggests that the clustering effect might be weakening at larger distances.\n\n#### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Protests\"), magway_pak_sf)\nG.csr <- envelope(acled_ppp_km, Gest, nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G.csr, xlab = \"Dist (km)\", ylab = \"G(r)\", main = \"G-Function (Protests)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\nThe observed G function steadily increasing suggests a clustering pattern for protests. This means that the probability of finding another protest within a given distance of a protest increases as the distance increases. Unlike battles which often involve larger-scale operations that can extend over wider areas, Protests tend to be more localized events, often concentrated in specific areas or near particular targets. This is why the G function for battles might have a larger range, indicating that points (events) can be found at greater distances from each other.\n\n:::\n\n### 5.3.3 K-Function Analysis\n\nTo ensure our observation is consistent we will use K Function to provide further insights into the spatial distribution of conflict events and help confirm our findings from the G function.\n\n::: panel-tabset\n#### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Battles\"), magway_pak_sf)\nK.csr <- envelope(acled_ppp_km, Kest, nsim = 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K.csr, xlab = \"Dist (km)\", ylab = \"K(r)\", main = \"K-Function (Battles)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\nSimilarly here we can observe the strong tendency for points to cluster on the on start up until 20+ km as it slowly converges with the envelope toward 25 km\n\n#### Protests\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Protests\"), magway_pak_sf)\nK.csr <- envelope(acled_ppp_km, Kest, nsim = 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K.csr, xlab = \"Dist (km)\", ylab = \"K(r)\", main = \"K-Function (Protests)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\nThe K function for protest potrays even more pronounced clustering pattern for protests. The K function indicates a highly localized and intense concentration of protest events within a small radius.\n\n:::\n\nFrom the above observation we can confirm that our findings from\n\n::: callout-note\n\n#### Understanding Ripley's K Function \n\n- The solid line represents the observed K function. - If K(r) is above the envelope, it indicates clustering (points are closer together than expected by chance). - If K(r) is below the envelope, it indicates dispersion (points are farther apart than expected by chance). - If K(r) is within the envelope, it suggests a random pattern.\n- Envelope: The envelope is generated by simulating random point patterns under the assumption of CSR. If the observed K function falls outside the envelope, it suggests a significant deviation from randomness.\n- Dotted line through the center: This line represents the theoretical K function under complete spatial randomness. It serves as a benchmark for comparison with the observed K function.\n\n![](assets/k_func.png)\n\n:::\n\n### 5.3.3 L-Function Analysis\n\nTo view the K-Function more intuitively we will employ the L function. This transformation of the K function will provide a clearer visualization of the clustering patterns observed in the data.\n\n::: panel-tabset\n#### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Battles\"), magway_pak_sf)\nL.csr <- envelope(acled_ppp_km, Lest, nsim = 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(L.csr , . - r ~ r, xlab=\"Dist (km)\", ylab=\"L(r)-r\", main = \"L-Function (Battles)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n\n#### Protests\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Protests\"), magway_pak_sf)\nL.csr <- envelope(acled_ppp_km, Lest, nsim = 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(L.csr , . - r ~ r, xlab=\"Dist (km)\", ylab=\"L(r)-r\", main = \"L-Function (Protests)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n:::\n\n:::\n\n### 5.3.4 F-Function Analysis\n\nTo further validate our observation, we will employ the F function as complementary analysis. Which measures the distribution of distances between pairs of points.\n\n::: panel-tabset\n#### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Battles\"), magway_pak_sf)\nK.csr <- envelope(acled_ppp_km, Fest, nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K.csr, xlab = \"Dist (km)\", ylab = \"F(r)\", main = \"F-Function (Battles)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\nThis suggests that the observed distances between points are smaller than expected under complete spatial randomness. In other words, there is evidence of clustering in the data. The degree of clustering can be assessed by how far below the dotted line the F function curve lies.\n\n#### Protests\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_km <- rescale_ppp_km(acled_pak_sf %>% filter(year == 2021 & event_type == \"Protests\"), magway_pak_sf)\nK.csr <- envelope(acled_ppp_km, Fest, nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 999 simulations of CSR  ...\n1, 2, 3, ......10.........20.........30.........40.........50.........60..\n.......70.........80.........90.........100.........110.........120.........130\n.........140.........150.........160.........170.........180.........190........\n.200.........210.........220.........230.........240.........250.........260......\n...270.........280.........290.........300.........310.........320.........330....\n.....340.........350.........360.........370.........380.........390.........400..\n.......410.........420.........430.........440.........450.........460.........470\n.........480.........490.........500.........510.........520.........530........\n.540.........550.........560.........570.........580.........590.........600......\n...610.........620.........630.........640.........650.........660.........670....\n.....680.........690.........700.........710.........720.........730.........740..\n.......750.........760.........770.........780.........790.........800.........810\n.........820.........830.........840.........850.........860.........870........\n.880.........890.........900.........910.........920.........930.........940......\n...950.........960.........970.........980.........990........\n999.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K.csr, xlab = \"Dist (km)\", ylab = \"F(r)\", main = \"F-Function (Protests)\", lwd = 2, cex.axis = 1.2)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-49-1.png){width=672}\n:::\n:::\n\n\nSimilar observation as with Battles but with a more less steep observation line, indicating more intense clustering.\n\n:::\n\n# 6. Spatial-Temporal Analysis\n\nWith our previous findings on clustering with Pakokku, we spatial temporal distribution of events across the district and examine how these patterns evolve over time. This analysis will help us identify specific areas of concentration and potential hotspots, as well as understand the temporal changes in conflict activity.\n\n## 6.1 Overview by Quarter\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(magway_pak_sf) + tm_polygons() +\n  tm_shape(acled_pak_sf) + tm_dots(size = 0.1, alpha = 0.5, col = \"red\") +\n  tm_facets(by=\"quarter\",\n            free.coords = F,\n            drop.units = T)\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n\n## 6.2 Compute ST Density by Event_type\n\nWe start by preparing our `sf` with our quarter id to be used with the `spattemp.density` of the `sparr` for our spatial temporal analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_pak_sf <- acled_pak_sf %>%\n  mutate(quarter_id = ((year - 2021) * 4) + ((quarter %% 1) * 10))\n```\n:::\n\n\n::: panel-tabset\n### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\npak_ppp_owin <- rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Battles\") %>% dplyr::select(quarter_id, geometry), magway_pak_sf)\n\nst_kde <- sparr::spattemp.density(pak_ppp_owin)\nsummary(st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 8.5989 (spatial)\n  lambda = 0.088 (temporal)\n\nNo. of observations\n  677 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [8.367469, 121.1188] x [2310.08, 2425.057]\n\nTemporal bound\n  [2, 15]\n\nEvaluation\n  128 x 128 x 14 trivariate lattice\n  Density range: [2.248839e-36, 0.0005999062]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntims <- seq(2, 14)\npar(mfcol = c(4,4), mar = c(2, 2, 2, 2))\nfor(i in tims) {\n  plot(st_kde, i,\n       override.par = F,\n       fix.range = F,\n       main=paste(\"KDE: \",i))\n  }\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n\nWe can observe over the quarters (less 2021 Q1) the Battles are spread out around the northern sector of Pakokku\n\n### Protests\n\n\n::: {.cell}\n\n```{.r .cell-code}\npak_ppp_owin <- rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Protests\") %>% dplyr::select(quarter_id, geometry), magway_pak_sf)\n\nst_kde <- sparr::spattemp.density(pak_ppp_owin)\nsummary(st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 6.7531 (spatial)\n  lambda = 0.0836 (temporal)\n\nNo. of observations\n  212 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [8.367469, 121.1188] x [2310.08, 2425.057]\n\nTemporal bound\n  [0, 15]\n\nEvaluation\n  128 x 128 x 16 trivariate lattice\n  Density range: [3.261449e-77, 0.004421199]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntims <- seq(2, 14)\npar(mfcol = c(4,4), mar = c(2, 2, 2, 2))\nfor(i in tims) {\n  plot(st_kde, i,\n       override.par = F,\n       fix.range = F,\n       main=paste(\"KDE: \",i))\n  }\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n\nWhereas the Protests is observed to remain localized and consistent in towns and cities.\n\n:::\n\n## 6.3 Animating Events (Battles)\n\nThe Spatial Temporal Diffusion for Battles is animated with the following code, which generates and MP4, subsequently converted into a Gif\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#! ouptput: false\n# pak_ppp_owin <- rescale_ppp_km(acled_pak_sf %>% filter(event_type == \"Battles\") %>% dplyr::select(quarter_id, geometry), magway_pak_sf)\n\n# hlam <- LIK.spattemp(pak_ppp_owin)\n# f.breve <- spattemp.density(pak_ppp_owin, h=hlam[1], lambda=hlam[2], tlim=c(1,14))\n# g.tilde <- bivariate.density(pak_ppp_owin, h0=hlam[1])\n# rho.breve <- spattemp.risk(f=f.breve,g=g.tilde, tolerate=TRUE)\n\n# colpal <- spatstat.options(\"image.colfun\")\n# fmdcolours <- colourmap(colpal(128),breaks=c(-80,seq(-7,4,length=128)))\n# mytimes <- 1:14\n# animation::saveVideo(\n#  for(i in 1:length(mytimes)){\n#    plot(rho.breve,tselect=mytimes[i],type=\"conditional\",col=fmdcolours,\n#         tol.args=list(levels=c(0.05,0.0001),lty=2:1,drawlabels=FALSE),\n#         sleep=0,override.par=FALSE)\n#    title(xlab=\"Easting\",ylab=\"Northing\")\n#  },\n#  video.name=\"fmd_protests.mp4\", other.opts = '-b:v 1M -pix_fmt yuv420p', ani.width=640, ani.height=640, interval=1/4)\n```\n:::\n\n\n![](assets/fmd.gif)\n\n::: callout-note\n\nThe above code chunk is commented to prevent execution as it requires ffmpeg tool for running. Ensure you have the tool installed before running.\n\n:::\n\n# 7. Interpretation \n\nAfter gathering the insights from our previous analysis, we will integrate OpenStreetMap (OSM) data and explore the temporal relationships within our dataset.\n\n\n\n## 7.1 Visualizing conflicts on OSM\n\nFor our OSM dimensions we will be working with the places layers which consists of towns and cities as well as the places of worship (POW). The data are retrieved from [geofabrik](https://download.geofabrik.de/asia/myanmar.html) for Myanmmar.\n\n### 7.1.1 Prepping OSM Data\n\nOSM data is loaded and crs transformed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nosm_sf = st_read(\"data/geospatial/myanmar-latest-free.shp.zip\", layer=\"gis_osm_places_a_free_1\") %>%\n  st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `gis_osm_places_a_free_1' from data source \n  `/Users/jeffery/Projects/Y4S1/IS415/S0methingSimple/IS415-GAA/take-home_ex/ex01/data/geospatial/myanmar-latest-free.shp.zip' \n  using driver `ESRI Shapefile'\nSimple feature collection with 10489 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.24155 ymin: 9.606004 xmax: 101.0663 ymax: 28.17021\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nosm_pow_sf = st_read(\"data/geospatial/myanmar-latest-free.shp.zip\", layer=\"gis_osm_pofw_free_1\") %>%\n  st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `gis_osm_pofw_free_1' from data source \n  `/Users/jeffery/Projects/Y4S1/IS415/S0methingSimple/IS415-GAA/take-home_ex/ex01/data/geospatial/myanmar-latest-free.shp.zip' \n  using driver `ESRI Shapefile'\nSimple feature collection with 12083 features and 4 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 92.16019 ymin: 9.95157 xmax: 100.9118 ymax: 27.39084\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n### 7.1.2 Visualizing Area of Study\n\nIn the following we take a look at the distribution of the places and POW across Magway.\n\n::: panel-tabset\n#### Towns and City\n\nBy incorporating places data from OSM, we can identify areas with high population density and analyze their relationship to conflict events. This analysis will help us understand whether population concentration plays a role in shaping the spatial distribution of conflict\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the distribution map with title and dots\nosm_mag_sf <- st_intersection(osm_sf, magway_sf)\ntm_shape(magway_sf) +\n  tm_polygons() +\n  tm_shape(osm_mag_sf %>% filter(fclass %in% c(\"town\", \"city\", \"suburb\"))) +\n  tm_bubbles(col = \"fclass\", alpha = 1, size = 0.1) +\n  tm_layout(title = \"Distribution\", title.position = c(\"right\", \"top\"))\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-58-1.png){width=672}\n:::\n:::\n\n\nWithin Magway we can identify the Pakokku in blue, the largest city in the Magway Region of Myanmar. It is situated about 30 km northeast of Bagan on the Irrawaddy River with a population of 322,154.\n\n#### Places of Worship\n\nWhile our OSM data does not include ethnicity information, we can explore potential relationships between conflict events and places of worship. By analyzing the spatial proximity between conflict locations and religious sites, we may gain insights into the role of religious identity or affiliation in shaping conflict dynamics.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the distribution map with title and dots\nosm_pow_mag_sf <- st_intersection(osm_pow_sf, magway_sf)\ntm_shape(magway_sf) +\n  tm_polygons() +\n  tm_shape(osm_pow_mag_sf) +\n  tm_bubbles(col = \"fclass\", alpha = 0.5, size = 0.1) +\n  tm_layout(title = \"Distribution\", title.position = c(\"right\", \"top\"))\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n\nOther than a scatter of other religions in Minbu on the broder with Rakhine in the west the region is mostly dominated by Buddhism.\n:::\n\n### 7.1.3 KDE on OSM\n\nNext we will overlay the OSM points on our density plot to identify their spatial relations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_pro <- as.ppp(acled_pak_sf %>% filter(event_type == \"Protests\"))\nacled_ppp_bat <- as.ppp(acled_pak_sf %>% filter(event_type == \"Battles\"))\nmagway_owin <- as.owin(magway_pak_sf %>% st_union())\n```\n:::\n\n\n#### 7.1.3.1 Protests KDE\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_kde <- density(acled_ppp_pro[magway_owin], sigma = 5000, edge = TRUE, kernel = \"gaussian\")\nacled_mag_raster <- kde_to_raster(acled_ppp_kde)\n\npak_kde_raster <- tm_shape(acled_mag_raster) +\n  tm_raster(alpha = 0.8, palette = \"YlOrRd\")\n```\n:::\n\n\n::: panel-tabset\n##### Towns and City\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming you have a RasterLayer object named 'my_raster'\nosm_pak_sf <- st_intersection(osm_sf, magway_pak_sf)\ntm_shape(magway_pak_sf) +\n  tm_polygons(col = \"white\") +\n  pak_kde_raster +\n  tm_shape(osm_pak_sf %>% filter(fclass %in% c(\"town\", \"city\"))) +\n  tm_bubbles(col = \"fclass\", alpha = 1, size = 0.2, palette = c(\"aquamarine\", \"cornflowerblue\")) + \n  tm_layout(title = \"Places (Protests)\", title.position = c(\"center\", \"top\")) \n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-62-1.png){width=672}\n:::\n:::\n\n\nAs observed the protests are mostly clustered around the city of Pakokku and the township of Myaing.\n\n##### Places of Worhsip\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming you have a RasterLayer object named 'my_raster'\nosm_pow_pak_sf <- st_intersection(osm_pow_sf, magway_pak_sf)\ntm_shape(magway_pak_sf) +\n  tm_polygons(col = \"white\") +\n  pak_kde_raster +\n  tm_shape(osm_pow_pak_sf) +\n  tm_bubbles(col = \"fclass\", alpha = 0.3, size = 0.1, palette = c(\"aquamarine\")) +\n  tm_layout(title = \"Places of Worship (Protests)\", title.position = c(\"center\", \"top\"))\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-63-1.png){width=672}\n:::\n:::\n\n\nThere is not much relations to be observed with places of worship since the dominant and registered religion within the district is Buddhist.\n\n:::\n\n#### 7.1.3.2 Battles KDE\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_ppp_kde <- density(acled_ppp_bat[magway_owin], sigma = 5000, edge = TRUE, kernel = \"gaussian\")\nacled_mag_raster <- kde_to_raster(acled_ppp_kde)\n\npak_kde_raster <- tm_shape(acled_mag_raster) +\n  tm_raster(alpha = 0.8, palette = \"YlOrRd\")\n```\n:::\n\n\n::: panel-tabset\n##### Towns and City\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming you have a RasterLayer object named 'my_raster'\nosm_pak_sf <- st_intersection(osm_sf, magway_pak_sf)\ntm_shape(magway_pak_sf) +\n  tm_polygons(col = \"white\") +\n  pak_kde_raster +\n  tm_shape(osm_pak_sf %>% filter(fclass %in% c(\"town\", \"city\"))) +\n  tm_bubbles(col = \"fclass\", alpha = 1, size = 0.2, palette = c(\"aquamarine\", \"cornflowerblue\")) + \n  tm_layout(title = \"Places (Battles)\", title.position = c(\"center\", \"top\")) \n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-65-1.png){width=672}\n:::\n:::\n\n\nBattles tend to occur in wider radius around towns and cities, while protests are more concentrated in urban centers. \n\n##### Places of Worhsip\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming you have a RasterLayer object named 'my_raster'\nosm_pow_pak_sf <- st_intersection(osm_pow_sf, magway_pak_sf)\ntm_shape(magway_pak_sf) +\n  tm_polygons(col = \"white\") +\n  pak_kde_raster +\n  tm_shape(osm_pow_pak_sf) +\n  tm_bubbles(col = \"fclass\", alpha = 0.3, size = 0.1, palette = c(\"aquamarine\")) +\n  tm_layout(title = \"Places of Worship (Battles)\", title.position = c(\"center\", \"top\"))\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-66-1.png){width=672}\n:::\n:::\n\n\nThere is not much relations to be observed with places of worship since the dominant and registered religion within the district is Buddhist.\n\n:::\n\n## 7.2 Analysis of Timeline\n\nFinally lets discuss the event type and its changes over the course of the conflict.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for the desired event types\ngrouped_data <- acled_pak_sf %>%\n  filter(event_type %in% c(\"Protests\", \"Battles\")) %>%\n  mutate(year_quarter = year + (quarter %% 1) * 2.5) %>% \n  group_by(event_type, year_quarter) %>%\n  summarize(count = n())\n\n# Create the line plot\nggplot(grouped_data, aes(x = year_quarter, y = count, color = event_type)) +\n  geom_line() +\n  geom_point() +\n  labs(title = \"Event Type Counts Over Time\",\n       x = \"Quarter\",\n       y = \"Count\") +\n  scale_color_manual(values = c(\"Protests\" = \"red\", \"Battles\" = \"blue\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](th_ex01_files/figure-html/unnamed-chunk-67-1.png){width=672}\n:::\n:::\n\n\nOur analysis reveals a distinct temporal pattern in conflict events. Protests were prevalent in the early stages of the conflict in 2021, but their frequency gradually declined over time. On the other hand, battles have become more frequent, suggesting a shift in the tactics or strategies employed by the conflicting parties.\n\nSeveral factors may contribute to this trend. The increasing presence of security forces and the implementation of restrictive measures could have suppressed protest activity. Additionally, the evolving dynamics of the conflict, such as changes in leadership or alliances, may have influenced the shift towards more violent confrontations.\n\n## 7.3 Key Policy and Mitigation Strategies\n\n1. Promote Dialogue and Reconciliation: To foster peace and stability, it is essential to facilitate inclusive dialogue among all relevant stakeholders. Neutral mediation and trust-building measures can support this process, creating a conducive environment for negotiation and agreement.\n\n2. Address Root Causes: Addressing the underlying grievances and social injustices that fuel the conflict is crucial for long-term peace. This involves promoting socioeconomic development, ensuring human rights protection, and fostering inter-ethnic reconciliation.\n\n3. Security Sector Reform: Reforming the security sector is essential for creating a more accountable, professional, and human rights-respecting force. This includes measures such as demilitarization, civilian control, and support for disarmament, demobilization, and reintegration programs.\n\n# 8. Personal Reflection\n\n## 8.1 Technically\nI've learned how to use spatial analysis tools effectively, especially for first-order, second-order and spatial temporal analyses. The `spatstat` and `sparr` packages were invaluable for this. The EDA with `ggplot` was also tremendously helpful for my subsequent.\n\n## 8.2 Conflict-Related\nI gained insights into the spatial distribution of conflict events, identified hotspots, and understood temporal patterns. I also explored the relationships between conflict and geographic factors such as places and POW. These findings also made me delve into ways of mitigating such conflicts as well as peacbuilding effots.\n",
    "supporting": [
      "th_ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}